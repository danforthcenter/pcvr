<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Variance partitioning using Full Random Effects Models — frem • pcvr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Variance partitioning using Full Random Effects Models — frem"><meta name="description" content="Variance partitioning for phenotypes (over time) using fully random effects models"><meta property="og:description" content="Variance partitioning for phenotypes (over time) using fully random effects models"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/Bellwether.html">Bellwether</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal.html">Longitudinal Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/roots.html">Root Phenotyping</a></li>
    <li><a class="dropdown-item" href="../articles/directional.html">Directional Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_conjugate.html">Conjugate Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_igm.html">Intermediate Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_agm.html">Advanced Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_mvt.html">Multi-Value Traits Tutorial</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quarto-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quarto Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials"><li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/crop_reporter/tutorials/pcvrTutorial_multiValueTraits">Multi-Value Traits</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV"><span class="fa fa-leaf"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Variance partitioning using Full Random Effects Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/main/R/frem.R" class="external-link"><code>R/frem.R</code></a></small>
      <div class="d-none name"><code>frem.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Variance partitioning for phenotypes (over time) using fully random effects models</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">frem</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">des</span>,</span>
<span>  <span class="va">phenotypes</span>,</span>
<span>  timeCol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cor <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  returnData <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  combine <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  markSingular <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time_format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Dataframe containing phenotypes and design variables, optionally over time.</p></dd>


<dt id="arg-des">des<a class="anchor" aria-label="anchor" href="#arg-des"></a></dt>
<dd><p>Design variables to partition variance for as a character vector.</p></dd>


<dt id="arg-phenotypes">phenotypes<a class="anchor" aria-label="anchor" href="#arg-phenotypes"></a></dt>
<dd><p>Phenotype column names (data is assumed to be in wide format)
as a character vector.</p></dd>


<dt id="arg-timecol">timeCol<a class="anchor" aria-label="anchor" href="#arg-timecol"></a></dt>
<dd><p>A column of the data that denotes time for longitudinal experiments.
If left NULL (the default) then all data is assumed to be from one timepoint.</p></dd>


<dt id="arg-cor">cor<a class="anchor" aria-label="anchor" href="#arg-cor"></a></dt>
<dd><p>Logical, should a correlation plot be made? Defaults to TRUE.</p></dd>


<dt id="arg-returndata">returnData<a class="anchor" aria-label="anchor" href="#arg-returndata"></a></dt>
<dd><p>Logical, should the used to make plots be returned? Defaults to FALSE.</p></dd>


<dt id="arg-combine">combine<a class="anchor" aria-label="anchor" href="#arg-combine"></a></dt>
<dd><p>Logical, should plots be combined with patchwork?
Defaults to TRUE, which works well when there is a single timepoint being used.</p></dd>


<dt id="arg-marksingular">markSingular<a class="anchor" aria-label="anchor" href="#arg-marksingular"></a></dt>
<dd><p>Logical, should singular fits be marked in the variance explained plot?
This is FALSE by default but it is good practice to check with TRUE in some situations.
 If TRUE this will add white markings to the plot where models had singular fits,
  which is the most common problem with this type of model.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>If the data contains multiple timepoints then which should be used?
This can be left NULL which will use the maximum time if <code>timeCol</code> is specified.
 If a single number is provided then that time value will be used.
  Multiple numbers will include those timepoints.
   The string "all" will include all timepoints.</p></dd>


<dt id="arg-time-format">time_format<a class="anchor" aria-label="anchor" href="#arg-time-format"></a></dt>
<dd><p>Format for non-integer time, passed to <code>strptime</code>,
defaults to "%Y-%m-%d".</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns either a plot (if returnData=FALSE) or a list with a plot and
data/a list of dataframes (depending on returnData and cor).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  genotype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g1"</span>, <span class="st">"g2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"T"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  date_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"2024-08-"</span>, <span class="fl">21</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pheno1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pheno2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pheno3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">frem</span><span class="op">(</span><span class="va">df</span>, des <span class="op">=</span> <span class="st">"genotype"</span>, phenotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pheno1"</span>, <span class="st">"pheno2"</span>, <span class="st">"pheno3"</span><span class="op">)</span>, returnData <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">class</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $plot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "patchwork" "gg"        "ggplot"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "list"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">frem</span><span class="op">(</span><span class="va">df</span>,</span></span>
<span class="r-in"><span>  des <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"genotype"</span>, <span class="st">"treatment"</span><span class="op">)</span>, phenotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pheno1"</span>, <span class="st">"pheno2"</span>, <span class="st">"pheno3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  cor <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="frem-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">frem</span><span class="op">(</span><span class="va">df</span>,</span></span>
<span class="r-in"><span>  des <span class="op">=</span> <span class="st">"genotype"</span>, phenotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pheno1"</span>, <span class="st">"pheno2"</span>, <span class="st">"pheno3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  combine <span class="op">=</span> <span class="cn">FALSE</span>, timeCol <span class="op">=</span> <span class="st">"time"</span>, time <span class="op">=</span> <span class="st">"all"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="frem-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="frem-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">frem</span><span class="op">(</span><span class="va">df</span>,</span></span>
<span class="r-in"><span>  des <span class="op">=</span> <span class="st">"genotype"</span>, phenotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pheno1"</span>, <span class="st">"pheno2"</span>, <span class="st">"pheno3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  combine <span class="op">=</span> <span class="cn">TRUE</span>, timeCol <span class="op">=</span> <span class="st">"time"</span>, time <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="frem-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">frem</span><span class="op">(</span><span class="va">df</span>,</span></span>
<span class="r-in"><span>  des <span class="op">=</span> <span class="st">"genotype"</span>, phenotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pheno1"</span>, <span class="st">"pheno2"</span>, <span class="st">"pheno3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  cor <span class="op">=</span> <span class="cn">FALSE</span>, timeCol <span class="op">=</span> <span class="st">"time"</span>, time <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, markSingular <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="frem-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">3</span>, <span class="st">"genotype"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"g1"</span></span></span>
<span class="r-in"><span><span class="fu">frem</span><span class="op">(</span><span class="va">df</span>,</span></span>
<span class="r-in"><span>  des <span class="op">=</span> <span class="st">"genotype"</span>, phenotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pheno1"</span>, <span class="st">"pheno2"</span>, <span class="st">"pheno3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  cor <span class="op">=</span> <span class="cn">FALSE</span>, timeCol <span class="op">=</span> <span class="st">"date_time"</span>, time <span class="op">=</span> <span class="st">"all"</span>, markSingular <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Skipping DAS 2 as grouping contains a variable that is singular</span>
<span class="r-plt img"><img src="frem-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Josh Sumner <br> Developed in DDPSC Datascience Core Facility <br> Logo design by <a href="https://twitter.com/Kerri_Gilbert" class="external-link">Kerri Gilbert</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

