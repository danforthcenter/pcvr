<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Remove outliers from bellwether data using cook's distance — bw.outliers • pcvr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Remove outliers from bellwether data using cook's distance — bw.outliers"><meta name="description" content="Remove outliers from bellwether data using cook's distance"><meta property="og:description" content="Remove outliers from bellwether data using cook's distance"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home page"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/bellwether.html">Bellwether</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal.html">Longitudinal Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/roots.html">Root Phenotyping</a></li>
    <li><a class="dropdown-item" href="../articles/directional.html">Directional Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_conjugate.html">Conjugate Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_igm.html">Intermediate Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_agm.html">Advanced Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_mvt.html">Multi-Value Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/field_capacity.html">Water Derived Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/reading_pcv_data.html">Using online PlantCV Output</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quarto-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quarto Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials"><li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/crop_reporter/tutorials/pcvrTutorial_multiValueTraits">Multi-Value Traits</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr" aria-label="View on Github"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV" aria-label="View PlantCV on Github"><span class="fa fa-leaf"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Remove outliers from bellwether data using cook's distance</h1>
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/main/R/bwoutliers.R" class="external-link"><code>R/bwoutliers.R</code></a></small>
      <div class="d-none name"><code>bw.outliers.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Remove outliers from bellwether data using cook's distance</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bw.outliers</span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">phenotype</span>,</span>
<span>  naTo0 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  outlierMethod <span class="op">=</span> <span class="st">"cooks"</span>,</span>
<span>  plotgroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barcode"</span>, <span class="st">"rotation"</span><span class="op">)</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  traitCol <span class="op">=</span> <span class="st">"trait"</span>,</span>
<span>  valueCol <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>  labelCol <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>  idCol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  separate <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Data frame to use. Can be in long or wide format.</p></dd>


<dt id="arg-phenotype">phenotype<a class="anchor" aria-label="anchor" href="#arg-phenotype"></a></dt>
<dd><p>Column to use to classify outliers. If this is length &gt; 1 then
it is taken as the multi-value traits to use. See examples.</p></dd>


<dt id="arg-nato-">naTo0<a class="anchor" aria-label="anchor" href="#arg-nato-"></a></dt>
<dd><p>Logical, should NA values to changed to 0.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Grouping variables to find outliers as a character vector.
This is typically time  and design variables (DAS, genotype, treatment, etc).
These are used as predictors for `phenotype` in a generalized linear model.</p></dd>


<dt id="arg-cutoff">cutoff<a class="anchor" aria-label="anchor" href="#arg-cutoff"></a></dt>
<dd><p>Cutoff for something being an "outlier" expressed as a multiplier
on the mean of Cooks Distance for this data. This defaults to 5, with higher values
being more conservative (removing less of the data).</p></dd>


<dt id="arg-outliermethod">outlierMethod<a class="anchor" aria-label="anchor" href="#arg-outliermethod"></a></dt>
<dd><p>Method to be used in detecting outliers.
Currently "cooks" and "mahalanobis" distances are supported, with "mahalanobis" only
being supported for multi-value traits.</p></dd>


<dt id="arg-plotgroup">plotgroup<a class="anchor" aria-label="anchor" href="#arg-plotgroup"></a></dt>
<dd><p>Grouping variables for drawing plots if plot=TRUE.
Typically this is an identifier for images of a plant
over time and defaults to c('barcode',"rotation").</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical, if TRUE then a list is returned with a ggplot and a dataframe.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Optional specification for x axis variable if plot is true.
If left NULL (the default) then the first element of `group` is used.</p></dd>


<dt id="arg-traitcol">traitCol<a class="anchor" aria-label="anchor" href="#arg-traitcol"></a></dt>
<dd><p>Column with phenotype names, defaults to "trait".
This should generally not need to be changed from the default.
   If this and valueCol are present in colnames(df) then the data
   is assumed to be in long format.</p></dd>


<dt id="arg-valuecol">valueCol<a class="anchor" aria-label="anchor" href="#arg-valuecol"></a></dt>
<dd><p>Column with phenotype values, defaults to "value".
This should generally not need to be changed from the default.</p></dd>


<dt id="arg-labelcol">labelCol<a class="anchor" aria-label="anchor" href="#arg-labelcol"></a></dt>
<dd><p>Column with phenotype labels for long data, defaults to "label".
This should generally not need to be changed from the default.</p></dd>


<dt id="arg-idcol">idCol<a class="anchor" aria-label="anchor" href="#arg-idcol"></a></dt>
<dd><p>Column(s) that identify individuals over time.
Defaults to plotGroup.</p></dd>


<dt id="arg-ncp">ncp<a class="anchor" aria-label="anchor" href="#arg-ncp"></a></dt>
<dd><p>Optionally specify the number of principle components to be used for MV data outlier
detection with cooks distance. If left NULL (the default) then 3 will be used.</p></dd>


<dt id="arg-separate">separate<a class="anchor" aria-label="anchor" href="#arg-separate"></a></dt>
<dd><p>Optionally separate the data by some variable to speed up the modeling step.
If you have a design variable with
very many levels then it may be helpful to separate by that variable.
Note this will subset the data for each model so it will change
the outlier removal (generally to be more conservative).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The input dataframe with outliers removed and optionally a plot
(if a plot is returned then output is a list).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sv</span> <span class="op">&lt;-</span> <span class="fu"><a href="growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"logistic"</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">5</span>, t <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">160</span><span class="op">)</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sv</span><span class="op">[</span><span class="fl">130</span>, <span class="op">]</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">sv_res</span> <span class="op">&lt;-</span> <span class="fu">bw.outliers</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">sv</span>, phenotype <span class="op">=</span> <span class="st">"y"</span>, naTo0 <span class="op">=</span> <span class="cn">FALSE</span>, cutoff <span class="op">=</span> <span class="fl">15</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"group"</span><span class="op">)</span>, outlierMethod <span class="op">=</span> <span class="st">"cooks"</span>,</span></span>
<span class="r-in"><span>  plotgroup <span class="op">=</span> <span class="st">"id"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sv_res</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="bw.outliers-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">{</span> <span class="co"># in case offline</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvw</span> <span class="op">&lt;-</span> <span class="fu"><a href="read.pcv.html">read.pcv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"https://media.githubusercontent.com/media/joshqsumner/"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"pcvrTestData/main/pcv4-multi-value-traits.csv"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>, mode <span class="op">=</span> <span class="st">"wide"</span>, reader <span class="op">=</span> <span class="st">"fread"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvw</span><span class="op">$</span><span class="va">genotype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">mvw</span><span class="op">$</span><span class="va">barcode</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvw</span><span class="op">$</span><span class="va">genotype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mvw</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"002"</span>, <span class="st">"B73"</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mvw</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"003"</span>, <span class="st">"W605S"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mvw</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"004"</span>, <span class="st">"MM"</span>, <span class="st">"Mo17"</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvw</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">mvw</span><span class="op">$</span><span class="va">barcode</span>, <span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvw</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mvw</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="st">"100"</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mvw</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="st">"50"</span>, <span class="st">"0"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvw</span> <span class="op">&lt;-</span> <span class="fu"><a href="bw.time.html">bw.time</a></span><span class="op">(</span><span class="va">mvw</span>, timeCol <span class="op">=</span> <span class="st">"timestamp"</span>, group <span class="op">=</span> <span class="st">"barcode"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">phenotypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"hue_freq"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mvw</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">mvw2</span> <span class="op">&lt;-</span> <span class="fu">bw.outliers</span><span class="op">(</span></span></span>
<span class="r-in"><span>      df <span class="op">=</span> <span class="va">mvw</span>, phenotype <span class="op">=</span> <span class="va">phenotypes</span>, naTo0 <span class="op">=</span> <span class="cn">FALSE</span>, outlierMethod <span class="op">=</span> <span class="st">"cooks"</span>,</span></span>
<span class="r-in"><span>      group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DAS"</span>, <span class="st">"genotype"</span>, <span class="st">"fertilizer"</span><span class="op">)</span>, cutoff <span class="op">=</span> <span class="fl">3</span>, plotgroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barcode"</span>, <span class="st">"rotation"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">mvl</span> <span class="op">&lt;-</span> <span class="fu"><a href="read.pcv.html">read.pcv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"https://media.githubusercontent.com/media/joshqsumner/"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"pcvrTestData/main/pcv4-multi-value-traits.csv"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>, mode <span class="op">=</span> <span class="st">"long"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvl</span><span class="op">$</span><span class="va">genotype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">mvl</span><span class="op">$</span><span class="va">barcode</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvl</span><span class="op">$</span><span class="va">genotype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mvl</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"002"</span>, <span class="st">"B73"</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mvl</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"003"</span>, <span class="st">"W605S"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mvl</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"004"</span>, <span class="st">"MM"</span>, <span class="st">"Mo17"</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvl</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">mvl</span><span class="op">$</span><span class="va">barcode</span>, <span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvl</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mvl</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="st">"100"</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mvl</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="st">"50"</span>, <span class="st">"0"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mvl</span> <span class="op">&lt;-</span> <span class="fu"><a href="bw.time.html">bw.time</a></span><span class="op">(</span><span class="va">mvl</span>, timeCol <span class="op">=</span> <span class="st">"timestamp"</span>, group <span class="op">=</span> <span class="st">"barcode"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">mvl2</span> <span class="op">&lt;-</span> <span class="fu">bw.outliers</span><span class="op">(</span></span></span>
<span class="r-in"><span>      df <span class="op">=</span> <span class="va">mvl</span>, phenotype <span class="op">=</span> <span class="st">"hue_frequencies"</span>, naTo0 <span class="op">=</span> <span class="cn">FALSE</span>, outlierMethod <span class="op">=</span> <span class="st">"cooks"</span>,</span></span>
<span class="r-in"><span>      group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DAS"</span>, <span class="st">"genotype"</span>, <span class="st">"fertilizer"</span><span class="op">)</span>, cutoff <span class="op">=</span> <span class="fl">3</span>, plotgroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barcode"</span>, <span class="st">"rotation"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span>,</span></span>
<span class="r-in"><span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>14 groupings had all observations removed</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>14 groupings had all observations removed</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Josh Sumner <br> Developed in DDPSC Datascience Core Facility <br> Logo design by <a href="https://twitter.com/Kerri_Gilbert" class="external-link">Kerri Gilbert</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

