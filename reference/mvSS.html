<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Ease of use multi-value trait model helper function. — mvSS • pcvr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ease of use multi-value trait model helper function. — mvSS"><meta name="description" content="This function provides a simplified interface to modeling multi-value traits using growthSS.
Output from this should be passed to fitGrowth to fit the specified model."><meta property="og:description" content="This function provides a simplified interface to modeling multi-value traits using growthSS.
Output from this should be passed to fitGrowth to fit the specified model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home page"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/pcvr.html">pcvr</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal.html">Longitudinal Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/roots.html">Root Phenotyping</a></li>
    <li><a class="dropdown-item" href="../articles/directional.html">Directional Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_conjugate.html">Conjugate Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_igm.html">Intermediate Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_agm.html">Advanced Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_mvt.html">Multi-Value Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/field_capacity.html">Water Derived Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/reading_pcv_data.html">Using online PlantCV Output</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quarto-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quarto Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials"><li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/crop_reporter/tutorials/pcvrTutorial_multiValueTraits">Multi-Value Traits</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr" aria-label="View on Github"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV" aria-label="View PlantCV on Github"><span class="fa fa-leaf"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ease of use multi-value trait model helper function.</h1>
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/main/R/mvSS.R" class="external-link"><code>R/mvSS.R</code></a></small>
      <div class="d-none name"><code>mvSS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function provides a simplified interface to modeling multi-value traits using <a href="growthSS.html">growthSS</a>.
Output from this should be passed to <a href="fitGrowth.html">fitGrowth</a> to fit the specified model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mvSS</span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  <span class="va">form</span>,</span>
<span>  sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">df</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"brms"</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  hierarchy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spectral_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"ari"</span>, <span class="st">"ci_rededge"</span>, <span class="st">"cri550"</span>, <span class="st">"cri700"</span>, <span class="st">"egi"</span>, <span class="st">"evi"</span>,</span>
<span>    <span class="st">"gdvi"</span>, <span class="st">"mari"</span>, <span class="st">"mcari"</span>, <span class="st">"mtci"</span>, <span class="st">"ndre"</span>, <span class="st">"ndvi"</span>, <span class="st">"pri"</span>, <span class="st">"psnd_chlorophyll_a"</span>,</span>
<span>    <span class="st">"psnd_chlorophyll_b"</span>, <span class="st">"psnd_caroteniods"</span>, <span class="st">"psri"</span>, <span class="st">"pssr_chlorophyll_a"</span>,</span>
<span>    <span class="st">"pssr_chlorophyll_b"</span>, <span class="st">"pssr_caroteniods"</span>, <span class="st">"rgri"</span>, <span class="st">"rvsi"</span>, <span class="st">"savi"</span>, <span class="st">"sipi"</span>, <span class="st">"sr"</span>,</span>
<span>    <span class="st">"vari"</span>, <span class="st">"vi_green"</span>, <span class="st">"wi"</span>, <span class="st">"fvfm"</span>, <span class="st">"fqfm"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A model specification as in <a href="growthSS.html">growthSS</a>.</p></dd>


<dt id="arg-form">form<a class="anchor" aria-label="anchor" href="#arg-form"></a></dt>
<dd><p>A formula similar to <code>label | value ~ time + id/group</code> where label is a column
of histogram bins, value is the counts within those bins, time is an optional time variable,
id identifies an individual, and group contains the treatment groups. If the time variable
is not included then the individual variable should also not be included.</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>Distributional models passed to <a href="growthSS.html">growthSS</a>.</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Data passed to <a href="growthSS.html">growthSS</a>.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>Starting values or priors, passed to <a href="growthSS.html">growthSS</a>.</p></dd>


<dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>Parameters to vary, passed to <a href="growthSS.html">growthSS</a>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Backend to use, passed to <a href="growthSS.html">growthSS</a>.</p></dd>


<dt id="arg-tau">tau<a class="anchor" aria-label="anchor" href="#arg-tau"></a></dt>
<dd><p>Quantile to model, passed to <a href="growthSS.html">growthSS</a>.</p></dd>


<dt id="arg-hierarchy">hierarchy<a class="anchor" aria-label="anchor" href="#arg-hierarchy"></a></dt>
<dd><p>Formulae describing any hierarchical models, see <a href="growthSS.html">growthSS</a>.</p></dd>


<dt id="arg-spectral-index">spectral_index<a class="anchor" aria-label="anchor" href="#arg-spectral-index"></a></dt>
<dd><p>Optionally, a spectral index
<a href="https://plantcv.readthedocs.io/en/stable/spectral_index/" class="external-link">from those calculated by PlantCV</a>.
If this is given then the appropriate truncation and model family (if applicable)
will be included for the index you are using without you having to write it in the formula.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list of plots showing prior distributions that <code>growthSS</code> would use,
optionally with a plot of simulated growth curves using draws from those priors.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="fitGrowth.html">fitGrowth</a> for fitting the model specified by this list.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mv_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvSim.html">mvSim</a></span><span class="op">(</span>dists <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span>, wide <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mv_df</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">900</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mv_df</span> <span class="op">&lt;-</span> <span class="va">mv_df</span><span class="op">[</span><span class="va">mv_df</span><span class="op">$</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mv_df</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"sim_"</span>, <span class="st">""</span>, <span class="va">mv_df</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ss1</span> <span class="op">&lt;-</span> <span class="fu">mvSS</span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="st">"linear"</span>, form <span class="op">=</span> <span class="va">label</span> <span class="op">|</span> <span class="va">value</span> <span class="op">~</span> <span class="va">group</span>, df <span class="op">=</span> <span class="va">mv_df</span>,</span></span>
<span class="r-in"><span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"brms"</span>, spectral_index <span class="op">=</span> <span class="st">"none"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss1</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Start sampling</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running MCMC with 1 chain...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration:   1 / 1000 [  0%]  (Warmup) </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Exception: student_t_lpdf: Scale parameter is inf, but must be positive finite! (in '/tmp/RtmplFBSkp/model-214b53532f50.stan', line 76, column 6 to column 71)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Exception: student_t_lpdf: Scale parameter is inf, but must be positive finite! (in '/tmp/RtmplFBSkp/model-214b53532f50.stan', line 76, column 6 to column 71)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Exception: student_t_lpdf: Scale parameter is inf, but must be positive finite! (in '/tmp/RtmplFBSkp/model-214b53532f50.stan', line 76, column 6 to column 71)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmplFBSkp/model-214b53532f50.stan', line 60, column 2 to line 61, column 34)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Exception: student_t_lpdf: Scale parameter is inf, but must be positive finite! (in '/tmp/RtmplFBSkp/model-214b53532f50.stan', line 76, column 6 to column 71)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 100 / 1000 [ 10%]  (Warmup) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 200 / 1000 [ 20%]  (Warmup) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 300 / 1000 [ 30%]  (Warmup) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 400 / 1000 [ 40%]  (Warmup) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 500 / 1000 [ 50%]  (Warmup) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 501 / 1000 [ 50%]  (Sampling) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 600 / 1000 [ 60%]  (Sampling) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 700 / 1000 [ 70%]  (Sampling) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 800 / 1000 [ 80%]  (Sampling) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 900 / 1000 [ 90%]  (Sampling) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 Iteration: 1000 / 1000 [100%]  (Sampling) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1 finished in 1.6 seconds.</span>
<span class="r-in"><span><span class="fu"><a href="growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">ss1</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss1</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mvSS-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># when the model is longitudinal the same model is possible with growthSS</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvSim.html">mvSim</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  dists <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">110</span>, sd <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">120</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">135</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  wide <span class="op">=</span> <span class="cn">FALSE</span>, n <span class="op">=</span> <span class="fl">6</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m1</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, times <span class="op">=</span> <span class="fl">6</span> <span class="op">*</span> <span class="fl">180</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvSim.html">mvSim</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  dists <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">85</span>, sd <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">95</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">105</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">110</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  wide <span class="op">=</span> <span class="cn">FALSE</span>, n <span class="op">=</span> <span class="fl">6</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, times <span class="op">=</span> <span class="fl">6</span> <span class="op">*</span> <span class="fl">180</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mv_df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mv_df2</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4320</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mv_df2</span> <span class="op">&lt;-</span> <span class="va">mv_df2</span><span class="op">[</span><span class="va">mv_df2</span><span class="op">$</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mv_df2</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"sim_"</span>, <span class="st">""</span>, <span class="va">mv_df2</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ss_mv0</span> <span class="op">&lt;-</span> <span class="fu">mvSS</span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="st">"linear"</span>, form <span class="op">=</span> <span class="va">label</span> <span class="op">|</span> <span class="va">value</span> <span class="op">~</span> <span class="va">group</span>, df <span class="op">=</span> <span class="va">mv_df2</span>,</span></span>
<span class="r-in"><span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"brms"</span>, spectral_index <span class="op">=</span> <span class="st">"ci_rededge"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ss_mv0</span> <span class="co"># non longitudinal model setup</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linear brms skew_normal model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pcvr formula variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome: label | resp_weights(value) + trunc(lb = -1, ub = Inf)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group: group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> label | resp_weights(value) + trunc(lb = -1, ub = Inf) ~ A </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A ~ 0 + group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id group variable value time label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1     a    sim_1     1    1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  3     a    sim_1     2    3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  4     a    sim_1     1    4     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (5117 rows)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ss_mv1</span> <span class="op">&lt;-</span> <span class="fu">mvSS</span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="st">"linear"</span>, form <span class="op">=</span> <span class="va">label</span> <span class="op">|</span> <span class="va">value</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">group</span>, df <span class="op">=</span> <span class="va">mv_df2</span>,</span></span>
<span class="r-in"><span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"brms"</span>, spectral_index <span class="op">=</span> <span class="st">"ci_rededge"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ss_mv1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> skew_normal: linear brms skew_normal model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pcvr formula variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome: label | resp_weights(value) + trunc(lb = -1, ub = Inf)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X: time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group: group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> label | resp_weights(value) + trunc(lb = -1, ub = Inf) ~ A * time </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ 0 + group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha ~ 0 + group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A ~ 0 + group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id group variable value time label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1     a    sim_1     1    1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  3     a    sim_1     2    3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  4     a    sim_1     1    4     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (5117 rows)</span>
<span class="r-in"><span><span class="va">ss_mv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="growthSS.html">growthSS</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="st">"skew_normal: linear"</span>,</span></span>
<span class="r-in"><span>  form <span class="op">=</span> <span class="va">label</span> <span class="op">|</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/addition-terms.html" class="external-link">resp_weights</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, ub <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">group</span>,</span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">mv_df2</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ss_mv2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> skew_normal: linear brms skew_normal model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pcvr formula variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome: label | resp_weights(value) + trunc(lb = -1, ub = Inf)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X: time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group: group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> label | resp_weights(value) + trunc(lb = -1, ub = Inf) ~ A * time </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ 0 + group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha ~ 0 + group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A ~ 0 + group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id group variable value time label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1     a    sim_1     1    1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  3     a    sim_1     2    3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  4     a    sim_1     1    4     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (5117 rows)</span>
<span class="r-in"><span><span class="co"># ignoring environments and other such details these are identical except for the</span></span></span>
<span class="r-in"><span><span class="co"># function call.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ss_mv1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">ss_mv1</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span>, <span class="va">ss_mv2</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    ignore.environment <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    ignore.srcref <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ss_mv1</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ss_mv2</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">nm</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "call"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/is_installed.html" class="external-link">is_installed</a></span><span class="op">(</span><span class="st">"mnormt"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss_mv1</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">m2</span>, <span class="va">ss_mv1</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss_mv1</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Josh Sumner <br> Developed in DDPSC Datascience Core Facility <br> Logo design by <a href="https://twitter.com/Kerri_Gilbert" class="external-link">Kerri Gilbert</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

