<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Rate based water use efficiency (WUE) is the change in biomass per unit of water
metabolized. Using image based phenotypes and watering data we can calculate pseudo-WUE (pwue) over
time. Here area_pixels is used as a proxy for biomass and transpiration is approximated using
watering data. The equation is then
\(
\frac{P_{t} - P_{t-1}}{W_{t_{end-1}}-W_{t_{start}} }\),
where P is the phenotype and W is the weight before watering.
Absolute value based WUE is the amount of water used to sustain a plants biomass over a given period.
The equation is then
\(\frac{P_{t}}{W_{t_{end-1}}-W_{t_{start}} }\)"><title>Calculate pseudo water use efficiency from phenotype and watering data — pwue • pcvr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate pseudo water use efficiency from phenotype and watering data — pwue"><meta property="og:description" content="Rate based water use efficiency (WUE) is the change in biomass per unit of water
metabolized. Using image based phenotypes and watering data we can calculate pseudo-WUE (pwue) over
time. Here area_pixels is used as a proxy for biomass and transpiration is approximated using
watering data. The equation is then
\(
\frac{P_{t} - P_{t-1}}{W_{t_{end-1}}-W_{t_{start}} }\),
where P is the phenotype and W is the weight before watering.
Absolute value based WUE is the amount of water used to sustain a plants biomass over a given period.
The equation is then
\(\frac{P_{t}}{W_{t_{end-1}}-W_{t_{start}} }\)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-quarto-tutorials">Quarto Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials">
    <a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a>
    <a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a>
    <a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a>
    <a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a>
    <a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV">
    <span class="fa fa-leaf"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate pseudo water use efficiency from phenotype and watering data</h1>
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/HEAD/R/wue.R" class="external-link"><code>R/wue.R</code></a></small>
      <div class="d-none name"><code>pwue.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Rate based water use efficiency (WUE) is the change in biomass per unit of water
metabolized. Using image based phenotypes and watering data we can calculate pseudo-WUE (pwue) over
time. Here area_pixels is used as a proxy for biomass and transpiration is approximated using
watering data. The equation is then
\(
\frac{P_{t} - P_{t-1}}{W_{t_{end-1}}-W_{t_{start}} }\),
where P is the phenotype and W is the weight before watering.</p>
<p>Absolute value based WUE is the amount of water used to sustain a plants biomass over a given period.
The equation is then
\(\frac{P_{t}}{W_{t_{end-1}}-W_{t_{start}} }\)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pwue</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">w</span>,</span>
<span>  pheno <span class="op">=</span> <span class="st">"area_pixels"</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"timestamp"</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"barcode"</span>,</span>
<span>  offset <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  waterCol <span class="op">=</span> <span class="st">"water_amount"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"rate"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>df</dt>
<dd><p>Dataframe containing wide single-value phenotype data.
This should already be aggregated to one row per plant per day (angles/rotations combined).</p></dd>


<dt>w</dt>
<dd><p>Watering data as returned from bw.water.</p></dd>


<dt>pheno</dt>
<dd><p>Phenotype column name, defaults to "area_pixels"</p></dd>


<dt>time</dt>
<dd><p>Variable(s) that identify a plant on a given day.
Defaults to <code>c("barcode", "DAS")</code>.</p></dd>


<dt>id</dt>
<dd><p>Variable(s) that identify a plant over time. Defaults to <code>"barcode"</code>.</p></dd>


<dt>offset</dt>
<dd><p>Optionally you can specify how long before imaging a watering should not be taken into
account. This defaults to 0, meaning that if a plant were watered directly before being imaged then
that water would be counted towards WUE between the current image and the prior one.
This argument is taken to be in seconds.</p></dd>


<dt>waterCol</dt>
<dd><p>Column containing watering amounts in <code>w</code>. This defaults to "watering_amount".</p></dd>


<dt>method</dt>
<dd><p>Which method to use, options are "rate" and "abs". The "rate" method considers WUE as
the change in a phenotype divided by the amount of water added. The "abs" method considers WUE as
the amount of water used by a plant given its absolute size. The former is for questions more
related to efficiency in using water to grow while the latter is more suited to questions about
how efficient a plant is at maintaining size given some amount of water.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame containing the bellwether watering data joined
    to phenotype data with new columns for change in the phenotype,
    change in the pre-watering weight, and pseudo-water use efficiency (pWUE).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sim_water</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"barcode"</span> <span class="op">=</span> <span class="st">"exampleBarcode1"</span>,</span></span>
<span class="r-in"><span><span class="st">"timestamp"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2023-04-13 23:28:17 UTC"</span>,</span></span>
<span class="r-in"><span>                           <span class="st">"2023-04-22 05:30:42 UTC"</span>,</span></span>
<span class="r-in"><span>                           <span class="st">"2023-05-04 18:55:38 UTC"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="st">"DAS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000000</span>,  <span class="fl">8.251675</span>, <span class="fl">20.810660</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="st">"water_amount"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">98</span>, <span class="fl">12</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"barcode"</span> <span class="op">=</span> <span class="st">"exampleBarcode1"</span>,</span></span>
<span class="r-in"><span>                     <span class="st">"timestamp"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2023-04-13 23:28:17 UTC"</span>,</span></span>
<span class="r-in"><span>                                                <span class="st">"2023-04-22 05:30:42 UTC"</span>,</span></span>
<span class="r-in"><span>                                                <span class="st">"2023-05-04 18:55:38 UTC"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     <span class="st">"DAS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000000</span>,  <span class="fl">8</span>, <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     <span class="st">"area_pixels"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1000</span>, <span class="fl">1500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwue</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">sim_df</span>, w <span class="op">=</span> <span class="va">sim_water</span>, pheno <span class="op">=</span> <span class="st">"area_pixels"</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="st">"timestamp"</span>, id <span class="op">=</span> <span class="st">"barcode"</span>, offset <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  waterCol <span class="op">=</span> <span class="st">"water_amount"</span>, method <span class="op">=</span> <span class="st">"rate"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           barcode           timestamp DAS area_pixels total_water pheno_diff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 exampleBarcode1 2023-04-13 23:28:17   0          20          NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 exampleBarcode1 2023-04-22 05:30:42   8        1000           1        980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 exampleBarcode1 2023-05-04 18:55:38  20        1500           1        500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        start                 end timeLengthSeconds offset pWUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         NA 2023-04-13 23:28:17                NA      0   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1681446497 2023-04-22 05:30:42            712945      0  980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1682159442 2023-05-04 18:55:38           1085096      0  500</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">pwue</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">sim_df</span>, w <span class="op">=</span> <span class="va">sim_water</span>, pheno <span class="op">=</span> <span class="st">"area_pixels"</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timestamp"</span>, <span class="st">"timestamp"</span><span class="op">)</span>, id <span class="op">=</span> <span class="st">"barcode"</span>, offset <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  waterCol <span class="op">=</span> <span class="st">"water_amount"</span>, method <span class="op">=</span> <span class="st">"abs"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           barcode           timestamp DAS area_pixels total_water pheno_iter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 exampleBarcode1 2023-04-13 23:28:17   0          20          NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 exampleBarcode1 2023-04-22 05:30:42   8        1000           1       1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 exampleBarcode1 2023-05-04 18:55:38  20        1500           1       1500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        start                 end timeLengthSeconds offset pWUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         NA 2023-04-13 23:28:17                NA      0   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1681446497 2023-04-22 05:30:42            712945      0 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1682159442 2023-05-04 18:55:38           1085096      0 1500</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Josh Sumner, Jeffrey Berry.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

