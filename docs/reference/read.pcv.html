<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Read in plantCV csv output in wide or long format"><title>Read in plantCV csv output in wide or long format — read.pcv • pcvr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read in plantCV csv output in wide or long format — read.pcv"><meta property="og:description" content="Read in plantCV csv output in wide or long format"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-quarto-tutorials">Quarto Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials">
    <a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a>
    <a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a>
    <a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a>
    <a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a>
    <a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV">
    <span class="fa fa-leaf"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Read in plantCV csv output in wide or long format</h1>
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/HEAD/R/readpcv.R" class="external-link"><code>R/readpcv.R</code></a></small>
      <div class="d-none name"><code>read.pcv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Read in plantCV csv output in wide or long format</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read.pcv</span><span class="op">(</span></span>
<span>  <span class="va">filepath</span>,</span>
<span>  mode <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  traitCol <span class="op">=</span> <span class="st">"trait"</span>,</span>
<span>  labelCol <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>  valueCol <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>  reader <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  awk <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>filepath</dt>
<dd><p>Path to csv file of plantCV output.</p></dd>


<dt>mode</dt>
<dd><p>NULL (the default) or one of "wide" or "long", partial string matching is supported.
This controls whether data is <strong>returned</strong> in long or wide format. If left NULL then
the output format will be the same as the input format.</p></dd>


<dt>traitCol</dt>
<dd><p>Column with phenotype names, defaults to "trait".
This should generally not need to be changed from the default. This,
labelCol, and valueCol are used to determine if data are in long format in their
raw state (the csv file itself).</p></dd>


<dt>labelCol</dt>
<dd><p>Column with phenotype labels (units), defaults to "label".
  This should generally not need to be changed from the default.
  This is used with traitCol when <code>mode="wide"</code> to identify
  unique traits since some may be ambiguous
(ellipseCenter.x vs ellipseCenter.y, bins of histograms, etc)</p></dd>


<dt>valueCol</dt>
<dd><p>Column with phenotype values, defaults to "value".
This should generally not need to be changed from the default.</p></dd>


<dt>reader</dt>
<dd><p>The function to use to read in data,
defaults to NULL in which case <code><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">data.table::fread</a></code> is used if filters are in place
and <code>read.csv</code> is used otherwise.
Note that if you use <code>read.csv</code> with filters in place then you will need to specify
<code>header=FALSE</code> so that the piped output from awk is read correctly.
If fread is too slow for your needs then <code><a href="https://vroom.r-lib.org/reference/vroom.html" class="external-link">vroom::vroom()</a></code> may be useful.</p></dd>


<dt>filters</dt>
<dd><p>If a very large pcv output file is read then it may be desireable
to subset it before reading it into R, either for ease of use or because of RAM limitations.
The filter argument works with "COLUMN in VALUES" syntax. This can either be a character vector
or a list of character vectors. In these vectors there needs to be a column name,
one of " in ", " is ", or " = " to match the string exactly, or "contains"
to match with awk style regex, then a set of comma delimited values to filter
that column for (see examples). Note that this and awk both use awk through <code><a href="https://rdrr.io/r/base/connections.html" class="external-link">pipe()</a></code>.
This functionality will not work on a windows system.</p></dd>


<dt>awk</dt>
<dd><p>As an alternative to filters a direct call to awk can be supplied here,
in which case that call will be used through <code><a href="https://rdrr.io/r/base/connections.html" class="external-link">pipe()</a></code>.</p></dd>


<dt>...</dt>
<dd><p>Other arguments passed to the reader function.
In the case of 'fread' there are several defaults provided already
which can be overwritten with these extra arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a data.frame in wide or long format.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In plantCV version 4 the single value traits are returned in wide format from <code>json2csv</code>
and the multi value traits are returned in long format. Briefly plantCV data was returned as one
long table which sparked the emphasis in this function on reading data quickly and parsing it
outside of R. With the current plantCV output these options are largely unnecessary.
When data is read in using read.pcv the traitCol, valueCol, and labelCol arguments are checked
to determine if the data is in long format. This is done to keep compatibility with interim
versions of plantcv output where all outputs were in a single long format file.</p>
<p>With the current implementation and plantcv output you can read wide or long format files into
wide or long format in R. Keep in mind that the 'mode' argument controls the format that will be
returned in R, not the format that the data saved as in your csv file.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Not run:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">mv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"https://media.githubusercontent.com/media/joshqsumner/"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"pcvrTestData/main/pcv4-multi-value-traits.csv"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"https://raw.githubusercontent.com/joshqsumner/"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"pcvrTestData/main/pcv4-single-value-traits.csv"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">w2w</span> <span class="op">&lt;-</span> <span class="fu">read.pcv</span><span class="op">(</span><span class="va">sv</span>, mode <span class="op">=</span> <span class="st">"wide"</span>, reader <span class="op">=</span> <span class="st">"fread"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">w2w</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">w2l</span> <span class="op">&lt;-</span> <span class="fu">read.pcv</span><span class="op">(</span><span class="va">sv</span>, mode <span class="op">=</span> <span class="st">"long"</span>, reader <span class="op">=</span> <span class="st">"fread"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">w2l</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">l2w</span> <span class="op">&lt;-</span> <span class="fu">read.pcv</span><span class="op">(</span><span class="va">mv</span>, mode <span class="op">=</span> <span class="st">"wide"</span>, reader <span class="op">=</span> <span class="st">"fread"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">l2w</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">l2l</span> <span class="op">&lt;-</span> <span class="fu">read.pcv</span><span class="op">(</span><span class="va">mv</span>, mode <span class="op">=</span> <span class="st">"long"</span>, reader <span class="op">=</span> <span class="st">"fread"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">l2l</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Note only data stored on a Unix style system can be subset before reading in.</span></span></span>
<span class="r-in"><span>  <span class="co"># For DDPSC employees there are larger datasets on stargate that</span></span></span>
<span class="r-in"><span>  <span class="co"># better show the benefit of subsetting before reading data in.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">fileBig</span> <span class="op">&lt;-</span> <span class="st">"/shares/mgehan_share/llima/Maize_Project_2022/nir_maize_first_exp_results.csv"</span></span></span>
<span class="r-in"><span>  <span class="co"># library(vroom)</span></span></span>
<span class="r-in"><span>  <span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x3a</span> <span class="op">&lt;-</span> <span class="fu">pcv.sub.read</span><span class="op">(</span></span></span>
<span class="r-in"><span>    inputFile <span class="op">=</span> <span class="va">fileBig</span>, reader <span class="op">=</span> <span class="st">"vroom"</span>,</span></span>
<span class="r-in"><span>    filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"trait in area, perimeter"</span>, <span class="st">"barcode is Ea008AA114352"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start</span></span></span>
<span class="r-in"><span>  <span class="co"># library(data.table)</span></span></span>
<span class="r-in"><span>  <span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x3b</span> <span class="op">&lt;-</span> <span class="fu">pcv.sub.read</span><span class="op">(</span></span></span>
<span class="r-in"><span>    inputFile <span class="op">=</span> <span class="va">fileBig</span>, reader <span class="op">=</span> <span class="st">"fread"</span>,</span></span>
<span class="r-in"><span>    filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"trait in area, perimeter"</span>, <span class="st">"barcode is Ea008AA114352"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start</span></span></span>
<span class="r-in"><span>  <span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x3c</span> <span class="op">&lt;-</span> <span class="fu">pcv.sub.read</span><span class="op">(</span></span></span>
<span class="r-in"><span>    inputFile <span class="op">=</span> <span class="va">fileBig</span>, reader <span class="op">=</span> <span class="st">"read.csv"</span>,</span></span>
<span class="r-in"><span>    filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"trait in area, perimeter"</span>, <span class="st">"barcode is Ea008AA114352"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x3a</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x3b</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x3c</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># There may be situations where you want to use wide mv traits which can read in easily:</span></span></span>
<span class="r-in"><span>  <span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu">read.pcv</span><span class="op">(</span><span class="va">fileBig</span>,</span></span>
<span class="r-in"><span>    reader <span class="op">=</span> <span class="st">"fread"</span>,</span></span>
<span class="r-in"><span>    filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"trait in blue_frequencies"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"wide"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co">## End(Not run)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Josh Sumner, Jeffrey Berry.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

