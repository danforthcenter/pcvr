<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multi Value Trait Analysis with `pcvr` • pcvr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi Value Trait Analysis with `pcvr`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/bellwether.html">Bellwether</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal.html">Longitudinal Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/roots.html">Root Phenotyping</a></li>
    <li><a class="dropdown-item" href="../articles/directional.html">Directional Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_conjugate.html">Conjugate Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_igm.html">Intermediate Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_agm.html">Advanced Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_mvt.html">Multi-Value Traits Tutorial</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quarto-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quarto Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials">
<li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/crop_reporter/tutorials/pcvrTutorial_multiValueTraits">Multi-Value Traits</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV"><span class="fa fa-leaf"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multi Value Trait Analysis with `pcvr`</h1>
            <h3 data-toc-skip class="subtitle">pcvr v1.0.0</h3>
                        <h4 data-toc-skip class="author">Josh
Sumner</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/main/vignettes/articles/pcvrTutorial_mvt.Rmd" class="external-link"><code>vignettes/articles/pcvrTutorial_mvt.Rmd</code></a></small>
      <div class="d-none name"><code>pcvrTutorial_mvt.Rmd</code></div>
    </div>

    
    
<div class="section level2 smaller">
<h2 class="smaller" id="outline">Outline<a class="anchor" aria-label="anchor" href="#outline"></a>
</h2>
<ul>
<li>
<code>pcvr</code> Goals</li>
<li>Load Package</li>
<li>What are multi value traits?</li>
<li>Multi value trait format</li>
<li>Functions for multi-value trait analysis</li>
<li><code>pcv.joyplot</code></li>
<li><code>pcv.emd</code></li>
<li><code>pcv.net</code></li>
<li><code>conjugate</code></li>
<li>Resources</li>
</ul>
</div>
<div class="section level2">
<h2 id="pcvr-goals">
<code>pcvr</code> Goals<a class="anchor" aria-label="anchor" href="#pcvr-goals"></a>
</h2>
<p>Currently <code>pcvr</code> aims to:</p>
<ul>
<li>Make common tasks easier and consistent</li>
<li>Make select Bayesian statistics easier</li>
</ul>
<p>There is room for goals to evolve based on feedback and scientific
needs.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="load-package">Load package<a class="anchor" aria-label="anchor" href="#load-package"></a>
</h2>
<p>Pre-work was to install R, Rstudio, and <code>pcvr</code> with
dependencies.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danforthcenter/pcvr" class="external-link">pcvr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="what-are-multi-value-traits">What are multi-value traits?<a class="anchor" aria-label="anchor" href="#what-are-multi-value-traits"></a>
</h2>
<p>Sometimes a single value cannot describe a phenotype adequately.</p>
<p><img src="segImage2.png"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="what-are-multi-value-traits-1">What are multi-value traits?<a class="anchor" aria-label="anchor" href="#what-are-multi-value-traits-1"></a>
</h2>
<p>Here our segmentation easily shows area, height, and other numeric
phenotypes. To describe the color of this plant then we need a more
complex phenotype.</p>
<p><img src="segImage2.png"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="what-are-multi-value-traits-2">What are multi-value traits?<a class="anchor" aria-label="anchor" href="#what-are-multi-value-traits-2"></a>
</h2>
<p>There are many ways to describe color, many wavelengths to measure
color in, and many indices that can be calculated from those
wavelengths.</p>
<p>Since each pixel has a color we describe the entire image using a
histogram of those values</p>
<div class="float">
<img src="HSV_color_solid_cylinder_saturation_gray.png" alt="Wikipedia HSV Color Space"><div class="figcaption">Wikipedia HSV Color Space</div>
</div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="multi-value-trait-format">Multi value trait format<a class="anchor" aria-label="anchor" href="#multi-value-trait-format"></a>
</h2>
<p>PlantCV returns multi-value traits as histograms in long format</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>,</span>
<span>  <span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>,</span>
<span>  <span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span></span>
<span><span class="op">)</span>, trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"hue_frequencies"</span>,</span>
<span>  <span class="st">"hue_frequencies"</span>, <span class="st">"hue_frequencies"</span>, <span class="st">"hue_frequencies"</span>, <span class="st">"hue_frequencies"</span>,</span>
<span>  <span class="st">"hue_frequencies"</span>, <span class="st">"hue_frequencies"</span>, <span class="st">"hue_frequencies"</span>, <span class="st">"hue_frequencies"</span>,</span>
<span>  <span class="st">"hue_frequencies"</span>, <span class="st">"hue_frequencies"</span>, <span class="st">"hue_frequencies"</span>, <span class="st">"hue_frequencies"</span>,</span>
<span>  <span class="st">"hue_frequencies"</span>, <span class="st">"hue_frequencies"</span></span>
<span><span class="op">)</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.805186656906828</span>,</span>
<span>  <span class="fl">1.04569695702186</span>, <span class="fl">1.19906584405173</span>, <span class="fl">1.76025654432012</span>, <span class="fl">2.43647390986092</span>,</span>
<span>  <span class="fl">3.29220258635714</span>, <span class="fl">4.97926034368573</span>, <span class="fl">6.07201366377357</span>, <span class="fl">8.33071909094078</span>,</span>
<span>  <span class="fl">8.61131444107498</span>, <span class="fl">8.26100596047266</span>, <span class="fl">7.65624455366168</span>, <span class="fl">6.45543588134825</span>,</span>
<span>  <span class="fl">5.53347973090732</span>, <span class="fl">5.05245913067726</span></span>
<span><span class="op">)</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">81L</span>, <span class="fl">83L</span>, <span class="fl">85L</span>,</span>
<span>  <span class="fl">87L</span>, <span class="fl">89L</span>, <span class="fl">91L</span>, <span class="fl">93L</span>, <span class="fl">95L</span>, <span class="fl">97L</span>, <span class="fl">99L</span>, <span class="fl">101L</span>, <span class="fl">103L</span>, <span class="fl">105L</span>, <span class="fl">107L</span>, <span class="fl">109L</span></span>
<span><span class="op">)</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fl">3641</span><span class="op">:</span><span class="fl">3655</span>, class <span class="op">=</span> <span class="st">"data.frame"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       sample           trait     value label</span></span>
<span><span class="co">## 3641 default hue_frequencies 0.8051867    81</span></span>
<span><span class="co">## 3642 default hue_frequencies 1.0456970    83</span></span>
<span><span class="co">## 3643 default hue_frequencies 1.1990658    85</span></span>
<span><span class="co">## 3644 default hue_frequencies 1.7602565    87</span></span>
<span><span class="co">## 3645 default hue_frequencies 2.4364739    89</span></span>
<span><span class="co">## 3646 default hue_frequencies 3.2922026    91</span></span>
<span><span class="co">## 3647 default hue_frequencies 4.9792603    93</span></span>
<span><span class="co">## 3648 default hue_frequencies 6.0720137    95</span></span>
<span><span class="co">## 3649 default hue_frequencies 8.3307191    97</span></span>
<span><span class="co">## 3650 default hue_frequencies 8.6113144    99</span></span>
<span><span class="co">## 3651 default hue_frequencies 8.2610060   101</span></span>
<span><span class="co">## 3652 default hue_frequencies 7.6562446   103</span></span>
<span><span class="co">## 3653 default hue_frequencies 6.4554359   105</span></span>
<span><span class="co">## 3654 default hue_frequencies 5.5334797   107</span></span>
<span><span class="co">## 3655 default hue_frequencies 5.0524591   109</span></span></code></pre>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="multi-value-trait-format-1">Multi value trait format<a class="anchor" aria-label="anchor" href="#multi-value-trait-format-1"></a>
</h2>
<p>In <code>pcvr</code> you can choose to read multi value traits in
wide format with <code>mode="wide"</code> in <code>read.pcv</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hue_frequencies.45 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.0154487872701993</span>, <span class="fl">0</span>,</span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span></span>
<span><span class="op">)</span>, hue_frequencies.47 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.0749063670411985</span>,</span>
<span>  <span class="fl">0</span></span>
<span><span class="op">)</span>, hue_frequencies.49 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.0308975745403986</span>, <span class="fl">0.37593984962406</span>,</span>
<span>  <span class="fl">0.0774593338497289</span>, <span class="fl">0</span>, <span class="fl">0</span></span>
<span><span class="op">)</span>, hue_frequencies.51 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>  <span class="fl">0.0657894736842105</span></span>
<span><span class="op">)</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fl">100</span><span class="op">:</span><span class="fl">104</span>, class <span class="op">=</span> <span class="st">"data.frame"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     hue_frequencies.45 hue_frequencies.47 hue_frequencies.49 hue_frequencies.51</span></span>
<span><span class="co">## 100         0.01544879         0.00000000         0.03089757         0.00000000</span></span>
<span><span class="co">## 101         0.00000000         0.00000000         0.37593985         0.00000000</span></span>
<span><span class="co">## 102         0.00000000         0.00000000         0.07745933         0.00000000</span></span>
<span><span class="co">## 103         0.00000000         0.07490637         0.00000000         0.00000000</span></span>
<span><span class="co">## 104         0.00000000         0.00000000         0.00000000         0.06578947</span></span></code></pre>
<p>. . .</p>
<p>Either option will work for most <code>pcvr</code> functions.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="functions-for-multi-value-trait-analysis">Functions for multi-value trait analysis<a class="anchor" aria-label="anchor" href="#functions-for-multi-value-trait-analysis"></a>
</h2>
<ul>
<li><code>pcv.joyplot</code></li>
<li><code>pcv.emd</code></li>
<li><code>pcv.net</code></li>
<li><code>conjugate</code></li>
</ul>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="simulated-data">Simulated data<a class="anchor" aria-label="anchor" href="#simulated-data"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">simFreqs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vec</span>, <span class="va">group</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">vec</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">181</span>, <span class="fl">1</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">counts</span></span>
<span>  <span class="va">s1d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">s1</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">s1d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sim_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">180</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">s1d</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sim_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">simFreqs</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">70</span>, <span class="fl">10</span><span class="op">)</span>, group <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">simFreqs</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, <span class="fl">0.35</span><span class="op">)</span>, group <span class="op">=</span> <span class="st">"lognormal"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">simFreqs</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">125</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">75</span>, <span class="fl">75</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, group <span class="op">=</span> <span class="st">"bimodal"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">simFreqs</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">0.3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">70</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">120</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, group <span class="op">=</span> <span class="st">"trimodal"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">simFreqs</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">180</span><span class="op">)</span>, group <span class="op">=</span> <span class="st">"uniform"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sim_df_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">sim_df</span><span class="op">)</span>, id.vars <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sim_df_long</span><span class="op">$</span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"sim_"</span>, <span class="st">""</span>, <span class="va">sim_df_long</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sim_df_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bin</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Color Histogram Bin"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span><span class="op">)</span></span></code></pre></div>
<p>Here we simulate wide data, then lengthen it for plotting.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_plot</span></span></code></pre></div>
<p><img src="pcvrTutorial_mvt_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="pcv-joyplot">
<code>pcv.joyplot</code><a class="anchor" aria-label="anchor" href="#pcv-joyplot"></a>
</h2>
<p>We can make joyplots and using <code>pcv.joyplot</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcv.joyplot.html">pcv.joyplot</a></span><span class="op">(</span><span class="va">sim_df</span>, index <span class="op">=</span> <span class="st">"sim"</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_mvt_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="pcv-joyplot-1">
<code>pcv.joyplot</code><a class="anchor" aria-label="anchor" href="#pcv-joyplot-1"></a>
</h2>
<p>The plot output is a <code>ggplot</code> object so we can change it
to match our needs. Here we show these distributions as if they are
hues.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span>l <span class="op">=</span> <span class="fl">55</span><span class="op">)</span><span class="op">(</span><span class="fl">360</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="pcvrTutorial_mvt_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="pcv-emd">
<code>pcv.emd</code><a class="anchor" aria-label="anchor" href="#pcv-emd"></a>
</h2>
<p>Sometimes the multi-value trait histograms will not follow a unimodal
distribution, or other aspects of what kind of test to use will be
unclear.</p>
<p>For those situations one option is to use earth mover’s distance.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="earth-movers-distance">Earth Mover’s Distance<a class="anchor" aria-label="anchor" href="#earth-movers-distance"></a>
</h2>
<p>EMD measures the amount of work needed to change one histogram into
another.</p>
<p>EMD then can be used to quantify the difference in color
histograms.</p>
<p>Here the EMD would be 0.01 since only 1 count has to move 1 space out
of 100 total observations:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* visual of emd</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">101</span>, <span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="fl">99</span><span class="op">)</span>, <span class="st">"old"</span>, <span class="st">"new"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">[</span><span class="fl">100</span><span class="op">:</span><span class="fl">101</span>, <span class="st">"x"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">y</span> <span class="op">!=</span> <span class="st">"new"</span>, <span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 1"</span>, y <span class="op">=</span> <span class="st">"Counts"</span>, x <span class="op">=</span> <span class="st">"Bin"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">y</span> <span class="op">==</span> <span class="st">"original"</span>, <span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">4.5</span>, xmax <span class="op">=</span> <span class="fl">5.5</span>, ymin <span class="op">=</span> <span class="fl">14</span>, ymax <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"blue"</span>, color <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">5.5</span>, xmax <span class="op">=</span> <span class="fl">6.5</span>, ymin <span class="op">=</span> <span class="fl">6</span>, ymax <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"red"</span>, color <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bin"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.line.y.left <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="pcvrTutorial_mvt_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="pcv-emd-1">
<code>pcv.emd</code><a class="anchor" aria-label="anchor" href="#pcv-emd-1"></a>
</h2>
<p>Here we use the wide data (although long can also be used).</p>
<p>The “reorder” argument specifies groups to arrange together in the
resulting plot if <code>plot=TRUE</code>.</p>
<p>If <code>mat=TRUE</code> then a distance matrix is returned,
otherwise a long dataframe is returned.</p>
<p>For details see <code><a href="../reference/pcv.emd.html">?pcv.emd</a></code></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_emd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcv.emd.html">pcv.emd</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">sim_df</span>, cols <span class="op">=</span> <span class="st">"sim_"</span>, reorder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span>
<span>  mat <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, parallel <span class="op">=</span> <span class="fl">1</span>, raiseError <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="pcv-emd-2">
<code>pcv.emd</code><a class="anchor" aria-label="anchor" href="#pcv-emd-2"></a>
</h2>
<p>Looking at the plot we can see that there are obvious differences
between groups in our data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_emd</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="pcvrTutorial_mvt_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="pcv-net">
<code>pcv.net</code><a class="anchor" aria-label="anchor" href="#pcv-net"></a>
</h2>
<p>With non-matrix <code>pcv.emd</code> output we can make a network to
better understand the color similarities in our data. Here we include a
numeric filter which removes edges with an EMD below that value.</p>
<p>Note that the default behavior changes EMD from a distance to a
dissimilarity.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcv.net.html">pcv.net</a></span><span class="op">(</span><span class="va">sim_emd</span><span class="op">$</span><span class="va">data</span>, filter <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">class</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $nodes</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $edges</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $graph</span></span>
<span><span class="co">## [1] "igraph"</span></span></code></pre>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="net-plot">
<code>net.plot</code><a class="anchor" aria-label="anchor" href="#net-plot"></a>
</h2>
<p>Now we can visualize our network using <code>net.plot</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/net.plot.html">net.plot</a></span><span class="op">(</span><span class="va">n</span>, fill <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">""</span>, title <span class="op">=</span> <span class="st">"Network 1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_color_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"bimodal"</span>, <span class="st">"lognormal"</span>, <span class="st">"normal"</span>,</span>
<span>    <span class="st">"trimodal"</span>, <span class="st">"uniform"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="net-plot-1">
<code>net.plot</code><a class="anchor" aria-label="anchor" href="#net-plot-1"></a>
</h2>
<p>Our results show very clear clustering and highlight that the uniform
distribution is most dissimilar to the others since it is excluded
entirely. We can make another network to include it.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net1</span></span></code></pre></div>
<p><img src="pcvrTutorial_mvt_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="pcv-net-1">
<code>pcv.net</code><a class="anchor" aria-label="anchor" href="#pcv-net-1"></a>
</h2>
<p>Here we specify our filter as a character, which is interpreted as a
quantile here keeping only edges that are above median strength.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcv.net.html">pcv.net</a></span><span class="op">(</span><span class="va">sim_emd</span><span class="op">$</span><span class="va">data</span>, filter <span class="op">=</span> <span class="st">"0.5"</span><span class="op">)</span></span>
<span><span class="va">net2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/net.plot.html">net.plot</a></span><span class="op">(</span><span class="va">n</span>, fill <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">""</span>, title <span class="op">=</span> <span class="st">"Network 2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="pcv-net-2">
<code>pcv.net</code><a class="anchor" aria-label="anchor" href="#pcv-net-2"></a>
</h2>
<p>Now we can see the full layout of our five distributions.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net2</span></span></code></pre></div>
<p><img src="pcvrTutorial_mvt_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="conjugate">
<code>conjugate</code><a class="anchor" aria-label="anchor" href="#conjugate"></a>
</h2>
<p>Sometimes your distributions follow a parameterized distribution in
which case more robust comparisons are possible.</p>
<p>The <code>conjugate</code> function can compare “t” (gaussian means),
“gaussian”, “beta”, “lognormal”, “dirichlet”, and “dirichlet2”
distributions of multi-value traits.</p>
</div>
<div class="section level2">
<h2 id="conjugate-1">
<code>conjugate</code><a class="anchor" aria-label="anchor" href="#conjugate-1"></a>
</h2>
<p>Multi-value traits can be provided to <code>conjugate</code> as
matrices. Here we subset our data to two samples.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="va">sim_df</span><span class="op">[</span><span class="va">sim_df</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"normal"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"sim"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sim_df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="va">sim_df</span><span class="op">[</span><span class="va">sim_df</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"lognormal"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"sim"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sim_df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conjugate-2">
<code>conjugate</code><a class="anchor" aria-label="anchor" href="#conjugate-2"></a>
</h2>
<p>Now we can run <code>conjugate</code> on our samples. Here we use
assume a lognormal distribution.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lognormal"</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>, rope_range <span class="op">=</span> <span class="cn">NULL</span>, rope_ci <span class="op">=</span> <span class="fl">0.89</span>,</span>
<span>  cred.int.level <span class="op">=</span> <span class="fl">0.89</span>, hypothesis <span class="op">=</span> <span class="st">"equal"</span>, support <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conjugate-3">
<code>conjugate</code><a class="anchor" aria-label="anchor" href="#conjugate-3"></a>
</h2>
<p>We can also perform region of practical equivalence tests by
specifying a <code>rope_range</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lognormal"</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>, rope_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, rope_ci <span class="op">=</span> <span class="fl">0.89</span>,</span>
<span>  cred.int.level <span class="op">=</span> <span class="fl">0.89</span>, hypothesis <span class="op">=</span> <span class="st">"equal"</span>, support <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conjugate-4">
<code>conjugate</code><a class="anchor" aria-label="anchor" href="#conjugate-4"></a>
</h2>
<p>The results are also returned as a summary dataframe</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##     hyp post.prob  HDE_rope HDI_rope_low HDI_rope_high rope_prob</span></span>
<span><span class="co">## 1 equal 0.1676276 0.9727331    0.1951233      1.802536         1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<p>If you run into a novel situation please reach out and we will try to
come up with a solution and add it to <code>pcvr</code> if possible.</p>
<p>Good ways to reach out are the help-datascience slack channel and <a href="https://github.com/danforthcenter/pcvr" class="external-link">pcvr github
repository</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Josh Sumner <br> Developed in DDPSC Datascience Core Facility <br> Logo design by <a href="https://twitter.com/Kerri_Gilbert" class="external-link">Kerri Gilbert</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
