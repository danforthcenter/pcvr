<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced Growth Modeling with `pcvr` • pcvr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Advanced Growth Modeling with `pcvr`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/bellwether.html">Bellwether</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal.html">Longitudinal Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/roots.html">Root Phenotyping</a></li>
    <li><a class="dropdown-item" href="../articles/directional.html">Directional Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_conjugate.html">Conjugate Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_igm.html">Intermediate Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_agm.html">Advanced Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_mvt.html">Multi-Value Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/field_capacity.html">Water Derived Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/reading_pcv_data.html">Using online PlantCV Output</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quarto-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quarto Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials">
<li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/crop_reporter/tutorials/pcvrTutorial_multiValueTraits">Multi-Value Traits</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV"><span class="fa fa-leaf"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Advanced Growth Modeling with `pcvr`</h1>
            <h3 data-toc-skip class="subtitle">pcvr v1.1.0.0</h3>
                        <h4 data-toc-skip class="author">Josh
Sumner</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/main/vignettes/articles/pcvrTutorial_agm.Rmd" class="external-link"><code>vignettes/articles/pcvrTutorial_agm.Rmd</code></a></small>
      <div class="d-none name"><code>pcvrTutorial_agm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="outline">Outline<a class="anchor" aria-label="anchor" href="#outline"></a>
</h2>
<ul>
<li>
<code>pcvr</code> Goals</li>
<li>Load Package</li>
<li>Why Longitudinal Modeling?</li>
<li>Why Bayesian Modeling?</li>
<li>Supported Curves</li>
<li><code>growthSS</code></li>
<li><code>fitGrowth</code></li>
<li>
<code>growthPlot</code>/Model Visualization</li>
<li>Hypothesis testing</li>
<li>Threshold models</li>
<li>Using <code>brms</code> directly</li>
<li>Resources</li>
</ul>
</div>
<div class="section level2">
<h2 id="pcvr-goals">
<code>pcvr</code> Goals<a class="anchor" aria-label="anchor" href="#pcvr-goals"></a>
</h2>
<p>Currently <code>pcvr</code> aims to:</p>
<ul>
<li>Make common tasks easier and consistent</li>
<li>Make select Bayesian statistics easier</li>
</ul>
<p>There is room for goals to evolve based on feedback and scientific
needs.</p>
</div>
<div class="section level2">
<h2 id="load-package">Load package<a class="anchor" aria-label="anchor" href="#load-package"></a>
</h2>
<p>Pre-work was to install R, Rstudio, and <code>pcvr</code> with
dependencies.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danforthcenter/pcvr" class="external-link">pcvr</a></span><span class="op">)</span> <span class="co"># or devtools::load_all() if you are editing</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span> <span class="co"># for bayesian models</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Rcpp</span></span></code></pre>
<pre><code><span><span class="co">## Loading 'brms' package (version 2.22.0). Useful instructions</span></span>
<span><span class="co">## can be found by typing help('brms'). A more detailed introduction</span></span>
<span><span class="co">## to the package is available through vignette('brms_overview').</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'brms'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     ar</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span> <span class="co"># for fread</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># for plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co"># to arrange ggplots</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="why-longitudinal-modeling">Why Longitudinal Modeling?<a class="anchor" aria-label="anchor" href="#why-longitudinal-modeling"></a>
</h2>
<p><code>plantCV</code> allows for user friendly high throughput image
based phenotyping</p>
<p>. . .</p>
<p>Resulting data follows individuals over time, which changes our
statistical needs.</p>
</div>
<div class="section level2">
<h2 id="why-longitudinal-modeling-2">Why Longitudinal Modeling? 2<a class="anchor" aria-label="anchor" href="#why-longitudinal-modeling-2"></a>
</h2>
<p>Longitudinal Data is:</p>
<ul>
<li>Autocorrelated</li>
<li>Often non-linear</li>
<li>Heteroskedastic</li>
</ul>
</div>
<div class="section level2">
<h2 id="why-longitudinal-modeling-3">Why Longitudinal Modeling? 3<a class="anchor" aria-label="anchor" href="#why-longitudinal-modeling-3"></a>
</h2>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="why-longitudinal-modeling-4">Why Longitudinal Modeling? 4<a class="anchor" aria-label="anchor" href="#why-longitudinal-modeling-4"></a>
</h2>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="why-longitudinal-modeling-5">Why Longitudinal Modeling? 5<a class="anchor" aria-label="anchor" href="#why-longitudinal-modeling-5"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">[</span><span class="va">simdf</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"y"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">[</span><span class="va">simdf</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">5</span>, <span class="st">"y"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">r3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">[</span><span class="va">simdf</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">10</span>, <span class="st">"y"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">r4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">[</span><span class="va">simdf</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">20</span>, <span class="st">"y"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">main</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, yend <span class="op">=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">5</span>, xend <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, yend <span class="op">=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">10</span>, xend <span class="op">=</span> <span class="fl">10</span>, y <span class="op">=</span> <span class="va">r3</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, yend <span class="op">=</span> <span class="va">r3</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">20</span>, xend <span class="op">=</span> <span class="fl">20</span>, y <span class="op">=</span> <span class="va">r4</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, yend <span class="op">=</span> <span class="va">r4</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Heteroskedasticity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sigma_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">simdf</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sigmaPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html" class="external-link">area</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html" class="external-link">area</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">hetPatch</span> <span class="op">&lt;-</span> <span class="va">main</span> <span class="op">/</span> <span class="va">sigmaPlot</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span><span class="op">)</span></span>
<span><span class="va">hetPatch</span></span></code></pre></div>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="why-bayesian-modeling">Why Bayesian Modeling?<a class="anchor" aria-label="anchor" href="#why-bayesian-modeling"></a>
</h2>
<p>Bayesian modeling allows us to account for all these problems via a
more flexible interface than frequentist methods.</p>
<p>. . .</p>
<p>Bayesian modeling also allows for non-linear, probability driven
hypothesis testing.</p>
</div>
<div class="section level2">
<h2 id="why-bayesian-modeling-2">Why Bayesian Modeling? 2<a class="anchor" aria-label="anchor" href="#why-bayesian-modeling-2"></a>
</h2>
<p>In a Bayesian context we flip “random” and “fixed” elements.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="23%">
<col width="23%">
<col width="23%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Fixed</th>
<th>Random</th>
<th>Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Frequentist</td>
<td><span style="color:goldenrod;">True Effect</span></td>
<td><span style="color:purple;">Data</span></td>
<td>If the <span style="color:goldenrod;">True Effect is 0</span> then
there is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>⋅</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">\alpha\cdot100</annotation></semantics></math>%
chance of <span style="color:purple;">estimating an effect</span> of
this size or more.</td>
</tr>
<tr class="even">
<td>Bayesian</td>
<td><span style="color:purple;">Data</span></td>
<td><span style="color:goldenrod;">True Effect</span></td>
<td>Given the <span style="color:purple;">estimated effect from our
data</span> there is a P probability of the <span style="color:goldenrod;">True Effect</span> being a difference of at
least X</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="why-bayesian-modeling-3">Why Bayesian Modeling? 3<a class="anchor" aria-label="anchor" href="#why-bayesian-modeling-3"></a>
</h2>
<p>Before moving on we should note that each group in your data will
have parameters fit to it. If you have many groups then fitting models
to only a few groups at a time is likely to make your life easier.
Larger models will fit, but they can take a very long time.</p>
<p>It’s generally been easier for the authors to fit 50 models each with
4 groups in them then compare across models than to fit 1 model with 200
groups in it.</p>
</div>
<div class="section level2">
<h2 id="supported-growth-models">Supported Growth Models<a class="anchor" aria-label="anchor" href="#supported-growth-models"></a>
</h2>
<p>There are 13 main growth models supported in <code>pcvr</code>.</p>
<p>Several are shown next, including asymptotic and non-asymptotic
options.</p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-1">Supported Growth Models<a class="anchor" aria-label="anchor" href="#supported-growth-models-1"></a>
</h2>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-2">Supported Growth Models<a class="anchor" aria-label="anchor" href="#supported-growth-models-2"></a>
</h2>
<p>There are an additional 3 sigmoidal models based on the Extreme Value
Distribution. Those are Weibull, Frechet, and Gumbel. The authors
generally prefer Gompertz to these options but for your data it is
possible that these could be a better fit.</p>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-2-1">Supported Growth Models 2<a class="anchor" aria-label="anchor" href="#supported-growth-models-2-1"></a>
</h2>
<p>There are also two double sigmoid curves intended for use with
recovery experiments.</p>
<pre><code><span><span class="co">## Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-3">Supported Growth Models 3<a class="anchor" aria-label="anchor" href="#supported-growth-models-3"></a>
</h2>
<p>Generalized Additive Models (<a href="https://en.wikipedia.org/wiki/Generalized_additive_model" class="external-link">GAMs</a>)
are supported but discouraged due to poor interpretability.</p>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-4">Supported Growth Models 4<a class="anchor" aria-label="anchor" href="#supported-growth-models-4"></a>
</h2>
<p>Intercept only models are supported, although they are only intended
for use in segmented models or to represent homoskedasticity as a
sub-model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    yint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">8</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">9</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">yint</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"y"</span>, x <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-5">Supported Growth Models 5<a class="anchor" aria-label="anchor" href="#supported-growth-models-5"></a>
</h2>
<p>Segmented growth models are also supported using “model1 + model2”
syntax in both <code>growthSim</code> and <code>growthSS</code>.</p>
<p>. . .</p>
<p>For now we will focus on single models but there will be examples of
segmented models later on.</p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-6">Supported Growth Models 6<a class="anchor" aria-label="anchor" href="#supported-growth-models-6"></a>
</h2>
<p>The “decay” keyword can be used to specify a decay model instead. For
now we will focus on growth models as these constitute the large
majority of models used in plant phenotyping.</p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-7">Supported Growth Models 7<a class="anchor" aria-label="anchor" href="#supported-growth-models-7"></a>
</h2>
<p>Hierarchical models can be specified by adding covariates to the
model formula and specifying models for those covariates in the
<code>hierarchy</code> argument.</p>
<p>A hierarchical formula would then be written as
<code>y ~ time + covar | id / group</code> and we could specify to only
model the <code>A</code> parameter as being modeled by
<code>covar</code> by adding
<code>hierarchy = list("A" = "int_linear")</code>.</p>
</div>
<div class="section level2">
<h2 id="survival-models">Survival Models<a class="anchor" aria-label="anchor" href="#survival-models"></a>
</h2>
<p>Survival models can also be specified using the “survival” keyword.
Using the brms backend these models use the weibull distribution by
default but “binomial” family can also be specified by
<code>model = "survival binomial"</code>.</p>
<p>For details please see the <code>growthSS</code> documentation.</p>
</div>
<div class="section level2">
<h2 id="maximaminima-models">Maxima/Minima Models<a class="anchor" aria-label="anchor" href="#maximaminima-models"></a>
</h2>
<p>bragg, lorentz, and beta Maxima/Minima models are available in
<code>growthSS</code>, but should only be used for biologically
appropriate settings. For general trends where data may increase then
decrease some consider changepoint models or splines before using
these.</p>
</div>
<div class="section level2">
<h2 id="growthss">
<code>growthSS</code><a class="anchor" aria-label="anchor" href="#growthss"></a>
</h2>
<p>Any of the aforementioned models can be specified easily using
<code>growthSS</code>.</p>
</div>
<div class="section level2">
<h2 id="growthss---form">
<code>growthSS</code> - form<a class="anchor" aria-label="anchor" href="#growthss---form"></a>
</h2>
<p>With a model specified a rough formula is required to parse your data
to fit the model.</p>
<p>The layout of that formula is:</p>
<p><code>outcome ~ time|individual/group</code></p>
</div>
<div class="section level2">
<h2 id="growthss---form-2">
<code>growthSS</code> - form 2<a class="anchor" aria-label="anchor" href="#growthss---form-2"></a>
</h2>
<p>Here we would use <code>y~time|id/group</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"gompertz"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">160</span><span class="op">)</span>,</span>
<span>    <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>    <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     id group time           y</span></span>
<span><span class="co">## 1 id_1     a    1 0.004058413</span></span>
<span><span class="co">## 2 id_1     a    2 0.022060411</span></span>
<span><span class="co">## 3 id_1     a    3 0.091828381</span></span>
<span><span class="co">## 4 id_1     a    4 0.305290892</span></span>
<span><span class="co">## 5 id_1     a    5 0.839871042</span></span>
<span><span class="co">## 6 id_1     a    6 1.969862435</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="growthss---form-3">
<code>growthSS</code> - form 3<a class="anchor" aria-label="anchor" href="#growthss---form-3"></a>
</h2>
<p>Generally it makes sense to visually check that your formula covers
your experimental design.</p>
<p>Note that it is fine for id to be duplicated between groups, but not
within groups</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># group on id</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># color by group</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Testing Formula"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---sigma">
<code>growthSS</code> - sigma<a class="anchor" aria-label="anchor" href="#growthss---sigma"></a>
</h2>
<p>Recall the heteroskedasticity problem, shown again with our simulated
data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># \ echo: false</span></span>
<span><span class="va">sigma_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">simdf</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---sigma-1">
<code>growthSS</code> - sigma<a class="anchor" aria-label="anchor" href="#growthss---sigma-1"></a>
</h2>
<p>There are lots of ways to model a trend like that we see for
sigma.</p>
<p><code>pcvr</code> allows any of the model options in
<code>growthSS</code> to also be applied to model variance.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draw_gomp_sigma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">23</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">21</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.22</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"gray60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">12</span>, color <span class="op">=</span> <span class="st">"Homoskedastic"</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">5</span>, key_glyph <span class="op">=</span> <span class="va">draw_key_path</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">0.8</span>, intercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"Linear"</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">5</span>, key_glyph <span class="op">=</span> <span class="va">draw_key_path</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"gam"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Spline"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span>, key_glyph <span class="op">=</span> <span class="va">draw_key_path</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_gomp_sigma</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Gompertz"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, begin <span class="op">=</span> <span class="fl">0.1</span>, end <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, title <span class="op">=</span> <span class="st">"Several sigma options"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---intercept-sigma">
<code>growthSS</code> - Intercept sigma<a class="anchor" aria-label="anchor" href="#growthss---intercept-sigma"></a>
</h2>
<table class="table">
<thead><tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr></thead>
<tbody><tr class="odd">
<td>Faster model fitting</td>
<td>Very inaccurate intervals at early timepoints</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">13.8</span>, color <span class="op">=</span> <span class="st">"Homoskedastic"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span>, key_glyph <span class="op">=</span> <span class="va">draw_key_path</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"gray40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, color <span class="op">=</span> <span class="st">"Sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---linear-sigma">
<code>growthSS</code> - Linear sigma<a class="anchor" aria-label="anchor" href="#growthss---linear-sigma"></a>
</h2>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Models still fit quickly</td>
<td>Variance tends to increase non-linearly</td>
</tr>
<tr class="even">
<td>Easy testing on variance model</td>
<td></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"linear"</span>, color <span class="op">=</span> <span class="st">"Linear"</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"gray40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, color <span class="op">=</span> <span class="st">"Sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="growthss---linear-sigma-1">
<code>growthSS</code> - Linear sigma<a class="anchor" aria-label="anchor" href="#growthss---linear-sigma-1"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span></span></code></pre></div>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---gompertz-sigma">
<code>growthSS</code> - Gompertz sigma<a class="anchor" aria-label="anchor" href="#growthss---gompertz-sigma"></a>
</h2>
<table class="table">
<colgroup>
<col width="48%">
<col width="51%">
</colgroup>
<thead><tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Models fit much faster than splines</td>
<td>Slightly slower than linear sub-models</td>
</tr>
<tr class="even">
<td>Variance is often asymptotic</td>
<td>Requires priors on sigma model</td>
</tr>
<tr class="odd">
<td>Easy testing on variance model</td>
<td></td>
</tr>
</tbody>
</table>
<p>Note that these traits are broadly true of logistic and monomolecular
sub models as well.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draw_gomp_sigma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">22</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">9</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.27</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="co"># guesses at parameters</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_gomp_sigma</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"Gompertz"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"gray40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, color <span class="op">=</span> <span class="st">"Sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="growthss---gompertz-sigma-1">
<code>growthSS</code> - Gompertz sigma<a class="anchor" aria-label="anchor" href="#growthss---gompertz-sigma-1"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span></span></code></pre></div>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---spline-sigma">
<code>growthSS</code> - Spline sigma<a class="anchor" aria-label="anchor" href="#growthss---spline-sigma"></a>
</h2>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<thead><tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<span style="color:#FF007B;"><strong>Very</strong></span> flexible
and accurate model for sigma</td>
<td>
<span style="color:#FFD900;"><strong>Significantly</strong></span>
slower than other options</td>
</tr>
<tr class="even">
<td>Fewer priors</td>
<td>Splines can be a black-box</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"gam"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"Spline"</span>, color <span class="op">=</span> <span class="st">"Spline"</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">5</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x</span>, bs <span class="op">=</span> <span class="st">"cs"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"gray40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, color <span class="op">=</span> <span class="st">"Sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="growthss---spline-sigma-1">
<code>growthSS</code> - Spline sigma<a class="anchor" aria-label="anchor" href="#growthss---spline-sigma-1"></a>
</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span></span></code></pre></div>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---other-sigma-models">
<code>growthSS</code> - other sigma models<a class="anchor" aria-label="anchor" href="#growthss---other-sigma-models"></a>
</h2>
<p>You can always add a new sigma formula if something else fits your
needs better.</p>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---distributional-models">
<code>growthSS</code> - Distributional Models<a class="anchor" aria-label="anchor" href="#growthss---distributional-models"></a>
</h2>
<p>Here we have limited the examples to talk about sigma, a parameter of
the Student T distribution that our model belongs to. Written another
way we might say all the previous methods are modeling:</p>
<p>Y ~ T(mu ~ main growth formula, <span style="color:#FF007B;">sigma ~
sigma formula</span>, <span style="color:#FFD900;">nu ~ 1</span>)</p>
</div>
<div class="section level2">
<h2 id="growthss---distributional-models-2">
<code>growthSS</code> - Distributional Models 2<a class="anchor" aria-label="anchor" href="#growthss---distributional-models-2"></a>
</h2>
<p>In <code>pcvr</code> the Student T family is the default for these
models, but other distributions are supported through
<code>"distribution: model"</code> syntax.</p>
<p>In general this is only for special cases where the Gaussian/T does
not capture some important quality of the data. An obvious example could
be leaf counts, which might be modeled as
<code>"poisson: monomolecular"</code>, for instance.</p>
</div>
<div class="section level2">
<h2 id="growthss---distributional-models-3">
<code>growthSS</code> - Distributional Models 3<a class="anchor" aria-label="anchor" href="#growthss---distributional-models-3"></a>
</h2>
<p>You can specify sigma as a list of formulas to model different
distributional parameters separately. Most of the time this is overkill
and adds unnecessary complexity, but the option exists for certain cases
such as ZINB where modeling mean, shape, and zero inflation per group
may make sense.</p>
<p>For details on supported families and their parameterization try
running <code>growthSS(..., sigma=NULL,...)</code> and examining the
priors, or checking <code>?brmfamily</code>.</p>
</div>
<div class="section level2">
<h2 id="growthss---priors">
<code>growthSS</code> - priors<a class="anchor" aria-label="anchor" href="#growthss---priors"></a>
</h2>
<p>Bayesian statistics combine prior distributions and collected data to
form a posterior distribution.</p>
<p>. . .</p>
<p>Luckily, in the growth model context it is pretty easy to set “good
priors”.</p>
</div>
<div class="section level2">
<h2 id="growthss---priors-1">
<code>growthSS</code> - priors<a class="anchor" aria-label="anchor" href="#growthss---priors-1"></a>
</h2>
<p>“Good priors” are generally mildly informative, but not very
strong.</p>
<p>They provide some well vetted evidence, but do not overpower the
data.</p>
</div>
<div class="section level2">
<h2 id="growthss---priors-2">
<code>growthSS</code> - priors<a class="anchor" aria-label="anchor" href="#growthss---priors-2"></a>
</h2>
<p>For our setting we know growth is positive and we should have basic
impressions of what sizes are possible.</p>
<p>At the “weakest” side of these priors we at least know growth is
positive and the camera only can measure some finite space.</p>
</div>
<div class="section level2">
<h2 id="growthss---priors-2-1">
<code>growthSS</code> - priors 2<a class="anchor" aria-label="anchor" href="#growthss---priors-2-1"></a>
</h2>
<p>Default priors in <code>growthSS</code> are log-normal</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">log</mtext><mspace width="0.222em"></mspace><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mn>0.25</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{log}~N(\mu, 0.25)</annotation></semantics></math></p>
<p>This has the benefit of giving a long right tail and strictly
positive values while only requiring us to provide
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="growthss---priors-3">
<code>growthSS</code> - priors 3<a class="anchor" aria-label="anchor" href="#growthss---priors-3"></a>
</h2>
<p>We can see what those log-normal distributions look like with
<code>plotPrior</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">priorPlots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotPrior.html">plotPrior</a></span><span class="op">(</span><span class="va">priors</span><span class="op">)</span></span>
<span><span class="va">priorPlots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">priorPlots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">priorPlots</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---priors-4">
<code>growthSS</code> - priors 4<a class="anchor" aria-label="anchor" href="#growthss---priors-4"></a>
</h2>
<p>Those distributions can still be somewhat abstract, so we can
simulate draws from the priors and see what those values yield in our
growth model.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">twoPriors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">130</span><span class="op">)</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">12</span><span class="op">)</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotPrior.html">plotPrior</a></span><span class="op">(</span><span class="va">twoPriors</span>, <span class="st">"gompertz"</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---priors-5">
<code>growthSS</code> - priors 5<a class="anchor" aria-label="anchor" href="#growthss---priors-5"></a>
</h2>
<p>Our final call to <code>growthSS</code> will look like this for our
sample data.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"gompertz"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  sigma <span class="op">=</span> <span class="st">"gompertz"</span>, df <span class="op">=</span> <span class="va">simdf</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    <span class="st">"sigmaA"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="st">"sigmaB"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmaC"</span> <span class="op">=</span> <span class="fl">0.25</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitgrowth">
<code>fitGrowth</code><a class="anchor" aria-label="anchor" href="#fitgrowth"></a>
</h2>
<p>Now that we have the components for our model from
<code>growthSS</code> we can fit the model with
<code>fitGrowth</code>.</p>
</div>
<div class="section level2">
<h2 id="fitgrowth-2">
<code>fitGrowth</code> 2<a class="anchor" aria-label="anchor" href="#fitgrowth-2"></a>
</h2>
<p>This will call <code>Stan</code> outside of R to run Markov Chain
Monte Carlo (MCMC) to get draws from the posterior distributions. We can
control how <code>Stan</code> runs with additional arguments to
<code>fitGrowth</code>, although the only required argument is the
output from <code>growthSS</code>.</p>
</div>
<div class="section level2">
<h2 id="fitgrowth-2-1">
<code>fitGrowth</code> 2<a class="anchor" aria-label="anchor" href="#fitgrowth-2-1"></a>
</h2>
<p>Here we specify our <code>ss</code> argument to be the output from
<code>growthSS</code> and tell the model to use 4 cores so that the
chains run entirely in parallel, but the rest of this model is using
defaults.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span></span>
<span>  ss <span class="op">=</span> <span class="va">ss</span>, cores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>, chains <span class="op">=</span> <span class="fl">4</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitgrowth-2-2">
<code>fitGrowth</code> 2<a class="anchor" aria-label="anchor" href="#fitgrowth-2-2"></a>
</h2>
<p>Note that there are lots of arguments that can be passed to
<code><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brms::brm</a></code> via <code>fitGrowth</code>.</p>
<p>. . .</p>
<p>One that can be very helpful for fitting complex models is the
<code>control</code> argument, where we can control the sampler’s
behavior.</p>
</div>
<div class="section level2">
<h2 id="fitgrowth-2-3">
<code>fitGrowth</code> 2<a class="anchor" aria-label="anchor" href="#fitgrowth-2-3"></a>
</h2>
<p><code>adapt_delta</code> and <code>tree_depth</code> are both used to
reduce the number of “divergent transitions” which are times that the
sampler has some departure from the True path and which can compromise
the results.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>, chains <span class="op">=</span> <span class="fl">4</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitgrowth-3">
<code>fitGrowth</code> 3<a class="anchor" aria-label="anchor" href="#fitgrowth-3"></a>
</h2>
<p><code>fitGrowth</code> returns a <code>brmsfit</code> object, see
<code><a href="https://paulbuerkner.com/brms/reference/brmsfit-class.html" class="external-link">?brmsfit</a></code> and <code>methods(class="brmsfit")</code> for
general information.</p>
<p>. . .</p>
<p>Within <code>pcvr</code> there are several functions for visualizing
these objects.</p>
</div>
<div class="section level2">
<h2 id="growthplot">
<code>growthPlot</code><a class="anchor" aria-label="anchor" href="#growthplot"></a>
</h2>
<p><code>growthPlot</code> can be used to plot credible intervals of
your model.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-visualization-2">Model Visualization 2<a class="anchor" aria-label="anchor" href="#model-visualization-2"></a>
</h2>
<p>These plots can show one of the benefits of an asymptotic sub model
well.</p>
<p>Here we check our model predictions to 35 days.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span>, timeRange <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-visualization-2-1">Model Visualization 2<a class="anchor" aria-label="anchor" href="#model-visualization-2-1"></a>
</h2>
<p>And now we check those predictions from a spline model, where the
basis functions are not suited for data past day 25.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">fit_spline</span>, form <span class="op">=</span> <span class="va">ss_spline</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss_spline</span><span class="op">$</span><span class="va">df</span>, timeRange <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-visualization-3">Model Visualization 3<a class="anchor" aria-label="anchor" href="#model-visualization-3"></a>
</h2>
<p>We can also plot the posterior distributions and test hypotheses with
<code>brmViolin</code>.</p>
<p>Here hypotheses are tested with <code><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">brms::hypothesis</a></code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brmViolin.html">brmViolin</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">ss</span>, hypothesis <span class="op">=</span> <span class="st">".../A_groupa &gt; 1.05"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: rstan</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: StanHeaders</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## rstan version 2.32.7 (Stan version 2.32.2)</span></span></code></pre>
<pre><code><span><span class="co">## For execution on a local, multicore CPU with excess RAM we recommend calling</span></span>
<span><span class="co">## options(mc.cores = parallel::detectCores()).</span></span>
<span><span class="co">## To avoid recompilation of unchanged Stan programs, we recommend calling</span></span>
<span><span class="co">## rstan_options(auto_write = TRUE)</span></span>
<span><span class="co">## For within-chain threading using `reduce_sum()` or `map_rect()` Stan functions,</span></span>
<span><span class="co">## change `threads_per_chain` option:</span></span>
<span><span class="co">## rstan_options(threads_per_chain = 1)</span></span></code></pre>
<p><img src="pcvrTutorial_agm_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="hypothesis-testing">Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h2>
<p><code><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">brms::hypothesis</a></code> allows for incredibly flexible
hypothesis testing.</p>
<p>Here we test for an asymptote for group A at least 20% larger than
that of group B.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">hypothesis</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"A_groupa &gt; 1.2 * A_groupb"</span><span class="op">)</span><span class="op">$</span><span class="va">hyp</span></span></code></pre></div>
<pre><code><span><span class="co">##                      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio</span></span>
<span><span class="co">## 1 (A_groupa)-(1.2*A_groupb) &gt; 0 6.290106  4.925797 -1.74309 14.41414    8.90099</span></span>
<span><span class="co">##   Post.Prob Star</span></span>
<span><span class="co">## 1     0.899</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="threshold-models">Threshold models<a class="anchor" aria-label="anchor" href="#threshold-models"></a>
</h2>
<p>Segmented Models are specified using “model1 + model2” syntax, with
“+” representing a change point.</p>
<p>. . .</p>
<p>Currently only two phases (one changepoint) are recommended. More
will work but they will slow down the MCMC and may require more fine
tuning.</p>
<p>. . .</p>
<p>These segmented models can also be used to specify sub-models of
distributional parameters.</p>
</div>
<div class="section level2">
<h2 id="linear-linear">linear + linear<a class="anchor" aria-label="anchor" href="#linear-linear"></a>
</h2>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear + linear"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"linear1A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span><span class="op">)</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"linear2A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear + linear"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"spline"</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"linear1A"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">5</span>, <span class="st">"linear2A"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linear-linear-1">linear + linear<a class="anchor" aria-label="anchor" href="#linear-linear-1"></a>
</h2>
<p><img src="linearPlusLinear_fitGrowth.png"></p>
</div>
<div class="section level2">
<h2 id="linear-logistic">linear + logistic<a class="anchor" aria-label="anchor" href="#linear-logistic"></a>
</h2>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"linear + logistic"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"linear1A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span><span class="op">)</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    <span class="st">"logistic2A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span>, <span class="st">"logistic2B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>    <span class="st">"logistic2C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear + logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"spline"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"linear1A"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    <span class="st">"logistic2A"</span> <span class="op">=</span> <span class="fl">100</span>, <span class="st">"logistic2B"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"logistic2C"</span> <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linear-logistic-1">linear + logistic<a class="anchor" aria-label="anchor" href="#linear-logistic-1"></a>
</h2>
<p><img src="linearPlusLogistic_fitGrowth.png"></p>
</div>
<div class="section level2">
<h2 id="linear-gam">linear + gam<a class="anchor" aria-label="anchor" href="#linear-gam"></a>
</h2>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear + gam"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"int"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"linear1A"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linear-gam-1">linear + gam<a class="anchor" aria-label="anchor" href="#linear-gam-1"></a>
</h2>
<p><img src="linearPlusGAM_fitGrowth.png"></p>
</div>
<div class="section level2">
<h2 id="linear-linear-linear">linear + linear + linear<a class="anchor" aria-label="anchor" href="#linear-linear-linear"></a>
</h2>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"linear + linear + linear"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">25</span>, t <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"linear1A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span><span class="op">)</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    <span class="st">"linear2A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"changePoint2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">30</span><span class="op">)</span>, <span class="st">"linear3A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">24</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear + linear + linear"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"spline"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"linear1A"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    <span class="st">"linear2A"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"changePoint2"</span> <span class="op">=</span> <span class="fl">15</span>,</span>
<span>    <span class="st">"linear3A"</span> <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span>, df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linear-linear-linear-1">linear + linear + linear<a class="anchor" aria-label="anchor" href="#linear-linear-linear-1"></a>
</h2>
<p><img src="linearPlusLinearPlusLinear_fitGrowth.png"></p>
</div>
<div class="section level2">
<h2 id="int-int-with-segmented-sigma">int + int with segmented sigma<a class="anchor" aria-label="anchor" href="#int-int-with-segmented-sigma"></a>
</h2>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"int + int"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"int + int"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"int1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"int2"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="co"># main model</span></span>
<span>    <span class="st">"sigmaint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmachangePoint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmaint2"</span> <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span>, <span class="co"># sub model</span></span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="int-int-with-segmented-sigma-1">int + int with segmented sigma<a class="anchor" aria-label="anchor" href="#int-int-with-segmented-sigma-1"></a>
</h2>
<p><img src="intPlusInt_heteroskedastic_fitGrowth.png"></p>
</div>
<div class="section level2">
<h2 id="int-linear-model-and-submodel">int + linear model and submodel<a class="anchor" aria-label="anchor" href="#int-linear-model-and-submodel"></a>
</h2>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"int + linear"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"int + linear"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"int1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"linear2A"</span> <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    <span class="st">"sigmaint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmachangePoint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmalinear2A"</span> <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span>, timeRange <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">40</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="int-linear-model-and-submodel-1">int + linear model and submodel<a class="anchor" aria-label="anchor" href="#int-linear-model-and-submodel-1"></a>
</h2>
<p><img src="intPlusLinear_heteroskedasticIntPlusLinear_fitGrowth.png"></p>
</div>
<div class="section level2">
<h2 id="intlogistic-with-intgam-sub-model">int+logistic with int+gam sub model<a class="anchor" aria-label="anchor" href="#intlogistic-with-intgam-sub-model"></a>
</h2>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"int+logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"int + spline"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"int1"</span> <span class="op">=</span> <span class="fl">5</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    <span class="st">"logistic2A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"logistic2B"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"logistic2C"</span> <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    <span class="st">"sigmaint1"</span> <span class="op">=</span> <span class="fl">5</span>, <span class="st">"sigmachangePoint1"</span> <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="intlogistic-with-intgam-sub-model-1">int+logistic with int+gam sub model<a class="anchor" aria-label="anchor" href="#intlogistic-with-intgam-sub-model-1"></a>
</h2>
<p><img src="intPluslogistic_intPlusGAMSubModel.png"></p>
</div>
<div class="section level2">
<h2 id="example-survival-model">Example survival model<a class="anchor" aria-label="anchor" href="#example-survival-model"></a>
</h2>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"logistic"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">160</span><span class="op">)</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"survival weibull"</span>, type <span class="op">=</span> <span class="st">"brms"</span>,</span>
<span>  form <span class="op">=</span> <span class="va">y</span> <span class="op">&gt;</span> <span class="fl">100</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">df</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, iter <span class="op">=</span> <span class="fl">600</span>, cores <span class="op">=</span> <span class="fl">2</span>, chains <span class="op">=</span> <span class="fl">2</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span><span class="op">)</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p>Here the input data is standard phenotype data with a cutoff to
represent the event (germination for instance) on the left hand side of
the formula.</p>
</div>
<div class="section level2">
<h2 id="example-survival-model-1">Example survival model<a class="anchor" aria-label="anchor" href="#example-survival-model-1"></a>
</h2>
<p><img src="exSurvivalModel.png"></p>
</div>
<div class="section level2">
<h2 id="example-count-model">Example count model<a class="anchor" aria-label="anchor" href="#example-count-model"></a>
</h2>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"count: logistic"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span><span class="op">)</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"poisson: logistic"</span>, <span class="co"># specify poisson family</span></span>
<span>  form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  sigma <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># poisson only has one parameter</span></span>
<span>  df <span class="op">=</span> <span class="va">df</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">8</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, iter <span class="op">=</span> <span class="fl">2000</span>, cores <span class="op">=</span> <span class="fl">4</span>, chains <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-count-model-1">Example count model<a class="anchor" aria-label="anchor" href="#example-count-model-1"></a>
</h2>
<p><img src="exCountModel.png"></p>
</div>
<div class="section level2">
<h2 id="example-hierarchical-model">Example hierarchical model<a class="anchor" aria-label="anchor" href="#example-hierarchical-model"></a>
</h2>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span></span>
<span>  <span class="st">"logistic"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">160</span><span class="op">)</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">simdf</span><span class="op">$</span><span class="va">covar</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">)</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>  form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">covar</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  sigma <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"AI"</span> <span class="op">=</span> <span class="fl">100</span>, <span class="st">"AA"</span> <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    <span class="st">"B"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    <span class="st">"sigmaA"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmaB"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmaC"</span> <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span>,</span>
<span>  hierarchy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="st">"int_linear"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, iter <span class="op">=</span> <span class="fl">1000</span>, cores <span class="op">=</span> <span class="fl">4</span>, chains <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-hierarchical-model-1">Example hierarchical model<a class="anchor" aria-label="anchor" href="#example-hierarchical-model-1"></a>
</h2>
<p>Note for plotting hierarchical models a <code>hierarchy_value</code>
can be specified and defaults to the mean of the <code>covar</code> in
this case.</p>
<p><img src="exHierarchyModel.png"></p>
</div>
<div class="section level2">
<h2 id="evaluating-your-models">Evaluating your models<a class="anchor" aria-label="anchor" href="#evaluating-your-models"></a>
</h2>
<p>John Kruschke wrote a paper on the <a href="https://www.nature.com/articles/s41562-021-01177-7" class="external-link">Bayesian
Analysis and Reporting Guidelines</a> (BARG) to aid in transparency and
reproducibility when using Bayesian methods.</p>
<p>In pcvr some of what Kruschke recommends can be accessed from a
model/list of models using the <code>barg</code> function, see
<code><a href="../reference/barg.html">?barg</a></code> for details on what that entails.</p>
<p>The <code><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">brms::add_criterion</a></code> function can be used to add LOO
IC or WAIC values to models, which can be easily compared against each
other using <code><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">brms::loo_compare</a></code>. The best fitting model is
displayed first, with others ranked relative to that model. Differences
in elpd of at least 5 times the standard error are generally considered
meaningful. These information criteria are unlikely to help make
decisions about small changes to a model but may be useful in
considering whether a changepoint improves the model fit or not, as an
example.</p>
</div>
<div class="section level2">
<h2 id="using-brms-directly">Using <code>brms</code> directly<a class="anchor" aria-label="anchor" href="#using-brms-directly"></a>
</h2>
<p>These functions are all to help use common growth models more
easily.</p>
<p>The choices in <code>pcvr</code> are a small subset of what is
possible with <code>brms</code>, which itself is more limited than
<code>Stan</code>.</p>
</div>
<div class="section level2">
<h2 id="using-brms-directly-1">Using <code>brms</code> directly<a class="anchor" aria-label="anchor" href="#using-brms-directly-1"></a>
</h2>
<p>Our gompertz sigma model looks like this in <code>brms</code>:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">gamma</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.1</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"nu"</span>, lb <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">130</span><span class="op">)</span>, <span class="fl">.25</span><span class="op">)</span>, nlpar <span class="op">=</span> <span class="st">"A"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>, <span class="fl">.25</span><span class="op">)</span>, nlpar <span class="op">=</span> <span class="st">"B"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span>, <span class="fl">.25</span><span class="op">)</span>, nlpar <span class="op">=</span> <span class="st">"C"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>, <span class="fl">.25</span><span class="op">)</span>, nlpar <span class="op">=</span> <span class="st">"subA"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">.25</span><span class="op">)</span>, nlpar <span class="op">=</span> <span class="st">"subB"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span>, <span class="fl">.25</span><span class="op">)</span>, nlpar <span class="op">=</span> <span class="st">"subC"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">form_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">B</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">C</span> <span class="op">*</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula-helpers.html" class="external-link">nlf</a></span><span class="op">(</span><span class="va">sigma</span> <span class="op">~</span> <span class="va">subA</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">subB</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">subC</span> <span class="op">*</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">C</span> <span class="op">+</span> <span class="va">subA</span> <span class="op">+</span> <span class="va">subB</span> <span class="op">+</span> <span class="va">subC</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">group</span>,</span>
<span>  autocor <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/arma.html" class="external-link">arma</a></span><span class="op">(</span><span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">sample</span><span class="op">:</span><span class="va">group</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  nl <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">form_b</span>,</span>
<span>  family <span class="op">=</span> <span class="va">student</span>, prior <span class="op">=</span> <span class="va">prior1</span>, data <span class="op">=</span> <span class="va">simdf</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>, cores <span class="op">=</span> <span class="fl">4</span>, chains <span class="op">=</span> <span class="fl">4</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, silent <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span> <span class="co"># chain initialization at 0 for simplicity</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-brms-directly-2">Using <code>brms</code> directly<a class="anchor" aria-label="anchor" href="#using-brms-directly-2"></a>
</h2>
<p>It can be more work to try new options in <code>brms</code> or
<code>Stan</code>, but if you have a situation not well represented by
the existing models then it may be necessary.</p>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<p>If you run into a novel situation please reach out and we will try to
come up with a solution and add it to <code>pcvr</code> if possible.</p>
<p>Good ways to reach out are the help-datascience slack channel and <a href="https://github.com/danforthcenter/pcvr" class="external-link">pcvr github
repository</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Josh Sumner <br> Developed in DDPSC Datascience Core Facility <br> Logo design by <a href="https://twitter.com/Kerri_Gilbert" class="external-link">Kerri Gilbert</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
