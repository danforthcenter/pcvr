<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Intro to `pcvr` • pcvr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Intro to `pcvr`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/bellwether.html">Bellwether</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal.html">Longitudinal Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/roots.html">Root Phenotyping</a></li>
    <li><a class="dropdown-item" href="../articles/directional.html">Directional Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_conjugate.html">Conjugate Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_igm.html">Intermediate Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_agm.html">Advanced Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_mvt.html">Multi-Value Traits Tutorial</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quarto-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quarto Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials">
<li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/crop_reporter/tutorials/pcvrTutorial_multiValueTraits">Multi-Value Traits</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV"><span class="fa fa-leaf"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Intro to `pcvr`</h1>
            <h3 data-toc-skip class="subtitle">pcvr v1.0.0</h3>
                        <h4 data-toc-skip class="author">Josh
Sumner</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/main/vignettes/articles/pcvrTutorial1.Rmd" class="external-link"><code>vignettes/articles/pcvrTutorial1.Rmd</code></a></small>
      <div class="d-none name"><code>pcvrTutorial1.Rmd</code></div>
    </div>

    
    
<div class="section level2 smaller">
<h2 class="smaller" id="outline">Outline<a class="anchor" aria-label="anchor" href="#outline"></a>
</h2>
<ul>
<li>
<code>pcvr</code> Goals</li>
<li>Load Package</li>
<li>Read in Data</li>
<li>Join metadata</li>
<li>Remove outliers</li>
<li>Single Value Trait Analysis</li>
<li>Longitudinal Analysis</li>
<li>Resources</li>
</ul>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="pcvr-goals">
<code>pcvr</code> Goals<a class="anchor" aria-label="anchor" href="#pcvr-goals"></a>
</h2>
<p>Currently <code>pcvr</code> aims to:</p>
<ul>
<li>Make common tasks easier and consistent</li>
<li>Make select Bayesian statistics easier</li>
</ul>
<p>There is room for goals to evolve based on feedback and scientific
needs.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="load-package">Load package<a class="anchor" aria-label="anchor" href="#load-package"></a>
</h2>
<p>Pre-work was to install R, Rstudio, and <code>pcvr</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danforthcenter/pcvr" class="external-link">pcvr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span> <span class="co"># for fread</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># to change pcvr output plots some</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co"># to combine ggplots</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="read-in-data">Read in Data<a class="anchor" aria-label="anchor" href="#read-in-data"></a>
</h2>
<p>Some plantCV output comes as a very long csv file.</p>
<p>Handling large experiments/those with lots of images can be difficult
if the output is multiple Gb.</p>
<p>. . .</p>
<p>The <code>read.pcv</code> function helps simplify common tasks
related to getting your data ready to use in R.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="read-in-data-2">Read in Data (2)<a class="anchor" aria-label="anchor" href="#read-in-data-2"></a>
</h2>
<p><code>read.pcv</code> takes several arguments but only the filepath
argument is required, most other arguments are for special cases.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/args.html" class="external-link">args</a></span><span class="op">(</span><span class="st">"read.pcv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## function (filepath, mode = NULL, traitCol = "trait", labelCol = "label", </span></span>
<span><span class="co">##     valueCol = "value", reader = NULL, filters = NULL, awk = NULL, </span></span>
<span><span class="co">##     ...) </span></span>
<span><span class="co">## NULL</span></span></code></pre>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="read-in-data-3">Read in Data (3)<a class="anchor" aria-label="anchor" href="#read-in-data-3"></a>
</h2>
<p>To see details about arguments use <code><a href="../reference/read.pcv.html">?read.pcv</a></code>. Three main
features are:</p>
<ul>
<li>
<code>mode</code> Will automatically handle widening/lengthening
data on read in.</li>
<li>
<code>reader</code> allows for use of
<code><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">data.table::fread</a></code>, <code>vroom::vroom</code>, or other
functions to improve speed with large data. This defaults to NULL where
<code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">utils::read.csv</a></code> is used.</li>
<li>
<code>filters</code> allows Unix based systems to subset local large
data without reading it into memory.</li>
</ul>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="read-in-data-4">Read in Data (4)<a class="anchor" aria-label="anchor" href="#read-in-data-4"></a>
</h2>
<p>There are datasets online for use with <code>pcvr</code> examples,
here we read one in as a wide dataframe.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read.pcv.html">read.pcv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>    <span class="st">"https://raw.githubusercontent.com/joshqsumner/"</span>,</span>
<span>    <span class="st">"pcvrTestData/main/pcv4-single-value-traits.csv"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  reader <span class="op">=</span> <span class="st">"fread"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sv</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2854   45</span></span></code></pre>
<p>. . .</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sv</span><span class="op">)</span><span class="op">[</span><span class="fl">19</span><span class="op">:</span><span class="fl">45</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "area_pixels"                        "area_above_reference_pixels"       </span></span>
<span><span class="co">##  [3] "area_below_reference_pixels"        "color_chip_size_median"            </span></span>
<span><span class="co">##  [5] "convex_hull_area_pixels"            "convex_hull_vertices_none"         </span></span>
<span><span class="co">##  [7] "ellipse_angle_degrees"              "ellipse_eccentricity_none"         </span></span>
<span><span class="co">##  [9] "ellipse_major_axis_pixels"          "ellipse_minor_axis_pixels"         </span></span>
<span><span class="co">## [11] "height_pixels"                      "height_above_reference_pixels"     </span></span>
<span><span class="co">## [13] "height_below_reference_pixels"      "horizontal_reference_position_none"</span></span>
<span><span class="co">## [15] "hue_circular_mean_degrees"          "hue_circular_std_degrees"          </span></span>
<span><span class="co">## [17] "hue_median_degrees"                 "in_bounds_none"                    </span></span>
<span><span class="co">## [19] "longest_path_pixels"                "median_color_chip_height_median"   </span></span>
<span><span class="co">## [21] "median_color_chip_width_median"     "object_in_frame_none"              </span></span>
<span><span class="co">## [23] "percent_area_above_reference_none"  "percent_area_below_reference_none" </span></span>
<span><span class="co">## [25] "perimeter_pixels"                   "solidity_none"                     </span></span>
<span><span class="co">## [27] "width_pixels"</span></span></code></pre>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="read-in-data-exercise">
<span style="color:#FFD900;">Read in Data
(exercise)</span><a class="anchor" aria-label="anchor" href="#read-in-data-exercise"></a>
</h2>
<p>Read in the same example dataset from the previous slides as both
wide and long formats. Compare the dimensions of the dataframes and
their size in memory.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="read-in-data-solution">
<span style="color:#FF007B;">Read in Data
(solution)</span><a class="anchor" aria-label="anchor" href="#read-in-data-solution"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read.pcv.html">read.pcv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>    <span class="st">"https://raw.githubusercontent.com/joshqsumner/"</span>,</span>
<span>    <span class="st">"pcvrTestData/main/pcv4-single-value-traits.csv"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"wide"</span>, reader <span class="op">=</span> <span class="st">"fread"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">svw</span><span class="op">)</span> <span class="co"># [1] 2824   45</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">svw</span><span class="op">)</span> <span class="co"># 1304192 bytes</span></span>
<span></span>
<span><span class="va">svl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read.pcv.html">read.pcv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>    <span class="st">"https://raw.githubusercontent.com/joshqsumner/"</span>,</span>
<span>    <span class="st">"pcvrTestData/main/pcv4-single-value-traits.csv"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"long"</span>, reader <span class="op">=</span> <span class="st">"fread"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">svl</span><span class="op">)</span> <span class="co"># [1] 77058    20</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">svl</span><span class="op">)</span> <span class="co"># 10070624 bytes</span></span>
<span><span class="fl">10070624</span> <span class="op">/</span> <span class="fl">1304024</span> <span class="co"># 7.7 times larger in long format</span></span></code></pre></div>
<p>Why does the long data take up so much more space?</p>
<p>. . .</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">svl</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">svw</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># 1:18</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="join-metadata">Join Metadata<a class="anchor" aria-label="anchor" href="#join-metadata"></a>
</h2>
<p>We can either parse the barcodes for design information or join a key
file using common barcodes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://raw.githubusercontent.com/joshqsumner/"</span>,</span>
<span>  <span class="st">"pcvrTestData/main/smallPhenotyperRun_key.csv"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">sv</span>, <span class="va">key</span>, by <span class="op">=</span> <span class="st">"barcode"</span><span class="op">)</span></span></code></pre></div>
<p>. . .</p>
<p>Data joining tends to be straightforward enough, but other metadata
tasks can be more involved.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="handling-time-with-bw-time">Handling time with <code>bw.time</code><a class="anchor" aria-label="anchor" href="#handling-time-with-bw-time"></a>
</h2>
<p>The <code>bw.time</code> function parses timestamps into (optionally)
several kinds of time labels.</p>
<p>Here we show a few examples before using the default behavior to make
DAS, DAP, and DAE (days after start, planting, and emergence).</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="handling-time-with-bw-time-2">Handling time with <code>bw.time</code> (2)<a class="anchor" aria-label="anchor" href="#handling-time-with-bw-time-2"></a>
</h2>
<p><code>bw.time</code> takes an optional <code>mode</code> argument,
which can control how many types of time are output. Here we make Days
after Start (DAS).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bw.time.html">bw.time</a></span><span class="op">(</span><span class="va">sv</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"DAS"</span>, phenotype <span class="op">=</span> <span class="st">"area_pixels"</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barcode"</span>, <span class="st">"rotation"</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span></code></pre>
<p><img src="pcvrTutorial1_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="handling-time-with-bw-time-3">Handling time with <code>bw.time</code> (3)<a class="anchor" aria-label="anchor" href="#handling-time-with-bw-time-3"></a>
</h2>
<p>We can also make Days after Emergence with <code>mode="DAE"</code>,
using a cutoff for emergence on a phenotype.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bw.time.html">bw.time</a></span><span class="op">(</span><span class="va">sv</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"DAE"</span>, phenotype <span class="op">=</span> <span class="st">"area_pixels"</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">10</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barcode"</span>, <span class="st">"rotation"</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span></code></pre>
<p><img src="pcvrTutorial1_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="handling-time-with-bw-time-4">Handling time with <code>bw.time</code> (4)<a class="anchor" aria-label="anchor" href="#handling-time-with-bw-time-4"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bw.time.html">bw.time</a></span><span class="op">(</span><span class="va">sv</span>,</span>
<span>  plantingDelay <span class="op">=</span> <span class="fl">0</span>, phenotype <span class="op">=</span> <span class="st">"area_pixels"</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">10</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barcode"</span>, <span class="st">"rotation"</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>. . .</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svt</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timestamp"</span>, <span class="st">"DAS"</span>, <span class="st">"DAP"</span>, <span class="st">"DAE"</span>, <span class="st">"area_pixels"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##             timestamp DAS DAP DAE area_pixels</span></span>
<span><span class="co">## 1 2023-04-22 22:18:33   8   8   4       15401</span></span>
<span><span class="co">## 2 2023-04-21 00:40:29   6   6   2        6073</span></span>
<span><span class="co">## 3 2023-05-01 23:46:49  17  17  13      159543</span></span>
<span><span class="co">## 4 2023-04-23 22:42:26   9   9   5       24458</span></span>
<span><span class="co">## 5 2023-05-04 18:57:23  19  19  15      218229</span></span>
<span><span class="co">## 6 2023-04-29 23:26:22  15  15  11      106655</span></span>
<span><span class="co">## 7 2023-05-03 02:57:31  18  18  14      193877</span></span>
<span><span class="co">## 8 2023-04-18 23:55:38   4   4   0        1173</span></span></code></pre>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="remove-outliers">Remove Outliers<a class="anchor" aria-label="anchor" href="#remove-outliers"></a>
</h2>
<p>Before removing outliers we aggregate across photos on the same day
of the same plant.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phenotypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">svt</span><span class="op">)</span><span class="op">[</span><span class="fl">19</span><span class="op">:</span><span class="fl">45</span><span class="op">]</span></span>
<span><span class="va">phenoForm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cbind("</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">phenotypes</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">groupForm</span> <span class="op">&lt;-</span> <span class="st">"DAS+barcode+genotype+fertilizer"</span></span>
<span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">phenoForm</span>, <span class="st">"~"</span>, <span class="va">groupForm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sv_ag_with_outliers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">form</span>, data <span class="op">=</span> <span class="va">svt</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sv_ag_with_outliers</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1387   31</span></span></code></pre>
<p>. . .</p>
<p>Now we can remove outliers as the last step before getting into
analysis.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="removing-outliers-with-bw-outliers">Removing Outliers with <code>bw.outliers</code><a class="anchor" aria-label="anchor" href="#removing-outliers-with-bw-outliers"></a>
</h2>
<p>The <code>bw.outliers</code> function uses Cook’s Distance to detect
outliers.</p>
<p>. . .</p>
<p>Cook’s Distance is model (glm) based, so we detect outliers on a
per-phenotype (outcome) basis per some set of groups (design
variables).</p>
<p>. . .</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sv_ag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bw.outliers.html">bw.outliers</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">sv_ag_with_outliers</span>,</span>
<span>  phenotype <span class="op">=</span> <span class="st">"area_pixels"</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DAS"</span>, <span class="st">"genotype"</span>, <span class="st">"fertilizer"</span><span class="op">)</span>,</span>
<span>  plotgroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barcode"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in bw.outliers(df = sv_ag_with_outliers, phenotype = "area_pixels", :</span></span>
<span><span class="co">## 18 groupings had all observations removed</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sv_ag</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="pcvrTutorial1_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sv_ag</span> <span class="op">&lt;-</span> <span class="va">sv_ag</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="single-value-trait-analysis">Single Value Trait Analysis<a class="anchor" aria-label="anchor" href="#single-value-trait-analysis"></a>
</h2>
<p>Some of our most common goals involve comparing single value traits
at a given time.</p>
<p>Even these simple type of questions can take multiple forms, but
before getting into those we’ll rescale our area phenotype to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mtext mathvariant="normal">cm</mtext><mn>2</mn></msup><annotation encoding="application/x-tex">\text{cm}^2</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pxTocm2</span> <span class="op">&lt;-</span> <span class="fl">42.5</span><span class="op">^</span><span class="fl">2</span> <span class="co"># 51^2 / 1.2^2 : px per cm^2 / color chip size</span></span>
<span><span class="va">sv_ag</span><span class="op">$</span><span class="va">area_cm2</span> <span class="op">&lt;-</span> <span class="va">sv_ag</span><span class="op">$</span><span class="va">area_pixels</span> <span class="op">/</span> <span class="va">pxTocm2</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="what-are-we-asking">What are we asking?<a class="anchor" aria-label="anchor" href="#what-are-we-asking"></a>
</h2>
<ul>
<li>Are the means (or distributions) of X groups different?</li>
<li>Is the difference biologically meaningful?</li>
</ul>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="t-tests">T tests<a class="anchor" aria-label="anchor" href="#t-tests"></a>
</h2>
<p>At this point difference of means tests are a common next step.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="va">sv_ag</span><span class="op">[</span><span class="va">sv_ag</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">==</span> <span class="st">"100"</span> <span class="op">&amp;</span> <span class="va">sv_ag</span><span class="op">$</span><span class="va">DAS</span> <span class="op">==</span> <span class="fl">19</span> <span class="op">&amp;</span> <span class="va">sv_ag</span><span class="op">$</span><span class="va">genotype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B73"</span>, <span class="st">"Mo17"</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">area_cm2</span> <span class="op">~</span> <span class="va">genotype</span>, <span class="va">ex</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Welch Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  area_cm2 by genotype</span></span>
<span><span class="co">## t = 10.978, df = 8.04, p-value = 4.053e-06</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group B73 and group Mo17 is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  56.19573 86.05105</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##  mean in group B73 mean in group Mo17 </span></span>
<span><span class="co">##           113.8040            42.6806</span></span></code></pre>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="interpreting-p-values">Interpreting P-values<a class="anchor" aria-label="anchor" href="#interpreting-p-values"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">box</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## function (which = "plot", lty = "solid", ...) </span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##     which &lt;- pmatch(which[1L], c("plot", "figure", "inner", "outer"))</span></span>
<span><span class="co">##     .External.graphics(C_box, which = which, lty = lty, ...)</span></span>
<span><span class="co">##     invisible()</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## &lt;bytecode: 0x5570341aa930&gt;</span></span>
<span><span class="co">## &lt;environment: namespace:graphics&gt;</span></span></code></pre>
<p>Based on an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
of 0.05 we would say that B73 and Mo17 have statistically significant
differences in size 19 days after planting.</p>
<p>. . .</p>
<p>But correct interpretation does not tell us the probability that one
genotype is larger than the other.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="interpreting-p-values-2">Interpreting P-values (2)<a class="anchor" aria-label="anchor" href="#interpreting-p-values-2"></a>
</h2>
<div class="float">
<img src="https://imgs.xkcd.com/comics/p_values.png" alt="xkcd P-values"><div class="figcaption">xkcd P-values</div>
</div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="interpreting-p-values-3">Interpreting P-values (3)<a class="anchor" aria-label="anchor" href="#interpreting-p-values-3"></a>
</h2>
<p>Correct interpretation: If these two genotypes have the same area at
the population level then there would be a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo><mi>P</mi><mi>%</mi></mrow><annotation encoding="application/x-tex">\le P\%</annotation></semantics></math>
chance of estimating the observed difference.</p>
<p>We can ask more specific questions using different tools.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="posterior-probability">Posterior Probability<a class="anchor" aria-label="anchor" href="#posterior-probability"></a>
</h2>
<p>In Bayesian statistics posterior probability is used instead of
p-values.</p>
<p>The interpretation is much simpler, posterior probability is the
probability that some hypothesis is true given the observed data and
prior evidence.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="bayesian-vs-frequentist">Bayesian vs Frequentist<a class="anchor" aria-label="anchor" href="#bayesian-vs-frequentist"></a>
</h2>
<p>In a Bayesian context we flip “random” and “fixed” elements.</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="16%">
<col width="16%">
<col width="51%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Fixed</th>
<th>Random</th>
<th>Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Frequentist</td>
<td><span style="color:goldenrod;">True Effect</span></td>
<td><span style="color:purple;">Data</span></td>
<td>If the <span style="color:goldenrod;">True Effect is 0</span> then
there is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>⋅</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">\alpha\cdot100</annotation></semantics></math>%
chance of <span style="color:purple;">estimating an effect</span> of
this size or more.</td>
</tr>
<tr class="even">
<td>Bayesian</td>
<td><span style="color:purple;">Data</span></td>
<td><span style="color:goldenrod;">True Effect</span></td>
<td>Given the <span style="color:purple;">estimated effect from our
data</span> there is a P probability of the <span style="color:goldenrod;">True Effect</span> being a difference of at
least X</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="bayesian-vs-frequentist-2">Bayesian vs Frequentist (2)<a class="anchor" aria-label="anchor" href="#bayesian-vs-frequentist-2"></a>
</h2>
<p>You should pick statistical methods and your design models based on
your research questions.</p>
<p>Be aware of the advantages and limitations that come with your
phrasing of a question and chosen method.</p>
<p>One of the goals in <code>pcvr</code> is to make it easier to answer
a broader range of questions.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="conjugacy">Conjugacy<a class="anchor" aria-label="anchor" href="#conjugacy"></a>
</h2>
<p>Historically Bayesian methods have been difficult to implement
because of computational complexitity.</p>
<p>. . .</p>
<p>Using “conjugate” prior distributions makes simple questions very
quick to answer.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="conjugacy-example">Conjugacy Example<a class="anchor" aria-label="anchor" href="#conjugacy-example"></a>
</h2>
<p><img src="pcvrTutorial1_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="conjugacy-example-1">Conjugacy Example<a class="anchor" aria-label="anchor" href="#conjugacy-example-1"></a>
</h2>
<p><img src="pcvrTutorial1_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="conjugate-function">
<code>conjugate</code> function<a class="anchor" aria-label="anchor" href="#conjugate-function"></a>
</h2>
<p><code>conjugate</code> uses conjugate priors and moments from given
distributions to make computationally light Bayesian comparisons of
single or multi value traits.</p>
<p>Several methods are available for different distributions.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="conjugate-function-2">
<code>conjugate</code> function (2)<a class="anchor" aria-label="anchor" href="#conjugate-function-2"></a>
</h2>
<ul>
<li>t: Difference of means for gaussian data.</li>
<li>gaussian: Difference of distributions for gaussian data.</li>
<li>beta: Difference of distributions for data bounded
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0,1</annotation></semantics></math>
</li>
<li>lognormal: Difference of distributions for log normal data (right
skew)</li>
<li>poisson: Difference of distributions for count data</li>
<li>negative binomial: Alternative difference of distributions for count
data (given “r”)</li>
<li>dirichlet: Difference of categorical distributions (2 versions)</li>
</ul>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="conjugate-function-3">
<code>conjugate</code> function (3)<a class="anchor" aria-label="anchor" href="#conjugate-function-3"></a>
</h2>
<p><img src="pcvrTutorial1_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="bayesian-comparison-with-conjugate">Bayesian comparison with <code>conjugate</code><a class="anchor" aria-label="anchor" href="#bayesian-comparison-with-conjugate"></a>
</h2>
<p>Here is an example of using the <code>conjugate</code> function from
<code>pcvr</code> to do a Bayesian analog to a T test and a region of
practical equivalence (<em>ROPE</em>) comparison.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="va">sv_ag</span><span class="op">[</span><span class="va">sv_ag</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">==</span> <span class="st">"100"</span> <span class="op">&amp;</span> <span class="va">sv_ag</span><span class="op">$</span><span class="va">DAS</span> <span class="op">==</span> <span class="fl">19</span> <span class="op">&amp;</span> <span class="va">sv_ag</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"W605S"</span>, <span class="st">"area_cm2"</span><span class="op">]</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="va">sv_ag</span><span class="op">[</span><span class="va">sv_ag</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">==</span> <span class="st">"50"</span> <span class="op">&amp;</span> <span class="va">sv_ag</span><span class="op">$</span><span class="va">DAS</span> <span class="op">==</span> <span class="fl">19</span> <span class="op">&amp;</span> <span class="va">sv_ag</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"W605S"</span>, <span class="st">"area_cm2"</span><span class="op">]</span></span>
<span><span class="va">conj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"t"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rope_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">125</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="bayesian-comparison-with-conjugate-1">Bayesian comparison with <code>conjugate</code><a class="anchor" aria-label="anchor" href="#bayesian-comparison-with-conjugate-1"></a>
</h2>
<pre><code><span><span class="co">## Warning in cpp_rlst(n, df, mu, sigma): NAs produced</span></span></code></pre>
<pre><code><span><span class="co">## `ci` is too small or x does not contain enough data points, returning</span></span>
<span><span class="co">##   NAs.</span></span>
<span><span class="co">## `ci` is too small or x does not contain enough data points, returning</span></span>
<span><span class="co">##   NAs.</span></span></code></pre>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="bayesian-comparison-with-conjugate-2">Bayesian comparison with <code>conjugate</code>
(2)<a class="anchor" aria-label="anchor" href="#bayesian-comparison-with-conjugate-2"></a>
</h2>
<p><code>conjugate</code> returns a list with several useful
components.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">conj</span>, <span class="va">class</span><span class="op">)</span> <span class="co"># [1:length(conj)]</span></span></code></pre></div>
<pre><code><span><span class="co">## $summary</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $posterior</span></span>
<span><span class="co">## [1] "list"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $plot</span></span>
<span><span class="co">## [1] "patchwork" "gg"        "ggplot"</span></span></code></pre>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="bayesian-comparison-with-conjugate-2-1">Bayesian comparison with <code>conjugate</code>
(2)<a class="anchor" aria-label="anchor" href="#bayesian-comparison-with-conjugate-2-1"></a>
</h2>
<p>The summary item contains HDE and HDI estimates for samples and their
difference (if two samples are provided).</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conj</span><span class="op">$</span><span class="va">summary</span></span></code></pre></div>
<pre><code><span><span class="co">##      HDE_1 HDI_1_low HDI_1_high    HDE_2 HDI_2_low HDI_2_high   hyp post.prob</span></span>
<span><span class="co">## 1 91.12784  71.46182   110.7939 31.24997        NA         NA equal         0</span></span>
<span><span class="co">##   HDE_rope HDI_rope_low HDI_rope_high rope_prob</span></span>
<span><span class="co">## 1       NA           NA            NA        NA</span></span></code></pre>
<p>The posterior item is an updated set of priors. It can be recycled as
more data is collected in Bayesian updating, but the practical speed
difference is trivial.</p>
<p>The remaining items are the plot and data that was used in making the
plot.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="conjugate-exercise">
<span style="color:#FFD900;">conjugate
(exercise)</span><a class="anchor" aria-label="anchor" href="#conjugate-exercise"></a>
</h2>
<p>Convert height from px to cm and report the probability that the
difference in height between B73 in 50% fertilizer and W605x in 0%
fertilizer is larger than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mn>10</mn><mtext mathvariant="normal">cm</mtext><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|10\text{cm}|</annotation></semantics></math>.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="conjugate-solution">
<span style="color:#FF007B;">conjugate
(solution)</span><a class="anchor" aria-label="anchor" href="#conjugate-solution"></a>
</h2>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="va">sv_ag</span><span class="op">[</span><span class="va">sv_ag</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">==</span> <span class="st">"50"</span> <span class="op">&amp;</span> <span class="va">sv_ag</span><span class="op">$</span><span class="va">DAS</span> <span class="op">==</span> <span class="fl">19</span> <span class="op">&amp;</span></span>
<span>              <span class="va">sv_ag</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"B73"</span>, <span class="st">"height_pixels"</span><span class="op">]</span> <span class="op">/</span> <span class="fl">42.5</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="va">sv_ag</span><span class="op">[</span><span class="va">sv_ag</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">==</span> <span class="st">"0"</span> <span class="op">&amp;</span> <span class="va">sv_ag</span><span class="op">$</span><span class="va">DAS</span> <span class="op">==</span> <span class="fl">19</span> <span class="op">&amp;</span></span>
<span>              <span class="va">sv_ag</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"W605S"</span>, <span class="st">"height_pixels"</span><span class="op">]</span> <span class="op">/</span> <span class="fl">42.5</span></span>
<span></span>
<span><span class="va">conj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"gaussian"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span>, <span class="fl">0.1</span><span class="op">)</span>, rope_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># 1-conj$summary$rope_prob: 0.318</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="longitudinal-analysis">Longitudinal Analysis<a class="anchor" aria-label="anchor" href="#longitudinal-analysis"></a>
</h2>
<p>One of the core benefits of image based high throughput phenotyping
is that you can quickly collect non-destructive samples.</p>
<p>Keeping the plants alive allows for longitudinal data on
individuals.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="longitudinal-analysis-challenges">Longitudinal Analysis Challenges<a class="anchor" aria-label="anchor" href="#longitudinal-analysis-challenges"></a>
</h2>
<p>These benefits add complexity to our data.</p>
<p>Longitudinal data is:</p>
<ul>
<li>Autocorrelated</li>
<li>Often non-linear</li>
<li>Heteroskedastic</li>
</ul>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="modeling-longitudinal-data">Modeling longitudinal data<a class="anchor" aria-label="anchor" href="#modeling-longitudinal-data"></a>
</h2>
<p><code>pcvr</code> supports 8 growth models fit with 4 different
methods (<code>nls</code>, <code>nlrq</code>, <code>nlme</code>, and
<code>brms</code>).</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="modeling-longitudinal-data-1">Modeling longitudinal data<a class="anchor" aria-label="anchor" href="#modeling-longitudinal-data-1"></a>
</h2>
<pre><code><span><span class="co">## Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="pcvrTutorial1_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>For this example we subset the data, but we could also model the
entire dataset by making a new <code>group</code> column that has
fertilizer and genotype information.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sub</span> <span class="op">&lt;-</span> <span class="va">sv_ag</span><span class="op">[</span><span class="va">sv_ag</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="st">"W605S"</span>, <span class="op">]</span></span>
<span><span class="va">sub</span><span class="op">$</span><span class="va">fertilizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">fertilizer</span><span class="op">)</span></span></code></pre></div>
<p>To set up our model it generally helps to plot the data and make sure
we can use an appropriate model and can identify our groups and
individuals.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sub</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DAS</span>, y <span class="op">=</span> <span class="va">area_cm2</span>, group <span class="op">=</span> <span class="va">barcode</span>, color <span class="op">=</span> <span class="va">fertilizer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial1_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="initializing-with-growthss">Initializing with <code>growthSS</code><a class="anchor" aria-label="anchor" href="#initializing-with-growthss"></a>
</h2>
<p>The <code>growthSS</code> function serves as a “self starter” for 8
common growth models (logistic, gompertz, monomolecular, linear,
exponential, and power law).</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"gompertz"</span>,</span>
<span>  form <span class="op">=</span> <span class="va">area_cm2</span> <span class="op">~</span> <span class="va">DAS</span> <span class="op">|</span> <span class="va">barcode</span> <span class="op">/</span> <span class="va">fertilizer</span>,</span>
<span>  sigma <span class="op">=</span> <span class="st">"spline"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">sub</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">15</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>See <code><a href="../reference/growthSS.html">?growthSS</a></code> and <code><a href="../reference/growthSim.html">?growthSim</a></code> for
details.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="fitting-with-fitgrowth">Fitting with <code>fitGrowth</code><a class="anchor" aria-label="anchor" href="#fitting-with-fitgrowth"></a>
</h2>
<p>If you are using one of the 6 common growth models supported by
<code>growthSS</code> then you can use <code>fitGrowth</code> to fit the
model using Stan.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">2</span>, chains <span class="op">=</span> <span class="fl">2</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_test</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="plotting-with-growthplot">Plotting with <code>growthPlot</code><a class="anchor" aria-label="anchor" href="#plotting-with-growthplot"></a>
</h2>
<p>Any of the 4 types of growth models can be plotted using
<code>growthPlot</code>.</p>
<p><img src="patched_growthPlots.png"></p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="testing-with-testgrowth">Testing with <code>testGrowth</code><a class="anchor" aria-label="anchor" href="#testing-with-testgrowth"></a>
</h2>
<p>This example uses a Bayesian model where hypothesis testing is much
more robust.</p>
<p>For examples of <code>testGrowth</code> on frequentist models see the
intermediate growth modeling tutorial.</p>
</div>
<div class="section level2 smaller">
<h2 class="smaller" id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<p>For a more complete workflow using a small bellwether dataset see the
<code>bellwether</code> vignette and <a href="https://github.com/danforthcenter/pcvr/tree/main/tutorials" class="external-link">tutorials</a>
on github.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span><span class="st">"pcvr"</span><span class="op">)</span> <span class="co"># requires you to have build vignettes on installation</span></span>
<span><span class="co"># see installation document</span></span></code></pre></div>
<p>The <code>help-datascience</code> DDPSC slack channel and
<code>pcvr</code> <a href="https://github.com/danforthcenter/pcvr" class="external-link">github repository</a> are
good places to ask questions.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Josh Sumner <br> Developed in DDPSC Datascience Core Facility <br> Logo design by <a href="https://twitter.com/Kerri_Gilbert" class="external-link">Kerri Gilbert</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
