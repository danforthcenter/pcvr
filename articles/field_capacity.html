<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Water data • pcvr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Water data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/bellwether.html">Bellwether</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal.html">Longitudinal Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/roots.html">Root Phenotyping</a></li>
    <li><a class="dropdown-item" href="../articles/directional.html">Directional Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_conjugate.html">Conjugate Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_igm.html">Intermediate Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_agm.html">Advanced Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_mvt.html">Multi-Value Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/field_capacity.html">Water Derived Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/reading_pcv_data.html">Using online PlantCV Output</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quarto-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quarto Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials">
<li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/crop_reporter/tutorials/pcvrTutorial_multiValueTraits">Multi-Value Traits</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV"><span class="fa fa-leaf"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Water data</h1>
            <h3 data-toc-skip class="subtitle">pcvr v1.1.1.1</h3>
                        <h4 data-toc-skip class="author">Josh Sumner,
Katie Murphy</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/main/vignettes/articles/field_capacity.Rmd" class="external-link"><code>vignettes/articles/field_capacity.Rmd</code></a></small>
      <div class="d-none name"><code>field_capacity.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danforthcenter/pcvr" class="external-link">pcvr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="outline">Outline<a class="anchor" aria-label="anchor" href="#outline"></a>
</h2>
<ul>
<li>Why water use data is important for plant science.</li>
<li>Overview of WUE vs pWUE</li>
<li>Relevant equations.</li>
<li>Reading in water data</li>
<li>Water diagnostic plots
<ul>
<li>Annotating water diagnostic plots</li>
</ul>
</li>
<li>pWUE calculations and plotting
<ul>
<li>rate</li>
<li>abs</li>
<li>normalized_daily_transpiration</li>
</ul>
</li>
<li>How to make hierarchical models</li>
</ul>
</div>
<div class="section level2">
<h2 id="why-water-data">Why water data?<a class="anchor" aria-label="anchor" href="#why-water-data"></a>
</h2>
<ul>
<li>Water is fundamental to plant life.</li>
<li>Plants need water to survive.</li>
<li>Water is a critical farming resource.</li>
<li>Climate change affects water supply.</li>
</ul>
</div>
<div class="section level2">
<h2 id="how-does-a-plant-use-water">How does a plant use water?<a class="anchor" aria-label="anchor" href="#how-does-a-plant-use-water"></a>
</h2>
<p>Plant water use is controlled by a complex combination of physics,
plant physiology, anatomy, and morphology.</p>
<p>Here’s a brief overview of the “pull theory” of how plants uptake
water from the soil:</p>
<ul>
<li>1: Differences in pressure are a driving force in water movement
(lower pressure at the leaf surface and higher pressure in the
soil).</li>
<li>2: Water enters the plant through roots (note many root traits will
affect how this happens).</li>
<li>3: Water travels through the xylem (channels along plant tissue) due
to capillary action (hydrogen bonds).</li>
<li>4: Water <em>Transpires</em> (aka evaporates) from plant leaves
through stomata (stomata are small pores mostly along the underside of
leaves). This process is similar to us sweating. – The rate of
transpiration depends on <em>Boundary Layer Conductance</em>. — Boundary
Layer Conductance (BLC) is a measure of how easily gas exchange happens
in a small “boundary layer” around the plant. — BLC is changed by
qualities such as leaf shape and angle (think about facing the sun or
standing at an angle) as well as trichome (small hairs on leaf surface)
length and density (think trapping humidity in your hair). –
Transpiration is also depends on stomatal conductance, a combination of
how many stomata there are and how open they are. – Transpiration is
also dependent on environmental conditions such as ambient temperature,
wind speed, atmospheric pressure, light intensity, soil type, soil
moisture content, etc. — <em>Vapor Pressure Deficit</em> (VPD) is
another important variable for transpiration, and is related to air
temperature and humidity. VPD is the difference in the amount of water
in the air vs the amount of water the air can hold at the given
temperature. Since warmer air can hold more water VPD is higher on a hot
day even when relative humidity is held constant, this is an important
consideration for experimental design particularly in growth
chambers.</li>
</ul>
<p>Transpiration has to be balanced carefully by a plant since the plant
is using water both to build new biomass and to cool off; this is not a
1:1 trade-off, and is dependent on all the variables described
above.</p>
<p>There can be secondary consequences to increased transpiration
depending on the experimental design and what you are measuring, for
instance: - Higher transpiration means higher transport of nutrients
into the plant from soil. - Higher transpiration means more transport of
xylem-mobile metabolites in the plant. - Higher transpiration reduces
leaf temperature. - Open stomata (more transpiration) may provide an
avenue for pathogen infection. - Water pH and salt content affect uptake
and the plant health.</p>
</div>
<div class="section level2">
<h2 id="field-capacity">Field Capacity<a class="anchor" aria-label="anchor" href="#field-capacity"></a>
</h2>
<div class="section level3">
<h3 id="what-is-field-capacity">What is field capacity<a class="anchor" aria-label="anchor" href="#what-is-field-capacity"></a>
</h3>
<p>Field capacity is the amount of water held in soil after excess water
has been able to drain and the rate of macropore drainage (water seeping
deeper into the ground) approaches 0. Field capacity depends on numerous
factors and is dependent on soil type. It is a useful measure of soil
water capacity.</p>
</div>
<div class="section level3">
<h3 id="why-do-we-care-about-field-capacity">Why do we care about field capacity<a class="anchor" aria-label="anchor" href="#why-do-we-care-about-field-capacity"></a>
</h3>
<p>Field capacity matters for many types of phenotyping experiments
because it’s used to set target weights for watering. Many systems use a
target field capacity to select the target pot weight, which determines
how much water weight should be added to reach the target field
capacity. Knowing field capacity can also let us evaluate whether or not
plants are actually reaching landmarks we care about for drought stress
as measured by soil water content.</p>
</div>
<div class="section level3">
<h3 id="field-capacity-equations">Field capacity equations<a class="anchor" aria-label="anchor" href="#field-capacity-equations"></a>
</h3>
<ul>
<li><p>Constants in an experiment:</p></li>
<li><p>Reminder: 1 g of water = 1 mL of water</p></li>
<li><p><strong>CSW</strong>: Weight of carriage + saucer = 345
g</p></li>
<li><p><strong>DW</strong>: Weight of dry pot (pot + dry soil) = varies
by experiment, will be provided by Core Facility (one number for the
whole experiment, which is an average of sample pots)</p></li>
<li><p><strong>SW</strong>: Weight of saturated pot (pot + soaked soil)
= varies by experiment, will be provided by Core Facility (one number
for the whole experiment, which is an average of sample pots)</p></li>
<li><p><strong>Saturated Water Volume</strong>: SW - DW</p></li>
<li><p><strong>Target field capacity (%)</strong> = water content /
saturated water volume x 100 = varies by experiment, timepoint, and
treatment, will be provided by Core Facility (number provided per
pot)</p></li>
<li><p>Measured daily (or more frequently) in an experiment:</p></li>
<li><p><strong>Current water content</strong> = current weight - CSW -
DW</p></li>
<li><p><strong>Current field capacity (%)</strong> = current water
content / saturated water volume x 100</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="measuring-water-use">Measuring water use<a class="anchor" aria-label="anchor" href="#measuring-water-use"></a>
</h2>
<p>Measuring water use can be difficult. Broadly, we can either measure
water vapor released from the plant or measure the amount of water
removed from the soil. Here we focus on weight changes to the pot.</p>
<p>Measuring water use via weight changes in a pot has some caveats.
Assumptions: - Sometimes we assume there is negligible transpiration at
night (when lights are off, stomata are closed); this is used for DiTech
calculations, but not Bellwether. - We assume the only way that water is
lost from the pot is via transpiration through the plant, and not via
evaporation from the soil. - Sometimes we ignore the plant growth in
calculating the amount of water used each day as the change in weight
over time; this is used for Bellwether, but not DiTech. We can make
adjustments to this assumption based on previous experiments where we
know how much biomass the plants gain each day, and adjust our target
weights accordingly.</p>
<p>In the following plot we look at a simulated plant’s watering data.
This plant has been weighed for 5 days, with water added in the middle
of the night. Plants were weighed shortly before and after watering. The
weight before watering will be used to calculate the current water
content and current field capacity. The target field capacity will be
used to determine how much water to add. The difference in weight
between the “after watering” weight and the following day’s “before
watering” weight are what we will use to calculate transpiration and
<em>water use efficiency</em> (WUE).</p>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="calculating-transpiration">Calculating Transpiration<a class="anchor" aria-label="anchor" href="#calculating-transpiration"></a>
</h2>
<p>Transpiration is calculated as the difference in weight between two
timepoints. Here, we use the weight after watering, and subtract the
weight before watering in the following night to determine the total
water transpired (g) in that time period (here, 1 day).</p>
<p><strong>Note:</strong> the values below are positive because we are
framing the question as “the amount of water transpired”, so despite the
slope of the line (showing mass in the pot) going down we have positive
numbers.</p>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>The absolute amount of water transpired is interesting, but it is
important to normalize this value to plant biomass. We generally expect
larger plants to transpire more water; we may get excited that a
genotype transpires more water than another, when really it was jut a
bigger plant! We need to look at transpiration relative to plant
biomass. We will do so with two measurements: <em>Normalized
Transpiration</em> or <em>Water Use Efficiency</em>.</p>
<p>To normalize transpiration, we need to know the total plant biomass,
or a proxy of this measurement. Below is an example where we know the
plant biomass each day, and will divide the daily transpiration by the
plant biomass that day to get <em>Normalized Transpiration</em>.</p>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="wue">WUE<a class="anchor" aria-label="anchor" href="#wue"></a>
</h2>
<p>Another important water metric is water use efficiency. Water use
efficiency is generally calculated as a rate of biomass gained per unit
of water. In other words, how much biomass was added to the plant for
the amount of water used in the same time period? A good analogy is the
miles per gallon of fuel that a car may get; WUE is dependent on
genotype and environment, just like a car’s MPG is dependent on the type
of car and the road it is driving on (freeway vs. city roads).</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>Δ</mi><msub><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">Biomass</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msub></mrow><msub><mtext mathvariant="normal">Water Transpired</mtext><mi>t</mi></msub></mfrac><annotation encoding="application/x-tex">\frac{\Delta(\text{Biomass})_t}{\text{Water Transpired}_t}</annotation></semantics></math></p>
<p>WUE might also be considered as the amount of water used to sustain a
given biomass, which here is referred to as “absolute WUE”.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><msub><mtext mathvariant="normal">Biomass</mtext><mi>t</mi></msub><msub><mtext mathvariant="normal">Water Transpired</mtext><mi>t</mi></msub></mfrac><annotation encoding="application/x-tex">\frac{\text{Biomass}_t}{\text{Water Transpired}_t}</annotation></semantics></math></p>
<p>Other calculations of WUE include replacements for biomass, such as
grain yield, net carbon dioxide uptake, and more, that are not covered
here.</p>
<div class="section level3">
<h3 id="pwue">PWUE<a class="anchor" aria-label="anchor" href="#pwue"></a>
</h3>
<p>We may not always have daily measurements of plant biomass, since
this would mean killing the plant in a destructive measurement. In
high-throughput plant phenotyping we use a proxy for biomass, such as
leaf area (number of pixels labelled as a plant) captured via plant
images. Because we are using a proxy for biomass we have to call
image-based WUE <em>Pseudo-Water Use Efficiency</em> (pWUE).</p>
<p>In <code>pcvr</code> the <code>pwue</code> function calculates
normalized transpiration, rate based pWUE, and absolute pWUE.</p>
</div>
</div>
<div class="section level2">
<h2 id="reading-in-water-data">Reading in water data<a class="anchor" aria-label="anchor" href="#reading-in-water-data"></a>
</h2>
<p>In this article we’ll use simulated data, but the
<code>bw.water</code> function may be helpful for you reading in JSON
Lemnatech metadata.</p>
<p>Here for more control we’ll use simulated data:</p>
<div class="section level4">
<h4 id="simulated-data">Simulated Data<a class="anchor" aria-label="anchor" href="#simulated-data"></a>
</h4>
<p>We’ll simulate groups of data with distinct watering and growth
trends.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">days</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">n_plants</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">phenotype_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"death"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"model"</span> <span class="op">=</span> <span class="st">"monomolecular"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">50</span>, B <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"sigmoid"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"model"</span> <span class="op">=</span> <span class="st">"logistic"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">200</span>, B <span class="op">=</span> <span class="fl">12</span>, C <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"abrupt"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"model"</span> <span class="op">=</span> <span class="st">"logistic"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">200</span>, B <span class="op">=</span> <span class="fl">12</span>, C <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"exponential"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"model"</span> <span class="op">=</span> <span class="st">"exponential"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">1</span>, B <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"slowing"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"model"</span> <span class="op">=</span> <span class="st">"power law"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">15</span>, B <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"linear"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"model"</span> <span class="op">=</span> <span class="st">"linear"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">watering_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"constant"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"before"</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    <span class="st">"after"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">25</span>, <span class="va">days</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"target weight"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"before"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">90</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"after"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">days</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"increasing cont"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"before"</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    <span class="st">"after"</span> <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"decreasing cont"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"before"</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    <span class="st">"after"</span> <span class="op">=</span> <span class="op">(</span><span class="va">days</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span> <span class="op">-</span> <span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"increasing step"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"before"</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    <span class="st">"after"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">days</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">75</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">days</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"decreasing step"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"before"</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    <span class="st">"after"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">75</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">days</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">days</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phenotype_conditions</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pc</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p_cond</span> <span class="op">&lt;-</span> <span class="va">phenotype_conditions</span><span class="op">[[</span><span class="va">pc</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">pcvr</span><span class="fu">::</span><span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="va">p_cond</span><span class="op">$</span><span class="va">model</span>,</span>
<span>    n <span class="op">=</span> <span class="va">n_plants</span>, t <span class="op">=</span> <span class="va">days</span>,</span>
<span>    params <span class="op">=</span> <span class="va">p_cond</span><span class="op">$</span><span class="va">params</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="va">pc</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pc"</span>, <span class="st">"area"</span><span class="op">)</span></span>
<span>  <span class="co">#* for this phenotype data make a copy for each watering condition set</span></span>
<span>  <span class="va">pc_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">watering_conditions</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">wc</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">w_cond</span> <span class="op">&lt;-</span> <span class="va">watering_conditions</span><span class="op">[[</span><span class="va">wc</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="co">#* per each individual make weight_before and weight_after columns</span></span>
<span>    <span class="va">wcdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># subset data</span></span>
<span>      <span class="va">sub</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span></span>
<span>      <span class="co"># define vectors for each</span></span>
<span>      <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">w_cond</span><span class="op">$</span><span class="va">before</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">days</span>, <span class="fl">1</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      <span class="va">w</span> <span class="op">&lt;-</span> <span class="va">w_cond</span><span class="op">$</span><span class="va">after</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">w_cond</span><span class="op">$</span><span class="va">before</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="op">(</span><span class="va">sub</span><span class="op">$</span><span class="va">area</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">days</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">w</span> <span class="op">&lt;-</span> <span class="va">b</span> <span class="op">+</span> <span class="va">w_cond</span><span class="op">$</span><span class="va">after</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="co"># add columns</span></span>
<span>      <span class="va">sub</span><span class="op">$</span><span class="va">weight_before</span> <span class="op">&lt;-</span> <span class="va">b</span></span>
<span>      <span class="va">sub</span><span class="op">$</span><span class="va">weight_after</span> <span class="op">&lt;-</span> <span class="va">w</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">wcdf</span><span class="op">$</span><span class="va">wc</span> <span class="op">&lt;-</span> <span class="va">wc</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">wcdf</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">pc_df</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>pc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phenotype_conditions</span><span class="op">)</span>, wc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">watering_conditions</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">key</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">key</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/join.html" class="external-link">join</a></span><span class="op">(</span><span class="va">ex</span>, <span class="va">key</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Joining by: pc, wc</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex</span><span class="op">$</span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ex</span><span class="op">$</span><span class="va">pc</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"sigmoid"</span>, <span class="st">"abrupt"</span>, <span class="st">"exponential"</span>,</span>
<span>    <span class="st">"slowing"</span>, <span class="st">"linear"</span>, <span class="st">"death"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ex</span><span class="op">$</span><span class="va">wc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ex</span><span class="op">$</span><span class="va">wc</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"constant"</span>, <span class="st">"target weight"</span>,</span>
<span>    <span class="st">"increasing cont"</span>, <span class="st">"decreasing cont"</span>,</span>
<span>    <span class="st">"increasing step"</span>, <span class="st">"decreasing step"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="traits-of-the-simulated-data">Traits of the simulated data<a class="anchor" aria-label="anchor" href="#traits-of-the-simulated-data"></a>
</h4>
<p>The simulated data has 6 phenotype trends. Here we’re using simulated
leaf area from a hypothetical 2D image, but the phenotype could be true
plant biomass, or another measurement.</p>
<ul>
<li>
<code>sigmoid</code>: This is typical logistic growth.</li>
<li>
<code>abrupt</code>: Logistic growth with an abrupt growth
period.</li>
<li>
<code>exponential</code>: Exponential growth, non-asymptotic and
speeding up over time.</li>
<li>
<code>slowing</code>: Non-asymptotic growth, slower than
linear.</li>
<li>
<code>linear</code>: Non-asymptotic linear growth.</li>
<li>
<code>death</code>: Slow asymptotic growth with a low
asymptote.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ex</span><span class="op">[</span><span class="va">ex</span><span class="op">$</span><span class="va">wc</span> <span class="op">==</span> <span class="st">"constant"</span>, <span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">area</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Leaf Area (cm"</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Treatments with several different growth trends"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>There are also 6 watering data options in the simulated data.</p>
<ul>
<li>
<code>constant</code>: Pre-watering weight increases with the
phenotype (area), and a constant, specific amount of water is added to
that pre-watered weight. Field capacity is not considered.</li>
<li>
<code>target weight</code>: <strong>Here we assume that the weight
of the plant is negligible</strong> (as we generally assume on
Bellwether-style high-throughput phenotyping experiments). Every day the
plant uses some amount of water and as the plant grows over time that
amount increases, driving the pre-watering weight down over time. At
each watering the pot is filled until it hits a target weight (100g
here, just to use a nice round number) that is calculated based on the
target field capacity.</li>
<li>
<code>increasing cont.</code>: Pre-watering weight increases with
the phenotype (area), and every day a larger, specific amount of water
is added to that pre-watered weight. Field capacity is not considered
and target weight is not used.</li>
<li>
<code>decreasing cont.</code>: Pre-watering weight increases with
the phenotype (area), and every day a smaller, specific amount of water
is added to that pre-watered weight. Field capacity is not considered
and target weight is not used.</li>
<li>
<code>increasing step</code>: Pre-watering weight increases with the
phenotype (area), and a constant, specific amount of water is added to
that pre-watered weight every day, but half way through the experiment
that amount of water increases from 20g to 75g. Field capacity is not
considered and target weight is not used.</li>
<li>
<code>decreasing step</code>: Pre-watering weight increases with the
phenotype (area), and a constant amount of water is added to that
pre-watered weight every day, but half way through the experiment that
amount of water decreases from 75g to 20g. Field capacity is not
considered and target weight is not used.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">ex</span><span class="op">[</span><span class="va">ex</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"sigmoid"</span>, <span class="op">]</span>,</span>
<span>  id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"group"</span>, <span class="st">"time"</span>, <span class="st">"wc"</span><span class="op">)</span>,</span>
<span>  measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weight_before"</span>, <span class="st">"weight_after"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">l</span><span class="op">[</span><span class="va">l</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"id_"</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"weight_before"</span>, <span class="op">-</span><span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">wc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="st">"Weight"</span>, x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Different watering schemes with sigmoid growth"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Here we’ve taken a roundabout way to simulate the amount of water
used by simulated pre-watering weight and post-watering weight since
that is how you’ll get plant weight data most of the time. For water use
the important thing about the above plot is not where the red or blue
points are, only the length of the line between them is important since
that represents the amount of water used. With that in mind we’ll look
at this plot a different way, focusing on the length of the black
lines.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ex</span><span class="op">[</span><span class="va">ex</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="st">"id_1"</span>, <span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">weight_after</span> <span class="op">-</span> <span class="va">weight_before</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">wc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Water Added"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Water added for all watering schemes shown"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        strip.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>        strip.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Looking at the data this way helps drive home the point that water
use can increase, decrease, or remain constant. There are different ways
to increase or decrease, but the we’ll focus on the overall trend now
and limit our simulated data to the <code>constant</code>,
<code>increasing continuous</code>, and
<code>decreasing continuous</code> watering categories.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="va">ex</span><span class="op">[</span><span class="va">ex</span><span class="op">$</span><span class="va">wc</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span>, <span class="st">"increasing cont"</span>, <span class="st">"decreasing cont"</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>Combining everything from those sets of conditions we can look at the
pre vs post watering weights for all 36 of our options. Phenotype (here,
leaf area, but plant biomass could be used) shown in light gray, pot
weight after watering shown in blue.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ex</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">area</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">wc</span> <span class="op">~</span> <span class="va">pc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray70"</span>, linewidth <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">weight_after</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="st">"Weight After Watering"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Weight After Watering For all combinations of conditions"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    strip.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    strip.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="water-data-quality-control-plots">Water data quality control plots<a class="anchor" aria-label="anchor" href="#water-data-quality-control-plots"></a>
</h3>
<p>Before working with water derived metrics it’s generally good to get
a feeling for the raw watering data with similar plots as we used early
on. Here we’re checking that: - there are reasonable looking differences
between subsequent weights - that any treatment groups have the expected
watering pattern - that the weight before watering is lower than the
previous post-watering weight (indicating that transpiration happened).
The length of the black lines between weights here shows the water
added.</p>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>We don’t see anything that raises red flags, so we’ll move on. If
water added was to spike incredibly high, or the different in water
added was not what was intended by the design, it would be a sign that
there was an issue with the equipment.</p>
</div>
</div>
<div class="section level2">
<h2 id="pwue-1">
<code>pwue</code><a class="anchor" aria-label="anchor" href="#pwue-1"></a>
</h2>
<p>The <code>pwue</code> function takes one or two dataframes as input.
If one dataframe is given then it should include phenotype(s) (such as
leaf area or plant biomass) and watering data (pre- and post-watering
weights), and is expected in wide format. If two dataframes are given
then one should contain phenotypes and the other should contain watering
data. The <code>pheno</code>, <code>time</code>, and <code>id</code>
arguments control which variables are used to normalize for plant size
(<code>pheno</code>), subset the data to a given time
(<code>time</code>) and to identify a plant over time (<code>id</code>).
The <code>offset</code> argument optionally controls how long before a
phenotype’s measurement water has to have been added to count towards
that phenotype, normally this is left 0. <code>pre_watering</code> and
<code>post_watering</code> should name columns of the dataframe
containing water data corresponding to pre-watering weight and
post-watering weight. Finally, the <code>method</code> argument controls
which values are calculated. Currently it accepts “rate”, “abs”, and
“ndt” for the rate based pWUE, absolute value pWUE, and Normalized Daily
Transpiration.</p>
<p>Note that here we are using very coarse measurements of time and for
some experiments more granular time data is essential.</p>
<div class="section level3">
<h3 id="rate-based">Rate Based<a class="anchor" aria-label="anchor" href="#rate-based"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pwue.html">pwue</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">ex</span>, w <span class="op">=</span> <span class="cn">NULL</span>, pheno <span class="op">=</span> <span class="st">"area"</span>, time <span class="op">=</span> <span class="st">"time"</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"group"</span><span class="op">)</span>,</span>
<span>  pre_watering <span class="op">=</span> <span class="st">"weight_before"</span>,</span>
<span>  post_watering <span class="op">=</span> <span class="st">"weight_after"</span>, method <span class="op">=</span> <span class="st">"rate"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We’ll look at an example replicate of each group to get started.
Using the grid faceting we can’t free the scales, so we’ll go over each
watering condition in turn.</p>
<div class="section level4">
<h4 id="constant-watering">Constant Watering<a class="anchor" aria-label="anchor" href="#constant-watering"></a>
</h4>
<ul>
<li>
<code>constant</code>: Pre-watering weight increases with the
phenotype (area), and a constant, specific amount of water is added to
that pre-watered weight. Field capacity is not considered.</li>
</ul>
<p>Remember that the rate-based pWUE formula we are using is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>Δ</mi><msub><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">Biomass</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msub></mrow><msub><mtext mathvariant="normal">Water Transpired</mtext><mi>t</mi></msub></mfrac><annotation encoding="application/x-tex">\frac{\Delta(\text{Biomass})_t}{\text{Water Transpired}_t}</annotation></semantics></math>.
In this watering condition the denominator is a constant. Since the
numerator is the measurement-to-measurement change it is essentially the
derivative (slope) of the original phenotype.</p>
<p>With that in mind we can start thinking about what we’d expect to
see. As an example, the <code>death</code> group is always going to have
small values for pWUE compared to other groups since the change in size
between any two measurements is always very small. If we zoom in then
there should be a downward trend driven by the phenotype increasing by
smaller and smaller amounts towards an asymptotic limit.
<code>death</code> shows slow monomolecular growth with a low asymptote
when compared to our other groups. Similarly, the <code>sigmoid</code>
group should start to look like a bell curve, since the derivative of a
sigmoid is bell shaped (the CDF of a normal distribution is a logistic
curve, etc).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbc</span> <span class="op">&lt;-</span> <span class="va">rb</span><span class="op">[</span><span class="va">rb</span><span class="op">$</span><span class="va">wc</span> <span class="op">==</span> <span class="st">"constant"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pc</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Zooming in on the constant watering condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>This follow the general trends we’d expect, but some things look
strange and it all looks very noisy.</p>
<div class="section level5">
<h5 id="sigmoid">Sigmoid<a class="anchor" aria-label="anchor" href="#sigmoid"></a>
</h5>
<p>As mentioned above, we expect a roughly bell shaped plot of rate pWUE
over time for our data with constant watering and logistic growth.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"sigmoid"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Constant Watering with Logistic Growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"(Rate based) pWUE"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>The overall trend makes sense, but why is the data so spikey? We can
sometimes get an easier grasp of pWUE if we plot the component parts,
which are both returned from <code>pwue</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"sigmoid"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Components of Rate pWUE"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"constant watering, logistic growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span>
<span><span class="co">## Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Now we can see that the “spikey-ness” is a product of the water data
having a lot of noise, which is likely to be the case in real data but
for our simulation is just a byproduct of how we’re making the
pre-watering weights.</p>
</div>
<div class="section level5">
<h5 id="abrupt">Abrupt<a class="anchor" aria-label="anchor" href="#abrupt"></a>
</h5>
<p>The typical sigmoid data was pretty simple, but what happens if we
have a different kind of sigmoid shape? First looks at the pWUE for our
“abrupt” logistic growth are way less friendly.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"abrupt"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Constant Watering with Abrupt Growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"(Rate based) pWUE"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>We’re going to have to zoom in to understand the general trend, then
we can look at each replicate to see what is going on with that large
spike.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"abrupt"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Constant Watering with Abrupt Growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"(Rate based) pWUE"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>That doesn’t clear it up much, but we do basically have the same kind
of shape as before where the logistic phenotype yielded a bell
curve.</p>
<p>The first big problem we see is that pWUE is negative in some cases.
Normally we’d say that if we add a constant amount of water to each
“before” weight that the “after” weight has to be larger, so the
difference must be positive. That is true, but with this phenotype we
have fast enough changes measurement-to-measurement between days 10 to
14 that we see a couple of times where the previous
<code>weight_after_watering</code> is lower than the current
<code>weight_before_watering</code>. In our case this is a product of
the simulation having very simple rules but this sort of discrepancy
comes up a lot with water data since there are so many possible sources
of error and noise. Generally we will remove any negative values for
<code>total_water</code>. pWUE can also be flipped to be negative if the
numerator (change in biomass) becomes negative. In most experiments that
is indicative of a shortcoming of images as a proxy for biomass or an
image analysis problem. It’s a good idea to figure out why you have
negative values since it might indicate an interesting stress response,
a problem with equipment or a problem with upstream analysis. In reality
this sort of thing shows up all the time due to all sorts noise,
measurement error, and image analysis problems.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbcp</span> <span class="op">&lt;-</span> <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"abrupt"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rbcp</span><span class="op">$</span><span class="va">total_water</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">##  -13.07   17.33   24.30   20.83   25.00   38.68      10</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbcp</span> <span class="op">&lt;-</span> <span class="va">rbcp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">rbcp</span><span class="op">$</span><span class="va">total_water</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>Now that we’ve removed the negative values we can think about the
components of rate pWUE a little more clearly.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbcp</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">id</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Components of Rate pWUE"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"constant watering, abrupt growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>Notice that we have dips in the amount of water used that coincide
with the peaks of measurement-to-measurement phenotype change. That’s a
combination that will make for some very high pWUE peaks and plenty of
noise. The peaks in measurement-to-measurement phenotype change have to
happen with such fast changes. The troughs in amount of water used may
be seen on a system where the weight of a pot changes noticeably with
the measured phenotype (the plant is a non-negligible amount of the
total weight of whatever pot/cart is being weighed), but that will
depend on your equipment. This trend is very dramatic, it is likely that
in your experiments the soil and pot would out weigh the plant by
several orders of magnitude which would make for less steep pWUE
curves.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbcp</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">id</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Constant Watering with Abrupt Growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"(Rate based) pWUE"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="exponential">Exponential<a class="anchor" aria-label="anchor" href="#exponential"></a>
</h5>
<p>The previous two phenotype options were asymptotic. What happens with
non-asymptotic growth?</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"exponential"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Constant Watering with Exponential Growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"(Rate based) pWUE"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>As before we’ll remove the negative values for
<code>total_water</code>. Here they come from the same place since the
phenotype is changing so quickly.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbce</span> <span class="op">&lt;-</span> <span class="va">rbc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"exponential"</span> <span class="op">&amp;</span> <span class="va">rbc</span><span class="op">$</span><span class="va">total_water</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbce</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Constant Watering with Exponential Growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"(Rate based) pWUE"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>With the negative values removed the trend here looks a lot like the
raw phenotype data.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">ex</span><span class="op">[</span><span class="va">ex</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"exponential"</span> <span class="op">&amp;</span> <span class="va">ex</span><span class="op">$</span><span class="va">wc</span> <span class="op">==</span> <span class="st">"constant"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">area</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">wc</span> <span class="op">~</span> <span class="va">pc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="st">"Area"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Exponential Phenotype"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    strip.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    strip.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>This is a feature of exponential growth, since the
measurement-to-measurement difference increases exponentially when we
have roughly constant water use the pWUE trend will look
exponential.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbce</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">id</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Components of Rate pWUE"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"constant watering, abrupt growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="slowing">Slowing<a class="anchor" aria-label="anchor" href="#slowing"></a>
</h5>
<p>For non-asymptotic growth that is slowing down (exponent below 1) we
should expect to see decreasing pWUE given constant watering.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"slowing"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Constant Watering with Power law (B&lt;1) Growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"(Rate based) pWUE"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>While the growth is non-asymptotic pWUE is asymptotic since the
numerator is monotone increasing but is slowing down while the
denominator is roughly constant.</p>
</div>
<div class="section level5">
<h5 id="linear">Linear<a class="anchor" aria-label="anchor" href="#linear"></a>
</h5>
<p>The measurement-to-measurement change in linear data is the same
between any two subsequent times. Since the water data is roughly
constant (at least it has a 0 slope) we expect to see flat but noisy
pWUE here.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"linear"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Constant Watering with Linear Growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"(Rate based) pWUE"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="death">Death<a class="anchor" aria-label="anchor" href="#death"></a>
</h5>
<p>Now we can look at the <code>death</code> group, which taken
separately looks like a totally normal growth curve.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"death"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">area</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Area (cm"</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Zooming in on the phenotype data for death"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>The measurement-to-measurement change for any asymptotic phenotype
approaches 0 at the same rate as the phenotype approaches the asymptote.
This measurement-to-measurement change is returned from
<code>pwue</code> as the <code>pheno_diff</code> column, plotted
below.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pheno_diff_ag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">area</span>, <span class="va">pheno_diff</span><span class="op">)</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">group</span>,</span>
<span>  <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"death"</span>, <span class="op">]</span>,</span>
<span>  <span class="va">mean</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbc</span><span class="op">[</span><span class="va">rbc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"death"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">area</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">group</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">pheno_diff_ag</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pheno_diff</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Area (cm"</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Labeling the average pheno_diff ever other day"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
</div>
<div class="section level4">
<h4 id="increasing-continuous">Increasing Continuous<a class="anchor" aria-label="anchor" href="#increasing-continuous"></a>
</h4>
<ul>
<li>
<code>increasing cont.</code>: Pre-watering weight increases with
the phenotype (area), and every day a larger amount of water is added to
that pre-watered weight.</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbic</span> <span class="op">&lt;-</span> <span class="va">rb</span><span class="op">[</span><span class="va">rb</span><span class="op">$</span><span class="va">wc</span> <span class="op">==</span> <span class="st">"increasing cont"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbic</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pc</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Continuously Increasing Watering"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>Luckily, compared to the constant watering we can see that there
aren’t any crazy peaks or negative values here.</p>
<div class="section level5">
<h5 id="sigmoid-1">Sigmoid<a class="anchor" aria-label="anchor" href="#sigmoid-1"></a>
</h5>
<p>If we were only looking at the numerator we would expect a bell
curve. Since the denominator now increases over time (more water being
added to reach the target weight since the plant transpires more each
day as it grows larger), we should see bell curves that starts high,
have a center “lump”, then end low.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbics</span> <span class="op">&lt;-</span> <span class="va">rbic</span><span class="op">[</span><span class="va">rbic</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"sigmoid"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbics</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sigmoid growth and increasing water use"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<p>And that’s exactly what we see. To make the reason more clear we can
plot the numerator and the denominator separately.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbics</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Components of Rate pWUE"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Increasing Water Use, logistic growth"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span>
<span><span class="co">## Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>There are lots of ways to increase watering over the course of an
experiment, it could be constant, related to plant size (target weight
watering tends to do this), or a step function, but they will generally
follow a similar pattern to this example. Those approaches aren’t so
different that when used to make pWUE they change the denominator all
that much. Essentially, for any pWUE trend you see there are several
ways that it could have been generated in terms of the experimental
design or the values put into the ratio (10/5 = 2/1).</p>
</div>
<div class="section level5">
<h5 id="aburpt">Aburpt<a class="anchor" aria-label="anchor" href="#aburpt"></a>
</h5>
<p>Sharper logistic growth should yield a sharper bell curve and since
the phenotype is not changing at the start then reaches asymptotic size
quickly, pWUE should be 0 on either side of the “spike”.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbica</span> <span class="op">&lt;-</span> <span class="va">rbic</span><span class="op">[</span><span class="va">rbic</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"abrupt"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbica</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fast Sigmoid growth and increasing water use"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbica</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Components of Rate pWUE"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Increasing Water Use, abrupt growth"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span>
<span><span class="co">## Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="exponential-1">Exponential<a class="anchor" aria-label="anchor" href="#exponential-1"></a>
</h5>
<p>Here our numerator increases exponentially while our denominator
increases asymptotically. The result we should expect is exponential
growth.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbice</span> <span class="op">&lt;-</span> <span class="va">rbic</span><span class="op">[</span><span class="va">rbic</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"exponential"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbice</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Exponential growth and increasing water use"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<p>And that’s what we get. The increase in measurement-to-measurement
phenotype outpaces the increase in transpiration.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbice</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Components of Rate pWUE"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Increasing Water Use, expoenential growth"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span>
<span><span class="co">## Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="slowing-1">Slowing<a class="anchor" aria-label="anchor" href="#slowing-1"></a>
</h5>
<p>The derivative of our non-asymptotic but slowing in growth rate
phenotype is asymptotic at 0. With our numerator decreasing and the
denominator increasing we should see pWUE start high and approach 0 very
quickly.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbics</span> <span class="op">&lt;-</span> <span class="va">rbic</span><span class="op">[</span><span class="va">rbic</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"slowing"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbics</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Slowing growth and increasing water use"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
<p>And that’s what we get. The increase in measurement-to-measurement
phenotype outpaces the increase in transpiration.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbics</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Components of Rate pWUE"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Increasing Water Use, slowing growth"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span>
<span><span class="co">## Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="linear-1">Linear<a class="anchor" aria-label="anchor" href="#linear-1"></a>
</h5>
<p>Here our numerator is constant and the denominator (transpiration) is
increasing, so we should see pWUE decrease over time, but never getting
to 0.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbicl</span> <span class="op">&lt;-</span> <span class="va">rbic</span><span class="op">[</span><span class="va">rbic</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"linear"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbicl</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Linear growth and increasing water use"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<p>Again we look at the component pieces to check our intuition.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbicl</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Components of Rate pWUE"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Increasing Water Use, linear growth"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span>
<span><span class="co">## Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="death-1">Death<a class="anchor" aria-label="anchor" href="#death-1"></a>
</h5>
<p>Here we should see a very similar trend as we saw with non-asymptotic
growth that is slowing down. Here our growth is asymptotic but the
effect on the numerator should be the same.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbicd</span> <span class="op">&lt;-</span> <span class="va">rbic</span><span class="op">[</span><span class="va">rbic</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"death"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbicd</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Very little growth and increasing water use"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
<p>Again we look at the component pieces to check our intuition.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbicl</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Components of Rate pWUE"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Increasing Water Use, almost no growth"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span>
<span><span class="co">## Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-41-1.png" width="700"></p>
</div>
</div>
<div class="section level4">
<h4 id="decreasing-continuous">Decreasing Continuous<a class="anchor" aria-label="anchor" href="#decreasing-continuous"></a>
</h4>
<ul>
<li>
<code>decreasing cont.</code>: Pre-watering weight increases with
the phenotype (area), and every day a smaller amount of water is added
to that pre-watered weight.</li>
</ul>
<p>Now that we are inverting the trend of the denominator we should see
some real differences.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbdc</span> <span class="op">&lt;-</span> <span class="va">rb</span><span class="op">[</span><span class="va">rb</span><span class="op">$</span><span class="va">wc</span> <span class="op">==</span> <span class="st">"decreasing cont"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbdc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pc</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Continuously Decreasing Watering"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-42-1.png" width="700"></p>
<div class="section level5">
<h5 id="sigmoid-2">Sigmoid<a class="anchor" aria-label="anchor" href="#sigmoid-2"></a>
</h5>
<p>With the continuously decreasing watering scheme we see a roughly
mirrored version of what we saw with the increasing watering. pWUE
starts low, goes through the “bell” shape, then ends higher since the
denominator is at it’s smallest at the end of the experiment when
measurement-to-measurement phenotype change is back to about the same as
it was in the beginning.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbdcs</span> <span class="op">&lt;-</span> <span class="va">rbdc</span><span class="op">[</span><span class="va">rbdc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"sigmoid"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbdcs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Logistic growth and target weight watering"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
<p>We do have one strong spike at the end which we can try to understand
better by looking at each component of pWUE.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbdcs</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">id</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Components of Rate pWUE"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Decreasing watering, logistic growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span>
<span><span class="co">## Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-44-1.png" width="700"></p>
<p>Now we can see the cause for that spike is just that the watering
amount on the last day for the 4th plant was almost nothing.</p>
</div>
<div class="section level5">
<h5 id="abrupt-1">Abrupt<a class="anchor" aria-label="anchor" href="#abrupt-1"></a>
</h5>
<p>The abrupt logistic phenotype looks essentially the same as it has
for other waterings since the numerator is only non-zero in the middle
of the experiment, so any trend in the denominator makes relatively
minor changes to the overall trend. This will be a theme with any growth
curve that gets close to its asymptote.</p>
</div>
<div class="section level5">
<h5 id="exponential-2">Exponential<a class="anchor" aria-label="anchor" href="#exponential-2"></a>
</h5>
<p>Again here we remove negative values, which are caused normally by
measurement error.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbdce</span> <span class="op">&lt;-</span> <span class="va">rbdc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">rbdc</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"exponential"</span> <span class="op">&amp;</span> <span class="va">rbdc</span><span class="op">$</span><span class="va">pWUE</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rbdce</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">id</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Exponential growth and target weight watering"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-45-1.png" width="700"></p>
<p>Once we remove the negative values we see the same basic trend
(stronger this time as the denominator gets smaller as the exponential
growth progresses) as we have been for exponentially increasing
phenotype. It would be hard to design a watering protocol short of
complete drought that would curb the trend for this phenotype.</p>
</div>
<div class="section level5">
<h5 id="slowing-2">Slowing<a class="anchor" aria-label="anchor" href="#slowing-2"></a>
</h5>
<p>The <code>slowing</code>, <code>linear</code>, and <code>death</code>
groups all show similar trends to each other. Since the numerators here
are constant or slightly decreasing (the change in slope) the
denominator can push the pWUE trend dramatically.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">rbdc</span><span class="op">[</span><span class="va">rbdc</span><span class="op">$</span><span class="va">pc</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"slowing"</span>, <span class="st">"linear"</span>, <span class="st">"death"</span><span class="op">)</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_diff</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"The differences in phenotype trend are overpowered"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Decreasing watering, any slow growth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span>
<span><span class="co">## Removed 10 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-46-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="absolute-value-based">Absolute Value Based<a class="anchor" aria-label="anchor" href="#absolute-value-based"></a>
</h3>
<p>Since we went through all the possible combinations with the rate
based pWUE we will move faster through the absolute value based version
of pWUE once we establish the difference in the pWUE formula.</p>
<p>As a reminder, this definition of pWUE means we are considering the
absolute size of the plant at each timepoint with the formula now
being:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><msub><mtext mathvariant="normal">Biomass</mtext><mi>t</mi></msub><msub><mtext mathvariant="normal">Water Transpired</mtext><mi>t</mi></msub></mfrac><annotation encoding="application/x-tex">\frac{\text{Biomass}_t}{\text{Water Transpired}_t}</annotation></semantics></math></p>
<p>This type of pWUE is useful for thinking about how much biomass can
be maintained per unit of water.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pwue.html">pwue</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">ex</span>, w <span class="op">=</span> <span class="cn">NULL</span>, pheno <span class="op">=</span> <span class="st">"area"</span>, time <span class="op">=</span> <span class="st">"time"</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"group"</span><span class="op">)</span>,</span>
<span>  pre_watering <span class="op">=</span> <span class="st">"weight_before"</span>,</span>
<span>  post_watering <span class="op">=</span> <span class="st">"weight_after"</span>, method <span class="op">=</span> <span class="st">"abs"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The numerator here is the same as before, so we can check for some
problems we already know about.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">group</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">pWUE</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="st">"negative"</span>, <span class="st">"positive"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## negative positive </span></span>
<span><span class="co">##       18     4302</span></span></code></pre>
<p>This time we’ll plot it with the scales freed on the Y-axis and with
values below 0 already removed.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">apos</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">pWUE</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">apos</span><span class="op">[</span><span class="va">apos</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"id_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">wc</span> <span class="op">~</span> <span class="va">pc</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    strip.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-49-1.png" width="700"></p>
<p>Here our pWUE data look a lot like the original phenotype data, with
the exception of which we’ll get to. That general similarity is because
the phenotype data are used as-is in the numerator, and for the most
part we don’t have drastic changes to the water transpiration (weight
changes) over time.</p>
<p>Everything except for the <code>abrupt</code> logistic phenotype
basically just looks like the phenotype it represents.</p>
<p>The <code>abrupt</code> group looks strange here though, what is
going on there?</p>
<div class="section level4">
<h4 id="abrupt-logistic-growth">Abrupt Logistic Growth<a class="anchor" aria-label="anchor" href="#abrupt-logistic-growth"></a>
</h4>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">apos</span><span class="op">[</span><span class="va">apos</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"abrupt"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">wc</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Why doesn't this look more like the raw phenotype?"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Abs pWUE"</span>, x <span class="op">=</span> <span class="st">"Time"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    strip.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">apos</span><span class="op">[</span><span class="va">apos</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"abrupt"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">wc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">total_water</span>, color <span class="op">=</span> <span class="st">"Water (denominator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pheno_iter</span>, color <span class="op">=</span> <span class="st">"Phenotype (numerator)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"This view kind of helps, but it still doesn't explain our trend clearly"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Pheno Diff and Water Diff"</span>, x <span class="op">=</span> <span class="st">"Time"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-51-1.png" width="700"></p>
<p>What is happening here is that since our phenotype changes so quickly
between measurements 10 and 14 (roughly) the “lag” where we look at the
difference in weights becomes very important. Looking at the pre/post
watering weights for the first 3 plants in each watering condition given
<code>abrupt</code> logistic growth the problem is more obvious.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l2</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">ex</span><span class="op">[</span><span class="va">ex</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"abrupt"</span>, <span class="op">]</span>,</span>
<span>  id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"group"</span>, <span class="st">"time"</span>, <span class="st">"wc"</span><span class="op">)</span>,</span>
<span>  measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weight_before"</span>, <span class="st">"weight_after"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">l2</span><span class="op">[</span><span class="va">l2</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"id_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"weight_before"</span>, <span class="op">-</span><span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">variable</span>, group <span class="op">=</span> <span class="va">id</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">id</span> <span class="op">~</span> <span class="va">wc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="st">"Weight"</span>, x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Sharp phenotype changes drive small denominators"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    strip.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    strip.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-52-1.png" width="700"></p>
<p>Between days 10 and 14 the line between those weights is much
shorter. In this data the difference is smaller because it’s a
relatively low effort simulation. In the wild we can see trends like
this when an <em>image based phenotype changes more rapidly than the
underlying “true quantity”</em>. To keep with our area example, if a
plant’s leaf presentation in 2 dimensions changes in a way that is
different than how its biomass actually changes then we can see this.
These sort of differences highlight why we say we are using
<em>Pseudo-WUE</em>. A similar idea could be that when corn is
heat-stressed and the leaves furl into a more helical shape when viewed
in 2D we don’t really think the corn plant lost biomass, it just
rearranged itself in a way that an image has fewer plant pixels.</p>
<p>If we zoom in on our pWUE trends we can tell that despite being very
noisy in the middle of the experiment from the discrepancy between area
and a proxy for biomass and true biomass (rapid artificial weight gain
in excess of the watering amount) the overall trend does look like our
phenotype.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">apos</span><span class="op">[</span><span class="va">apos</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"abrupt"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pWUE</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">wc</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Why doesn't this look more like the raw phenotype?"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Abs pWUE"</span>, x <span class="op">=</span> <span class="st">"Time"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    strip.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-53-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="normalized-daily-transpiration">Normalized Daily Transpiration<a class="anchor" aria-label="anchor" href="#normalized-daily-transpiration"></a>
</h3>
<p>The last of the phenotypes calculated by <code>pwue</code> is
normalized daily transpiration (NDT). Normalized transpiration is the
reciprocal of the “abs” style pWUE that we just looked at, so it answers
a related question. NDT is helpful when we want to investigate how much
water is used (transpired) by a given amount of biomass.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ndt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pwue.html">pwue</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">ex</span>, w <span class="op">=</span> <span class="cn">NULL</span>, pheno <span class="op">=</span> <span class="st">"area"</span>, time <span class="op">=</span> <span class="st">"time"</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"group"</span><span class="op">)</span>,</span>
<span>  pre_watering <span class="op">=</span> <span class="st">"weight_before"</span>,</span>
<span>  post_watering <span class="op">=</span> <span class="st">"weight_after"</span>, method <span class="op">=</span> <span class="st">"ndt"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ndt</span> <span class="op">&lt;-</span> <span class="va">ndt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ndt</span><span class="op">$</span><span class="va">pWUE</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>Once again the <code>abrupt</code> group misbehaves relative to the
other options. Suffice to say, most of the time this looks like an
obvious reciprocal of the previous pWUE implementation. In our simulated
data we see that when plants are smaller but apparently using the same
amount of water (see top row with constant watering) NDT is high. This
is most obvious in the exponential phenotype. Remember that how well you
will be able to use NDT (any any water use phenotype) will depend
entirely on how accurately you can measure transpiration.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">ndt</span><span class="op">[</span><span class="va">ndt</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"id_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">ndt</span><span class="op">$</span><span class="va">pc</span> <span class="op">!=</span> <span class="st">"abrupt"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">normalized_daily_transpiration</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">wc</span> <span class="op">~</span> <span class="va">pc</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    strip.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-55-1.png" width="700"></p>
<p>The <code>abrupt</code> phenotype has much higher values for
transpiration since we are dividing by close to 0 for a long time (in
the beginning of the experiment these plants are barely detectable).
This will be another caveat in real data, if there are some plants that
fail to thrive then you can end up with dramatic outliers in water use
phenotypes.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">ndt</span><span class="op">[</span><span class="va">ndt</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"id_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">ndt</span><span class="op">$</span><span class="va">pc</span> <span class="op">==</span> <span class="st">"abrupt"</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">normalized_daily_transpiration</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">wc</span> <span class="op">~</span> <span class="va">pc</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    strip.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="field_capacity_files/figure-html/unnamed-chunk-56-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>Hopefully this helps in working with whatever kind of water usage
phenotype your experiment requires. These phenotypes are often very
noisy and difficult to measure, so looking at the component pieces
separately for any WUE or pWUE type phenotype you collect will be
helpful. You may also take extra care in looking for outliers if water
use metrics are a core part of your analysis. Additionally, some popular
systems have an unfortunate tendency to return negative masses for
plants. That will obviously be a problem, so having some ground truth
data near the middle and end of the experiment can be helpful. Whatever
setup you use, try to understand each component of your calculated water
use metrics before interpreting them.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Josh Sumner <br> Developed in DDPSC Datascience Core Facility <br> Logo design by <a href="https://twitter.com/Kerri_Gilbert" class="external-link">Kerri Gilbert</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
