<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Longitudinal Growth Modeling Options • pcvr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Longitudinal Growth Modeling Options">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/bellwether.html">Bellwether</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal.html">Longitudinal Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/roots.html">Root Phenotyping</a></li>
    <li><a class="dropdown-item" href="../articles/directional.html">Directional Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_conjugate.html">Conjugate Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_igm.html">Intermediate Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_agm.html">Advanced Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_mvt.html">Multi-Value Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/field_capacity.html">Water Derived Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/reading_pcv_data.html">Using online PlantCV Output</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quarto-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quarto Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials">
<li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/crop_reporter/tutorials/pcvrTutorial_multiValueTraits">Multi-Value Traits</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV"><span class="fa fa-leaf"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Longitudinal Growth Modeling Options</h1>
            <h3 data-toc-skip class="subtitle">pcvr v0.1.0</h3>
                        <h4 data-toc-skip class="author">Josh Sumner,
DDPSC Data Science Core Facility</h4>
            
            <h4 data-toc-skip class="date">2023-10-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/main/vignettes/longitudinal.Rmd" class="external-link"><code>vignettes/longitudinal.Rmd</code></a></small>
      <div class="d-none name"><code>longitudinal.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danforthcenter/pcvr" class="external-link">pcvr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span> <span class="co"># for fread</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co"># for easy ggplot manipulation/combination</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="why-longitudinal-modeling">Why Longitudinal Modeling?<a class="anchor" aria-label="anchor" href="#why-longitudinal-modeling"></a>
</h2>
<p>Longitudinal modeling allows users to take full advantage of accurate
and non-destructive data collection possible through high throughput
image based phenotyping. Using longitudinal data accurately requires
some understanding of the statistical challenges associated with it.
Statistical complications including changes in variance
(heteroskedasticity), non-linearity, and autocorrelation (plant’s day to
day self similarity) present potential problems in analyses. To address
this kind of data several functions are provided to make fitting
appropriate growth models more straightforward.</p>
</div>
<div class="section level2">
<h2 id="installation-for-advanced-models">Installation for Advanced Models<a class="anchor" aria-label="anchor" href="#installation-for-advanced-models"></a>
</h2>
<p>The <code>brms</code> package is not automatically imported by
<code>pcvr</code>, so before fitting <code>brms</code> models we need to
load that package. For details on installing <a href="https://github.com/paul-buerkner/brms" class="external-link"><code>brms</code></a> and
either <a href="https://mc-stan.org/rstan/" class="external-link"><code>rstan</code></a> or <a href="https://mc-stan.org/cmdstanr/" class="external-link"><code>cmdstanr</code></a> (with
<code>cmdstanr</code> being recommended), see the linked documentation.
Note that if you install <code>pcvr</code> from github with
<code>dependencies=T</code> then <code>cmdstanr</code> and
<code>brms</code> will be installed.</p>
<p>Once <code>cmdstanr</code> is installed we also need to set the
cmdstan path and link cmdstan to R, which is all done easily by
<code>cmdstanr</code>. For example, packages can be installed and
prepped using this code.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"cmdstanr"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"cmdstanr"</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://mc-stan.org/r-packages/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"brms"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"brms"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/cmdstanr/" class="external-link">cmdstanr</a></span><span class="op">)</span></span>
<span><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/install_cmdstan.html" class="external-link">install_cmdstan</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="available-growth-models">Available Growth Models<a class="anchor" aria-label="anchor" href="#available-growth-models"></a>
</h2>
<p>Based on literature and experience there are six common plant growth
models that make up the “main” models in <code>growthSS</code>, although
13 are supported. Those main six growth models are supported in
<code>pcvr</code> across each of four available backend functions
(<code>nls</code>, <code>nlrq</code>, <code>nlme</code>, and
<code>brms</code>). The <code>mgcv</code> backend can also be used to
fit generalized additive models (GAMS) to any of these growth curves as
well. In addition to these six main models GAMs, double logistic, and
double gompertz models are supported across the four available parameter
based backends. The parameterizations of these models are explained
below.</p>
<div class="section level3">
<h3 id="logistic">Logistic<a class="anchor" aria-label="anchor" href="#logistic"></a>
</h3>
<p>The logistic function here is implemented as a 3 parameter sigmoidal
growth curve:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo>−</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>C</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">A / (1 + e^{(B-x)/C} )</annotation></semantics></math></p>
<p>In this model A is the asymptote, B is the inflection point, and C is
the growth rate.</p>
</div>
<div class="section level3">
<h3 id="gompertz">Gompertz<a class="anchor" aria-label="anchor" href="#gompertz"></a>
</h3>
<p>The gompertz function here is also a 3 parameter sigmoidal growth
curve:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>*</mo><msup><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>B</mi><mo>*</mo><msup><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>C</mi><mo>*</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">A * e^{(-B * e^{(-C*x)})}</annotation></semantics></math></p>
<p>In this model A is the asymptote, B is the inflection point, and C is
the growth rate.</p>
<p>The gompertz formula is more complex than the logistic formula, which
tends to make the model slightly harder to fit in terms of time and
computation. The benefit to that extra effort is that the gompertz curve
is more flexible than the logistic curve and does not have to stop
growing at the same rate as it initially started growing. In the
author’s experience gompertz growth models have provided the best fit to
sigmoidal data, but sometimes the speed and familiarity of the logistic
function may be compelling.</p>
</div>
<div class="section level3">
<h3 id="monomolecular">Monomolecular<a class="anchor" aria-label="anchor" href="#monomolecular"></a>
</h3>
<p>The monomolecular function here is a 2 parameter asymptotic growth
curve:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>−</mo><mi>A</mi><mo>*</mo><msup><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>B</mi><mo>*</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">A-A * e^{(-B * x)}</annotation></semantics></math></p>
<p>Once again, A is the asymptote but now B is the growth rate.</p>
<p>This model has often fit well for height or width phenotypes, but you
should make model choices based on your data/expectations.</p>
</div>
<div class="section level3">
<h3 id="exponential">Exponential<a class="anchor" aria-label="anchor" href="#exponential"></a>
</h3>
<p>The exponential function here is a 2 parameter non-asymptotic growth
curve bearing strong similarity to the monomolecular formula:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>*</mo><msup><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo>*</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">A * e^{(B * x)}</annotation></semantics></math></p>
<p>Here A is a scale parameter and B is the growth rate.</p>
<p>Most plants do not grow indefinitely, although many may grow
exponentially through the course of an experiment (think of the first
half of a logistic or gompertz curve). In those cases you may wish to
use an exponential model or if you are using the <code>brms</code>
backend then you may wish to rely on some prior information about an
asymptote that would eventually be achieved to use a sigmoidal
model.</p>
</div>
<div class="section level3">
<h3 id="power-law">Power Law<a class="anchor" aria-label="anchor" href="#power-law"></a>
</h3>
<p>The power law function here is a 2 parameter non-asymptotic growth
curve:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>*</mo><msup><mi>x</mi><mi>B</mi></msup></mrow><annotation encoding="application/x-tex">A * x^B</annotation></semantics></math></p>
<p>Here A is a scale parameter and B is the growth rate. The formula
becomes linear when B is 1, shows slowing growth over time when 0 &lt; B
&lt; 1 and shows growth speed increasing over time (the exponential)
when B &gt; 1.</p>
<p>These models can allow for slowing growth over time but without the
expectation that growth ever truly stops.</p>
</div>
<div class="section level3">
<h3 id="linear">Linear<a class="anchor" aria-label="anchor" href="#linear"></a>
</h3>
<p>The linear function here is simply:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>*</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">A * x</annotation></semantics></math></p>
<p>Here A is the growth rate and the intercept is assumed to be 0.</p>
</div>
<div class="section level3">
<h3 id="double-logistic">Double Logistic<a class="anchor" aria-label="anchor" href="#double-logistic"></a>
</h3>
<p>The double logistic function here is just two combined logistic
functions:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo>−</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mn>2</mn><mo>−</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mn>2</mn><mo>−</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>C</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">A / (1+e^{((B-x)/C)}) + ((A2-A) /(1+e^{((B2-x)/C2)}))</annotation></semantics></math></p>
<p>Here the parameters have the same interpretation as those in the
logistic curve, but for the first and second component separately.</p>
<p>This is intended for use with recover experiments, not for any data
with very minor hiccups in the overall trend. Additionally, with the
<code>brms</code> backend the segmented models allow for a more flexible
implementation as <code>logistic+logistic</code>, although in that
implementation the values for A and B are not relative.</p>
</div>
<div class="section level3">
<h3 id="double-gompertz">Double Gompertz<a class="anchor" aria-label="anchor" href="#double-gompertz"></a>
</h3>
<p>The double logistic function here is just two combined gompertz
functions:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>*</mo><msup><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>B</mi><mo>*</mo><msup><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>C</mi><mo>*</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mn>2</mn><mo>−</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><msup><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>B</mi><mn>2</mn><mo>*</mo><msup><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>C</mi><mn>2</mn><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">A * e^{(-B * e^{(-C*x)})} + ((A2-A) * e^{(-B2 * e^{(-C2*(x-B))})})</annotation></semantics></math></p>
<p>Here the parameters have the same interpretation as those in the
gompertz curve, but for the first and second component separately.</p>
<p>All the same points as with the double logistic curve apply here as
well.</p>
</div>
<div class="section level3">
<h3 id="weibull">Weibull<a class="anchor" aria-label="anchor" href="#weibull"></a>
</h3>
<p>The weibull growth curve is derived from the generalized extreme
value distribution and is comparable to the gompertz growth model
option, but may be slightly easier to fit/faster moving in some
cases.</p>
</div>
<div class="section level3">
<h3 id="gumbel">Gumbel<a class="anchor" aria-label="anchor" href="#gumbel"></a>
</h3>
<p>The gumbel growth curve is also derived from the generalized EVD and
would be used in similar contexts as the weibull or gompertz model
options. The choice of which to use is left to individual users and the
conventions of your field.</p>
</div>
<div class="section level3">
<h3 id="frechet">Frechet<a class="anchor" aria-label="anchor" href="#frechet"></a>
</h3>
<p>This is the final option derived from the generalized EVD. Note that
here a 3 parameter version is used with the location (m) set to 0 by
default.</p>
</div>
<div class="section level3">
<h3 id="bragg">Bragg<a class="anchor" aria-label="anchor" href="#bragg"></a>
</h3>
<p>The Bragg model is a dose-response curve that models the minima and
maxima using 3 parameters.</p>
</div>
<div class="section level3">
<h3 id="lorentz">Lorentz<a class="anchor" aria-label="anchor" href="#lorentz"></a>
</h3>
<p>The Lorentz model is a dose-response curve that models the minima and
maxima using 3 parameters. This parameterization may has a slightly more
intuitive formula than Bragg for some people but has worse statistical
qualities.</p>
</div>
<div class="section level3">
<h3 id="beta">Beta<a class="anchor" aria-label="anchor" href="#beta"></a>
</h3>
<p>The Beta model is based on the PDF of the beta distribution and
models minima/maxima as a dose-response curve using 5 parameters. This
can be a difficult model to fit but can describe non-symmetric
dose-response relationships well.</p>
</div>
<div class="section level3">
<h3 id="gam">GAM<a class="anchor" aria-label="anchor" href="#gam"></a>
</h3>
<p>Finally, all backends can fit GAMs. These are unparameterized
functions that use a series of splines to fit a variety of trends.</p>
<p>In general these are less useful since they do not give directly
interpretable parameters, but their flexibility can be valuable if your
data does not fit some more standard model well.</p>
</div>
<div class="section level3">
<h3 id="simulating-data">Simulating data<a class="anchor" aria-label="anchor" href="#simulating-data"></a>
</h3>
<p>Data from any parameterized model can be simulated using
<code>growthSim</code>. Through this vignette we will use data created
in this way to show modeling options.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"logistic"</span>, n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">160</span><span class="op">)</span>,</span>
<span>  <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>  <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3.5</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Logistic"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"gompertz"</span>, n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">160</span><span class="op">)</span>,</span>
<span>  <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>  <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Gompertz"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"monomolecular"</span>, n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">160</span><span class="op">)</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.08</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Monomolecular"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"exponential"</span>, n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.095</span>, <span class="fl">0.095</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Exponential"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"linear"</span>, n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ln</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Linear"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"power law"</span>, n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">11</span><span class="op">)</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Power Law"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">patch</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">l</span> <span class="op">+</span> <span class="va">g</span> <span class="op">+</span> <span class="va">m</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">e</span> <span class="op">+</span> <span class="va">ln</span> <span class="op">+</span> <span class="va">pl</span><span class="op">)</span></span>
<span><span class="va">patch</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="available-model-backends">Available Model Backends<a class="anchor" aria-label="anchor" href="#available-model-backends"></a>
</h2>
<p>As previously mentioned there are five backends supported in
<code>pcvr</code>. Here we will go over those backends in more detail.
These backends are selected using one of nls, nlrq, nlme, mgcv, or brms
which correspond to the functions shown in this table.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="19%">
<col width="24%">
<col width="19%">
<col width="17%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th>“nls”</th>
<th>“nlrq”</th>
<th>“nlme”</th>
<th>“mgcv”</th>
<th>“brms”</th>
</tr></thead>
<tbody><tr class="odd">
<td><code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls</a></code></td>
<td><code><a href="https://rdrr.io/pkg/quantreg/man/nlrq.html" class="external-link">quantreg::nlrq</a></code></td>
<td><code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme::nlme</a></code></td>
<td><code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam</a></code></td>
<td><code><a href="https://paulbuerkner.com/brms/reference/brms-package.html" class="external-link">brms::brms</a></code></td>
</tr></tbody>
</table>
<div class="section level3">
<h3 id="nls">
<code>nls</code><a class="anchor" aria-label="anchor" href="#nls"></a>
</h3>
<p>The <code>nls</code> backend is the simplest option. These models
account for non-linearity using any of the aforementioned model types
and fit very quickly but do not have ways to take autocorrelation or
heteroskedasticity into account.</p>
</div>
<div class="section level3">
<h3 id="nlrq">
<code>nlrq</code><a class="anchor" aria-label="anchor" href="#nlrq"></a>
</h3>
<p>The <code>nlrq</code> backend fits non-linear quantile models to
specified quantiles of the data. These models account for non-linearity
and account for heteroskedasticity in a non-parametric quantile based
way (fitting 2.5% and 97.5% models will provide something like a 95%
confidence interval that changes width across time as the data
does).</p>
</div>
<div class="section level3">
<h3 id="nlme">
<code>nlme</code><a class="anchor" aria-label="anchor" href="#nlme"></a>
</h3>
<p>The <code>nlme</code> backend fits non-linear mixed effect models.
These models account for non-linearity, autocorrelation, and to have
options to model the heteroskedasticity.</p>
</div>
<div class="section level3">
<h3 id="mgcv">
<code>mgcv</code><a class="anchor" aria-label="anchor" href="#mgcv"></a>
</h3>
<p>The <code>mgcv</code> backend only fits GAMs, which do account for
non-linearity but do not account for heteroskedasticity and
autocorrelation and do not return interpretable parameters.</p>
</div>
<div class="section level3">
<h3 id="brms">
<code>brms</code><a class="anchor" aria-label="anchor" href="#brms"></a>
</h3>
<p>The <code>brms</code> backend fits hierarchical Bayesian models that
account for non-linearity, autocorrelation and heteroskedasticity. These
models are more flexible than any of the other options and are the focus
of the <a href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling" class="external-link">Advanced
Growth Modeling Tutorial</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="making-models-in-pcvr">Making models in <code>pcvr</code><a class="anchor" aria-label="anchor" href="#making-models-in-pcvr"></a>
</h2>
<p>At a high level the relevant functions in <code>pcvr</code> are
<code>growthSS</code>, <code>fitGrowth</code>, <code>growthPlot</code>,
and <code>testGrowth</code>.</p>
<ul>
<li><p><code>growthSS</code> specifies self starting growth models and
returns a list that is used by <code>fitGrowth</code></p></li>
<li><p><code>fitGrowth</code> fits a growth model specified by
<code>growthSS</code> and returns a model or a list of model
options.</p></li>
<li><p><code>growthPlot</code> visualizes the model fit. This is
particularly helpful with <code>brms</code> models to check their
heteroskedastic sub models.</p></li>
<li><p><code>testGrowth</code> tests model parameters against nested
versions of the same models to allow for straightforward hypothesis
testing on frequentist (non-<code>brms</code>) models. For
<code>brms</code> models the <code><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">brms::hypothesis</a></code> function
should be used.</p></li>
</ul>
<div class="section level3">
<h3 id="using-growthss">Using <code>growthSS</code><a class="anchor" aria-label="anchor" href="#using-growthss"></a>
</h3>
<p><code>growthSS</code> is the first <code>pcvr</code> helper function
for setting up longitudinal models. <code>growthSS</code> will return a
list of elements used to fit a longitudinal model including a formula,
starting values (or priors for <code>brms</code> values), data to use,
and several elements used internally in other functions.</p>
<p><code>growthSS</code> takes five arguments which specify the model to
use, a simplified formula specifying the columns of your data to use, a
sigma option, the data to use, and starting values/priors. The model and
data to use are relatively straightforward, compare a plot of your data
against the general shapes of the model parameterizations shown above to
pick a model type and pass your dataframe to the <code>df</code>
argument. The remaining arguments are explained below.</p>
<div class="section level4">
<h4 id="growthss----form----">
<code>growthSS(..., form, ...)</code><a class="anchor" aria-label="anchor" href="#growthss----form----"></a>
</h4>
<p>The <code>form</code> argument of <code>growthSS</code> needs to
specify the outcome variable, the time variable, an identifier for
individuals, and the grouping structure. These are passed as a formula
object, using similar syntax to <code>lme4</code> and <code>brms</code>,
such as <code>outcome ~ time|individual_id/group_id</code>. Verbally
this would be read as “outcome modeled by time accounting for
correlation between individual_id’s with fixed effects specified per
each group_id”. Note that this formula will not have to change for
different growth models, this is only to specify the structure of your
data. This simplification requires each of these parts of the formula
must be a single column in your dataframe. Note that for each group in
your data a set of parameters will be estimated. If you have lots of
groups in your data then it may make sense to fit models to only a few
groups at a time. If you do that then the models can still be compared
by extracting the MCMC draws, combining them into a dataframe, then
using <code><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">brms::hypothesis</a></code> per normal.</p>
<p>For model backends that do not account for autocorrelation the
individual will not be used and can be omitted leaving
<code>outcome ~ time|group_id</code>, but there is no harm in including
the <code>individual_id</code> component.</p>
</div>
<div class="section level4">
<h4 id="growthss----sigma----">
<code>growthSS(..., sigma, ...)</code><a class="anchor" aria-label="anchor" href="#growthss----sigma----"></a>
</h4>
<p>The <code>sigma</code> argument controls distributional sub models.
This is only used with <code>nlme</code> and <code>brms</code> backends
which support different options.</p>
<p>In <code>nlme</code> models this models sigma and can be “int”,
“power”, or “exp” which correspond to using <code><a href="https://rdrr.io/pkg/nlme/man/varIdent.html" class="external-link">nlme::varIdent</a></code>
(constant variance within groups), <code><a href="https://rdrr.io/pkg/nlme/man/varPower.html" class="external-link">nlme::varPower</a></code> (variance
changing by a power function), <code><a href="https://rdrr.io/pkg/nlme/man/varExp.html" class="external-link">nlme::varExp</a></code> (variance
changing by an exponential function).</p>
<p>In <code>brms</code> models this can be specified in the same way as
the general growth model and can be used to model any distributional
parameter in the model family you use. The default model family is
Student T, which has sigma and nu parameters. Other distributions can be
specified in the main growth model as
<code>model = "family_name: model_name"</code>
(<code>model = "poisson: linear"</code> as an example). For details on
available families see <code><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">?brms::brmsfamily</a></code>. There is also an
“int” model type which fits a 0 slope intercept only model. While “int”
can be used in any <code>brms</code> model the option is meant to be
used specifying a homoskedastic sub model, or a period of noise before
the main growth trend begins (in terms of growth or variance).
Distributional parameters that are not specified will be modeled as
constant between groups.</p>
<p>At a high level we can think about any of these models as fitting a
curve to these lines.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">345</span><span class="op">)</span></span>
<span><span class="va">gomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"gompertz"</span>, n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">35</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">180</span>, <span class="fl">160</span><span class="op">)</span>,</span>
<span>  <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">22</span>, <span class="fl">18</span><span class="op">)</span>,</span>
<span>  <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">sigma_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">gomp</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, title <span class="op">=</span> <span class="st">"Gompertz Sigma"</span><span class="op">)</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Several options are shown here, ignoring grouping here since the data
is already aggregated.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draw_gomp_sigma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">23</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">21</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.22</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"gray60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">12</span>, color <span class="op">=</span> <span class="st">"Homoskedastic"</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    key_glyph <span class="op">=</span> <span class="va">draw_key_path</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">0.8</span>, intercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"Linear"</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    key_glyph <span class="op">=</span> <span class="va">draw_key_path</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"gam"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Spline"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span>, se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    key_glyph <span class="op">=</span> <span class="va">draw_key_path</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_gomp_sigma</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Gompertz"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, begin <span class="op">=</span> <span class="fl">0.1</span>, end <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, title <span class="op">=</span> <span class="st">"Gompertz Sigma"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>“int” will specify a homoskedastic model, that is one with constant
variance over time per each group. While this is the default for almost
every kind of statistical modeling it is an unrealistic assumption in
this setting where we often follow growth from small seedlings to
potentially fully grown plants. Even if we start with larger plants the
homoskedastic assumption almost never holds in longitudinal modeling. We
can fit an example model and see the issue with the homoskedastic
assumption through the model’s credible intervals, which are far too
wide at the beginning of the experiment and even include some negative
values for plant area.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"gompertz"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"int"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">gomp</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">15</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span></span></code></pre></div>
<pre><code><span><span class="co">## gompertz brms student model:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## pcvr formula variables:</span></span>
<span><span class="co">## Outcome: y</span></span>
<span><span class="co">## X: time</span></span>
<span><span class="co">## Individual: id</span></span>
<span><span class="co">## Group: group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model Formula:</span></span>
<span><span class="co">## y ~ A * exp(-B * exp(-C * time)) </span></span>
<span><span class="co">## autocor ~ tructure(list(), class = "formula", .Environment = &lt;environment&gt;)</span></span>
<span><span class="co">## sigma ~ 0 + group</span></span>
<span><span class="co">## nu ~ 1</span></span>
<span><span class="co">## A ~ 0 + group</span></span>
<span><span class="co">## B ~ 0 + group</span></span>
<span><span class="co">## C ~ 0 + group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##     id group time            y</span></span>
<span><span class="co">## 1 id_1     a    1 9.650345e-06</span></span>
<span><span class="co">## 2 id_1     a    2 9.639086e-05</span></span>
<span><span class="co">## 3 id_1     a    3 7.020911e-04</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## (2100 rows)</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, iter <span class="op">=</span> <span class="fl">1000</span>, cores <span class="op">=</span> <span class="fl">4</span>, chains <span class="op">=</span> <span class="fl">4</span>, silent <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/brmPlot.html">brmPlot</a></span><span class="op">(</span><span class="va">fit_h</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p>We can relax this assumption and model sigma separately from the main
growth trend. To show an example of the options in <code>pcvr</code>,
here we repeat the example from above using a linear submodel. Note that
here we add some extra controls to the model fitting algorithm to help
the model fit well with the added complexity at the cost of being
slower.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"gompertz"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">gomp</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">15</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span></span></code></pre></div>
<pre><code><span><span class="co">## gompertz brms student model:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## pcvr formula variables:</span></span>
<span><span class="co">## Outcome: y</span></span>
<span><span class="co">## X: time</span></span>
<span><span class="co">## Individual: id</span></span>
<span><span class="co">## Group: group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model Formula:</span></span>
<span><span class="co">## y ~ A * exp(-B * exp(-C * time)) </span></span>
<span><span class="co">## autocor ~ tructure(list(), class = "formula", .Environment = &lt;environment&gt;)</span></span>
<span><span class="co">## sigma ~ time + time:group</span></span>
<span><span class="co">## nu ~ 1</span></span>
<span><span class="co">## A ~ 0 + group</span></span>
<span><span class="co">## B ~ 0 + group</span></span>
<span><span class="co">## C ~ 0 + group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##     id group time            y</span></span>
<span><span class="co">## 1 id_1     a    1 9.650345e-06</span></span>
<span><span class="co">## 2 id_1     a    2 9.639086e-05</span></span>
<span><span class="co">## 3 id_1     a    3 7.020911e-04</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## (2100 rows)</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>, cores <span class="op">=</span> <span class="fl">4</span>, chains <span class="op">=</span> <span class="fl">4</span>, silent <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brmPlot.html">brmPlot</a></span><span class="op">(</span><span class="va">fit_l</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p>This model is also a poor fit, but it has a different problem. It
accurately models the low variability at the beginning of the
experiment, but the linear model is not flexible enough to adapt to the
changes in variance even in this simulated data.</p>
<p>We can also use spline sub models. The spline model does a very good
job of fitting the data due to the natural flexibility of polynomial
functions. Again this added accuracy comes at the cost of taking longer
for the model to fit. Here we can specify “gam” or “spline” for
backwards compatibility.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"gompertz"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"spline"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">gomp</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">15</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span></span></code></pre></div>
<pre><code><span><span class="co">## gompertz brms student model:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## pcvr formula variables:</span></span>
<span><span class="co">## Outcome: y</span></span>
<span><span class="co">## X: time</span></span>
<span><span class="co">## Individual: id</span></span>
<span><span class="co">## Group: group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model Formula:</span></span>
<span><span class="co">## y ~ A * exp(-B * exp(-C * time)) </span></span>
<span><span class="co">## autocor ~ tructure(list(), class = "formula", .Environment = &lt;environment&gt;)</span></span>
<span><span class="co">## sigma ~ s(time, by = group)</span></span>
<span><span class="co">## nu ~ 1</span></span>
<span><span class="co">## A ~ 0 + group</span></span>
<span><span class="co">## B ~ 0 + group</span></span>
<span><span class="co">## C ~ 0 + group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##     id group time            y</span></span>
<span><span class="co">## 1 id_1     a    1 9.650345e-06</span></span>
<span><span class="co">## 2 id_1     a    2 9.639086e-05</span></span>
<span><span class="co">## 3 id_1     a    3 7.020911e-04</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## (2100 rows)</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>, cores <span class="op">=</span> <span class="fl">4</span>, chains <span class="op">=</span> <span class="fl">4</span>, silent <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/brmPlot.html">brmPlot</a></span><span class="op">(</span><span class="va">fit_s</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p>Here we try applying a gompertz function to the variance submodel.
While this is much less flexible than splines it tends to describe the
variance of a sigmoid growth model quite well and allows for easier
hypothesis testing between groups. A fringe benefit can also be the
predictability of the gompertz formula in extrapolating future data.
Splines can have unexpected behavior when trying to predict timepoints
outside of your initial data, but the gompertz formula is more
predictable. Additionally, since the spline sub model will fit many
basis functions this will generally be <strong>significantly</strong>
faster since it only needs to find 3 parameters to complete the sub
model, and each can have a mildly informative prior. As a single
reference point, the model below fit in about 6 minutes while the spline
model above took slightly over an hour to fit. These example models have
three groups and the model with a gompertz sub model contains 21 total
parameters while the spline sub model version contains 43 total
parameters.</p>
<p>When setting priors for the gompertz sub-model it is generally
reasonable to expect a similar growth rate and inflection point as in
the main model (assuming the main model is gompertz as well).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"gompertz"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"gompertz"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">gomp</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">15</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>    <span class="st">"sigmaA"</span> <span class="op">=</span> <span class="fl">15</span>, <span class="st">"sigmaB"</span> <span class="op">=</span> <span class="fl">15</span>, <span class="st">"sigmaC"</span> <span class="op">=</span> <span class="fl">0.25</span></span>
<span>  <span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span></span></code></pre></div>
<pre><code><span><span class="co">## gompertz brms student model:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## pcvr formula variables:</span></span>
<span><span class="co">## Outcome: y</span></span>
<span><span class="co">## X: time</span></span>
<span><span class="co">## Individual: id</span></span>
<span><span class="co">## Group: group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model Formula:</span></span>
<span><span class="co">## y ~ A * exp(-B * exp(-C * time)) </span></span>
<span><span class="co">## autocor ~ tructure(list(), class = "formula", .Environment = &lt;environment&gt;)</span></span>
<span><span class="co">## sigma ~ sigmaA * exp(-sigmaB * exp(-sigmaC * time))</span></span>
<span><span class="co">## nu ~ 1</span></span>
<span><span class="co">## A ~ 0 + group</span></span>
<span><span class="co">## B ~ 0 + group</span></span>
<span><span class="co">## C ~ 0 + group</span></span>
<span><span class="co">## sigmaA ~ 0 + group</span></span>
<span><span class="co">## sigmaB ~ 0 + group</span></span>
<span><span class="co">## sigmaC ~ 0 + group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##     id group time            y</span></span>
<span><span class="co">## 1 id_1     a    1 9.650345e-06</span></span>
<span><span class="co">## 2 id_1     a    2 9.639086e-05</span></span>
<span><span class="co">## 3 id_1     a    3 7.020911e-04</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## (2100 rows)</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>, cores <span class="op">=</span> <span class="fl">4</span>, chains <span class="op">=</span> <span class="fl">4</span>, silent <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/brmPlot.html">brmPlot</a></span><span class="op">(</span><span class="va">fit_g</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p>A few other options are shown here as further examples. There are as
many ways to model variance as there are to model growth using the
<code>brms</code> backend, but other options are more limited.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draw_gomp_sigma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">23</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">21</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.22</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">draw_logistic_sigma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">20</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="fl">15</span> <span class="op">-</span> <span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">draw_logistic_exp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">2.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.08</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">draw_logistic_quad</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0.3</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0.02</span> <span class="op">*</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"gray60"</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">12</span>, color <span class="op">=</span> <span class="st">"Homoskedastic"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">0.8</span>, intercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"Linear"</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    key_glyph <span class="op">=</span> <span class="va">draw_key_path</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"gam"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Spline"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span>, se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    key_glyph <span class="op">=</span> <span class="va">draw_key_path</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_gomp_sigma</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Gompertz"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_logistic_sigma</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Logistic"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_logistic_exp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Exponential"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_logistic_quad</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Quadratic"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, begin <span class="op">=</span> <span class="fl">0.1</span>, end <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, title <span class="op">=</span> <span class="st">"Gompertz Sigma"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>When considering several sub models (or growth models) we can compare
<code>brms</code> models using Leave-One-Out Information Criterion (LOO
IC). For frequentist models a more familiar metric like BIC or AIC might
be used.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo_spline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">fit_s</span>, <span class="st">"loo"</span><span class="op">)</span></span>
<span><span class="va">loo_homo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">fit_h</span>, <span class="st">"loo"</span><span class="op">)</span></span>
<span><span class="va">loo_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">fit_l</span>, <span class="st">"loo"</span><span class="op">)</span></span>
<span><span class="va">loo_gomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">fit_g</span>, <span class="st">"loo"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="va">loo_homo</span><span class="op">$</span><span class="va">criteria</span><span class="op">$</span><span class="va">loo</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="va">loo_spline</span><span class="op">$</span><span class="va">criteria</span><span class="op">$</span><span class="va">loo</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="va">loo_linear</span><span class="op">$</span><span class="va">criteria</span><span class="op">$</span><span class="va">loo</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">loo_gomp</span><span class="op">$</span><span class="va">criteria</span><span class="op">$</span><span class="va">loo</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">loodf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>loo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">s</span>, <span class="va">l</span>, <span class="va">g</span><span class="op">)</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Homosked"</span>, <span class="st">"Spline"</span>, <span class="st">"Linear"</span>, <span class="st">"Gompertz"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loodf</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">loodf</span><span class="op">$</span><span class="va">model</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">loodf</span><span class="op">$</span><span class="va">model</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">loodf</span><span class="op">$</span><span class="va">loo</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">loodf</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">model</span>, y <span class="op">=</span> <span class="va">loo</span>, fill <span class="op">=</span> <span class="va">model</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"LOO Information Criteria"</span>, x <span class="op">=</span> <span class="st">"Sub Model of Sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p>The spline sub-model tends to have the best LOO IC, but comparing
credible intervals while taking speed and interpretability into account
may change which model is the best option for your situation. For this
particular data the gompertz submodel does seem to perform very well
despite the LOO IC difference from using splines.</p>
</div>
<div class="section level4">
<h4 id="growthss----start----">
<code>growthSS(..., start, ...)</code><a class="anchor" aria-label="anchor" href="#growthss----start----"></a>
</h4>
<p>One of the main difficulties in non-linear modeling is getting the
models to fit without convergence errors. Using <code>growthSS</code>
the six main model options (and GAMs, although in a different way) are
self-starting and do not require starting values. For the double sigmoid
options starting values are required though.</p>
<p>Additionally, using the <code>brms</code> backend this argument is
used to specify prior distributions. Setting appropriate prior
distributions is an important part and often criticized part of Bayesian
statistics. Prior distributions are often talked about in the language
of “prior beliefs”, which can be somewhat misleading. Instead it can be
helpful to think of prior distributions as hard-headed prior
evidence.</p>
<p>In a broad sense, priors can be “strong” or “weak”.</p>
<div class="section level5">
<h5 id="strong-priors">Strong Priors<a class="anchor" aria-label="anchor" href="#strong-priors"></a>
</h5>
<p>A strong prior is generally thought of as a prior with low variance.
Almost all of the probability is in a tight space and the observed data
will have a very hard time shifting the distribution meaningfully. Here
is an example of a strong prior hurting a model. This example is clearly
dramatic, but less absurd strong priors will still impact your
results.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">345</span><span class="op">)</span></span>
<span><span class="va">ln</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"linear"</span>, n <span class="op">=</span> <span class="fl">5</span>, t <span class="op">=</span> <span class="fl">10</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">strongPrior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">student_t</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>, dpar <span class="op">=</span> <span class="st">"sigma"</span>, class <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">gamma</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.1</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"nu"</span>, lb <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">.05</span><span class="op">)</span>, nlpar <span class="op">=</span> <span class="st">"A"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"homo"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">ln</span>, priors <span class="op">=</span> <span class="va">strongPrior</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, iter <span class="op">=</span> <span class="fl">1000</span>, cores <span class="op">=</span> <span class="fl">2</span>, chains <span class="op">=</span> <span class="fl">2</span>, silent <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/brmPlot.html">brmPlot</a></span><span class="op">(</span><span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Setting a prior as narrow as <code>N(10, 0.05)</code> intuitively
does feel too strong, as though we are so sure already that we can’t
expect to learn much more, but another way that a prior can be too
strong is in providing too much unrealistic information. Specifically
the flat prior can also be thought of as too strong given that it will
weigh all numbers equally, which is almost never a reasonable
assumption. In our growth model examples there should be no probability
given to negative growth rates when plants start from seed. Even if the
flat prior is constricted to be positive there is no parameterization
where a parameter value in the thousands or millions makes sense as
being biologically plausible.</p>
<p>Finally, when setting priors separately for groups you should
consider the evidence toward your eventual hypotheses contained in those
priors. If the mean effect size of some hypothesis of interest is far
away from 0 based solely on your prior distributions then they are
probably too strong.</p>
<p>Above all, remember to focus on evidence instead of hopes and
beliefs. By default <code>pcvr</code> will make biologically plausible
and individually weak priors for each parameter in your growth model
using <code>growthSS</code> and check that the prior evidence of common
hypotheses is not too strong, but it will not stop you from going
forward with strong priors if you specify them.</p>
</div>
<div class="section level5">
<h5 id="weak-prior">Weak Prior<a class="anchor" aria-label="anchor" href="#weak-prior"></a>
</h5>
<p>Generally we aim for “weak” or “mildly informative” priors. The goal
with these is to constrict our sampler to possible values so that it
moves faster and to introduce evidence driven domain expertise.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weakPrior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">student_t</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>, dpar <span class="op">=</span> <span class="st">"sigma"</span>, class <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">gamma</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.1</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"nu"</span>, lb <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">0.25</span><span class="op">)</span>, nlpar <span class="op">=</span> <span class="st">"A"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"homo"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">ln</span>, priors <span class="op">=</span> <span class="va">weakPrior</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, iter <span class="op">=</span> <span class="fl">1000</span>, cores <span class="op">=</span> <span class="fl">2</span>, chains <span class="op">=</span> <span class="fl">2</span>, silent <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/brmPlot.html">brmPlot</a></span><span class="op">(</span><span class="va">fit</span>, form <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>As you can see the weak priors moved to meet our data and now we have
usable posterior distributions. The variance is large but that is
natural with 5 reps per condition when looking at 99% credible
intervals.</p>
</div>
<div class="section level5">
<h5 id="priors-in-growthss">Priors in <code>growthSS</code><a class="anchor" aria-label="anchor" href="#priors-in-growthss"></a>
</h5>
<p>In <code>growthSS</code> priors can be specified as a
<code>brmsprior</code> object (in which case it is used as is, like in
the strong/weak examples above), a named list (names representing
parameters), or a numeric vector, where values will be used to generate
lognormal priors with a long right tail. Lognormal priors with long
right tails are used because the values for our growth curves are
strictly positive and the lognormal distribution is easily interpreted.
The tail is a product of the variance, which is assumed to be 0.25 for
simplicity and to ensure priors are wide. This means that only a
location parameter needs to be provided. If a list is used then each
element of the list can be length 1 in which case each group will use
the same prior or it can be a vector of the same length as
<code>unique(data$group)</code> where <code>group</code> is your
grouping variable from the <code>form</code> argument to
<code>growthSS</code>. If a vector is used then a warning will be
printed to check that the assumed order of groups is correct. The
<code>growthSim</code> function can be useful in thinking about what a
reasonable prior distribution might be, although priors should not be
picked by trying to get a great fit by eye to your collected data.</p>
<p>We can check the priors made by <code>growthSS</code> with the
<code>plotPrior</code> function.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">priorPlots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotPrior.html">plotPrior</a></span><span class="op">(</span><span class="va">priors</span><span class="op">)</span></span>
<span><span class="va">priorPlots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">priorPlots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">priorPlots</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>Looking at the prior distributions this way is useful, but the
parameter values can be a degree removed from what we are really wanting
to check. To help with picking reasonable priors based on the growth
curves they’d represent the <code>plotPrior</code> function can also
simulate growth curves by making draws from the specified prior
distributions. Here is an example of using <code>plotPrior</code> in
this way to pick between possible sets of prior distributions for a
gompertz model. For asymptotic distributions the prior on “A” is added
to the y margin. For distributions with an inflection point the prior on
“B” is shown in the x margin. Arbitrary numbers of priors can be
compared in this manner, but more than two or three can be cluttered so
an iterative process is recommended if you are learning about your
growth model.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">twoPriors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">130</span><span class="op">)</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">12</span><span class="op">)</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotPrior.html">plotPrior</a></span><span class="op">(</span><span class="va">twoPriors</span>, <span class="st">"gompertz"</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
</div>
<div class="section level4">
<h4 id="growthss----tau----">
<code>growthSS(..., tau, ...)</code><a class="anchor" aria-label="anchor" href="#growthss----tau----"></a>
</h4>
<p>For <code>nlrq</code> models the “tau” argument determines which
quantiles are fit. By default this uses the median (0.5), but can be any
quantile or vector of quantiles between 0 and 1. In the next section we
fit an nlrq model with many quantiles shown.</p>
</div>
<div class="section level4">
<h4 id="growthss----hierarchy----">
<code>growthSS(..., hierarchy, ...)</code><a class="anchor" aria-label="anchor" href="#growthss----hierarchy----"></a>
</h4>
<p>Hierarchical models can be specified by adding covariates to the
model formula and specifying models for those covariates in the
<code>hierarchy</code> argument.</p>
<p>A hierarchical formula would be written as
<code>y ~ time + covar | id / group</code> and we could specify to only
model the <code>A</code> parameter as being modeled by
<code>covar</code> by adding
<code>hierarchy = list("A" = "int_linear")</code>.</p>
<p>This would change a logistic model from something like:</p>
<p><span class="math display">$$
Y \sim \frac{A}{(1 + \text{e}^{( (B-x)/C)})}\\
A \sim 0 + \text{group}\\
B \sim 0 + \text{group}\\
C \sim 0 + \text{group}
$$</span></p>
<p>to being something like:</p>
<p><span class="math display">$$
Y \sim \frac{A}{(1 + \text{e}^{( (B-x)/C)})}\\
A \sim AI + AA \cdot \text{covariate}\\
B \sim 0 + \text{group}\\
C \sim 0 + \text{group}\\
AI \sim 0 + \text{group}\\
AA \sim 0 + \text{group}
$$</span></p>
<p>This can be helpful in modeling the effect of time on one phenotype
given another or in including watering data, etc.</p>
</div>
<div class="section level4">
<h4 id="multi-value-traits">Multi Value Traits<a class="anchor" aria-label="anchor" href="#multi-value-traits"></a>
</h4>
<p>Multi value traits can be modeled in the same ways using the
<code>mvSS</code> function.</p>
<p>For the most part <code>mvSS</code> has the same arguments as
<code>growthSS</code> but with the addition of a
<code>spectral_index</code> argument, which can be “none” or any of the
indices listed in the <code>PlantCV</code> <a href="https://plantcv.readthedocs.io/en/latest/spectral_index/" class="external-link">docs</a>.
If a spectral index is specified then any truncation of the response
variable is handled for you and the model family is changed to
skew_normal (if using the <code>brms</code> backend).</p>
<p>Additionally, since there are generally fewer options for working
with multi value traits the <code>mvSS</code> function can use
non-longitudinal data, as in the example below, where the formula
specifies <code>bins</code> given <code>value</code> per bin predicted
by <code>group</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">mv_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvSim.html">mvSim</a></span><span class="op">(</span>dists <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span>, wide <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">mv_df</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">900</span><span class="op">)</span></span>
<span><span class="va">mv_df</span> <span class="op">&lt;-</span> <span class="va">mv_df</span><span class="op">[</span><span class="va">mv_df</span><span class="op">$</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span>
<span><span class="va">mv_df</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"sim_"</span>, <span class="st">""</span>, <span class="va">mv_df</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvSS.html">mvSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear"</span>, form <span class="op">=</span> <span class="va">label</span> <span class="op">|</span> <span class="va">value</span> <span class="op">~</span> <span class="va">group</span>, df <span class="op">=</span> <span class="va">mv_df</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"brms"</span>, spectral_index <span class="op">=</span> <span class="st">"ci_rededge"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss1</span></span></code></pre></div>
<pre><code><span><span class="co">## linear brms skew_normal model:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## pcvr formula variables:</span></span>
<span><span class="co">## Outcome: label | resp_weights(value) + trunc(lb = -1, ub = Inf)</span></span>
<span><span class="co">## Group: group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model Formula:</span></span>
<span><span class="co">## label | resp_weights(value) + trunc(lb = -1, ub = Inf) ~ A </span></span>
<span><span class="co">## A ~ 0 + group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Data:</span></span>
<span><span class="co">##   id group variable value label</span></span>
<span><span class="co">## 7  7     a    sim_1     2     1</span></span>
<span><span class="co">## 8  8     b    sim_1     1     1</span></span>
<span><span class="co">## 9  9     a    sim_1     1     1</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## (1454 rows)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="using-fitgrowth">Using <code>fitGrowth</code><a class="anchor" aria-label="anchor" href="#using-fitgrowth"></a>
</h3>
<p>The output from <code>growthSS</code> is passed to
<code>fitGrowth</code> which fits the growth model using the specified
backend.</p>
<p>Here we fit a model using each backend to simulated data.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"logistic"</span>, n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">160</span><span class="op">)</span>,</span>
<span>  <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>  <span class="st">"C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3.5</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nls_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"nls"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Individual is not used with type = 'nls'.</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nlrq_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"nlrq"</span>,</span>
<span>  tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="fl">0.04</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Individual is not used with type = 'nlrq'.</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nlme_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, sigma <span class="op">=</span> <span class="st">"power"</span>, type <span class="op">=</span> <span class="st">"nlme"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mgcv_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"gam"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"mgcv"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Individual is not used with type = 'gam'.</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brms_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  sigma <span class="op">=</span> <span class="st">"spline"</span>, df <span class="op">=</span> <span class="va">simdf</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we have all the essential model components in the
<code>..._ss</code> objects. Since we specified a logistic model we have
three parameters, the asymptote (<code>A</code>), the inflection point
(<code>B</code>), and the growth rate (<code>C</code>). In the
<code>brms</code> option our sub model uses a GAM and does not add more
parameters. Note that in practice gompertz models tend to fit real data
better than logistic models, but they can be more difficult to fit using
the frequentist backends.</p>
<p>Before trying to fit the model it is generally a good idea to check
one last plot of the data and make sure you have everything defined
correctly.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>This looks okay, there are no strange jumps in the data or glaring
problems, the group and id variables seem to uniquely identify lines so
the models should fit well.</p>
<p>Now we use <code>fitGrowth</code> to fit our models. Additional
arguments can be passed to fitGrowth (see <code><a href="../reference/fitGrowth.html">?fitGrowth</a></code> for
details), but here we only use those to specify details for the
<code>brms</code> model. Note that 500 iterations for the
<code>brms</code> model is only to run a quick example, generally 2000
or more should be used and with more than 1 chain.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nls_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">nls_ss</span><span class="op">)</span></span>
<span><span class="va">nlrq_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">nlrq_ss</span><span class="op">)</span></span>
<span><span class="va">nlme_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">nlme_ss</span><span class="op">)</span></span>
<span><span class="va">mgcv_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">mgcv_ss</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brms_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">brms_ss</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">500</span>, cores <span class="op">=</span> <span class="fl">1</span>, chains <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="check-model-fit">Check Model Fit<a class="anchor" aria-label="anchor" href="#check-model-fit"></a>
</h4>
<p>We can check the model fits using <code>growthPlot</code>.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">nls_fit</span>, form <span class="op">=</span> <span class="va">nls_ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">nls_ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">nlrq_fit</span>, form <span class="op">=</span> <span class="va">nlrq_ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">nlrq_ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-30-2.png" width="700"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">nlme_fit</span>, form <span class="op">=</span> <span class="va">nlme_ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">nlme_ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-30-3.png" width="700"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">mgcv_fit</span>, form <span class="op">=</span> <span class="va">mgcv_ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">mgcv_ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-30-4.png" width="700"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">brms_fit</span>, form <span class="op">=</span> <span class="va">brms_ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">brms_ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p><img src="brmPlot1.png"></p>
</div>
</div>
<div class="section level3">
<h3 id="hypothesis-testing">Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h3>
<p>In linear regression the default null hypothesis
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta = 0</annotation></semantics></math>)
can be useful as each beta past the intercept directly measures the
effect of one variable. In non-linear regression we generally have more
complicated model parameters and meaningful testing can be a little more
involved, typically requiring contrast statements or nested models. In
<code>pcvr</code> the <code>testGrowth</code> function allows for
hypothesis testing on model parameters for frequentist models. For
Bayesian models the <code><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">brms::hypothesis</a></code> function is
recommended.</p>
<div class="section level4">
<h4 id="testgrowth">
<code>testGrowth</code><a class="anchor" aria-label="anchor" href="#testgrowth"></a>
</h4>
<p><code>testGrowth</code> takes three arguments, the
<code>growthSS</code> output used to fit a model, the model itself, and
a list of parameters to test. Broadly, two kinds of tests are supported.
First, if the <code>test</code> argument is a parameter name or a vector
of parameter names then a version of the model is fit with the
parameters in <code>test</code> not varying by group and the models are
compared with an anova. In this case the resulting p-value is broadly
testing the null hypothesis that the groups have the same value for that
parameter.</p>
<p>Here we see that for our <code>nls</code> model is statistically
significantly improved by varying asymptote by group.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">nls_ss</span>, <span class="va">nls_fit</span>, test <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span><span class="op">$</span><span class="va">anova</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: y ~ A/(1 + exp((B[group] - time)/C[group]))</span></span>
<span><span class="co">## Model 2: y ~ A[group]/(1 + exp((B[group] - time)/C[group]))</span></span>
<span><span class="co">##   Res.Df Res.Sum Sq Df Sum Sq F value    Pr(&gt;F)    </span></span>
<span><span class="co">## 1    995     204775                                </span></span>
<span><span class="co">## 2    994     171686  1  33089  191.57 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>Likewise for the 49th percentile in our <code>nlrq</code> model</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">nlrq_ss</span>, <span class="va">nlrq_fit</span>, test <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span><span class="op">[[</span><span class="st">"0.49"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Model 1: y ~ A[group]/(1 + exp((B[group] - time)/C[group]))</span></span>
<span><span class="co">## Model 2: y ~ A/(1 + exp((B[group] - time)/C[group]))</span></span>
<span><span class="co">##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    </span></span>
<span><span class="co">## 1   6 -3901.2                         </span></span>
<span><span class="co">## 2   5 -4029.8 -1 257.27  &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>And the same is shown in our <code>nlme</code> model.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">nlme_ss</span>, <span class="va">nlme_fit</span>, test <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span><span class="op">$</span><span class="va">anova</span></span></code></pre></div>
<pre><code><span><span class="co">##         Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span></span>
<span><span class="co">## nullMod     1 13 4923.097 4986.898 -2448.549                        </span></span>
<span><span class="co">## fit         2 16 4913.518 4992.042 -2440.759 1 vs 2 15.57969  0.0014</span></span></code></pre>
<p>We cannot test parameters in the GAM of course but we still see that
the grouping improves the model fit.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">mgcv_ss</span>, <span class="va">mgcv_fit</span><span class="op">)</span><span class="op">$</span><span class="va">anova</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: y ~ s(time)</span></span>
<span><span class="co">## Model 2: y ~ 0 + group + s(time, by = group)</span></span>
<span><span class="co">##   Resid. Df Resid. Dev     Df Deviance     F    Pr(&gt;F)    </span></span>
<span><span class="co">## 1    992.43     271044                                    </span></span>
<span><span class="co">## 2    985.06     172134 7.3716    98909 76.96 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>These are relatively basic options for testing hypotheses in
non-linear growth models and should serve as a good starting point for
frequentist model analysis.</p>
<p>The second kind of hypothesis test in <code>testGrowth</code> is used
if the <code>test</code> argument is a hypothesis or list of hypotheses
similar to those used in <code><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">brms::hypothesis</a></code> syntax. These can
test more complex non-linear hypotheses by using
<code><a href="https://rdrr.io/pkg/car/man/deltaMethod.html" class="external-link">car::deltaMethod</a></code> to calculate standard errors for model
parameters. Note that this kind of testing is only supported with
<code>nls</code> and <code>nlme</code> model backends. This is a much
more flexible testing option.</p>
<p>Here we test several hypotheses on our <code>nls</code> and
<code>nlme</code> models to show the versatility of this option. In
practice you should not use these hypotheses and should be giving some
thought to how to express your stated hypothesis in terms of the model
parameters.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">nls_fit</span>, test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"A1 - A2 *1.1"</span>,</span>
<span>  <span class="st">"(B1+1) - B2"</span>,</span>
<span>  <span class="st">"C1 - (C2-0.5)"</span>,</span>
<span>  <span class="st">"A1/B1 - (1.1 * A2/B2)"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    Form   Estimate        SE   t-value      p-value</span></span>
<span><span class="co">## 1          A1 - A2 *1.1 19.9337491 2.5232917  7.899899 7.368006e-15</span></span>
<span><span class="co">## 2           (B1+1) - B2  3.1348883 0.1624348 19.299359 9.834927e-71</span></span>
<span><span class="co">## 3         C1 - (C2-0.5)  0.1517508 0.1292836  1.173782 2.407636e-01</span></span>
<span><span class="co">## 4 A1/B1 - (1.1 * A2/B2) -1.2329672 0.1538017  8.016603 3.036364e-15</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">nlme_fit</span>, test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"(A.groupa / A.groupb) - 0.9"</span>,</span>
<span>  <span class="st">"1 + (B.groupa - B.groupb)"</span>,</span>
<span>  <span class="st">"C.groupa/C.groupb - 1"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                          Form   Estimate         SE   Z-value      p-value</span></span>
<span><span class="co">## 1 (A.groupa / A.groupb) - 0.9  0.3122201 0.03541827  8.815227 1.194428e-18</span></span>
<span><span class="co">## 2   1 + (B.groupa - B.groupb)  3.1217631 0.16951043 18.416348 9.714055e-76</span></span>
<span><span class="co">## 3       C.groupa/C.groupb - 1 -0.1002474 0.03665858  2.734623 6.245172e-03</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="brmshypothesis">
<code>brms::hypothesis</code><a class="anchor" aria-label="anchor" href="#brmshypothesis"></a>
</h4>
<p>With the <code>brms</code> backend our options expand dramatically.
We can write arbitrarily complex hypotheses about our models and test
the posterior probability using <code><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">brms::hypothesis</a></code>. Here we
keep it simple and test that group A has an asymptote 10% larger than
group B’s asymptote. If we had a more complicated dataset then there is
no reason we could not expand this hypothesis instead to something like
<code>((A_genotype1_treatment1/A_genotype1_treatment2))-(1.1*(A_genotype2_treatment1/A_genotype2_treatment2)) &gt; 0</code>
to test relative tolerance to different treatments between genotypes. It
would be out of scope to go over all the potentially interesting
hypotheses since those will depend on your experimental design and
questions, but hopefully this communicates the flexibility in using
these models once they are fit. Access to the
<code><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">brms::hypothesis</a></code> function is generally a compelling reason
to use the <code>brms</code> backend if you have questions beyond “are
these groups different?”</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">hyp</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">hypothesis</a></span><span class="op">(</span><span class="va">brms_fit</span>, <span class="st">"(A_groupa) &gt; 1.1 * (A_groupb)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                          Hypothesis Estimate Est.Error CI.Lower CI.Upper</span></span>
<span><span class="co">## 1 ((A_groupa))-(1.1*(A_groupb)) &gt; 0 16.78802  3.135185 12.01271  21.9525</span></span>
<span><span class="co">##   Evid.Ratio Post.Prob Star</span></span>
<span><span class="co">## 1        Inf         1    *</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="threshold-models">Threshold Models<a class="anchor" aria-label="anchor" href="#threshold-models"></a>
</h3>
<p>As alluded to previously, using the <code>brms</code> backend
segmented models are possible and can be specified using “model1 +
model2” syntax, where the “+” specifies a changepoint where the process
shifts from model1 to model2. As many models as you need to combine can
be combined in this way, but more than 2 segments is likely to be very
slow and can become more difficult to fit well. If you add many segments
together then consider editing the <code>growthSS</code> output to set
stronger priors on any changepoints that are in the same vicinity. Since
the changepoints are parameterized they require priors and can be
included in any hypothesis tests on the model.</p>
<p>Here we briefly show several threshold model options.</p>
<p>First we look at a “linear + linear” model using a gam submodel. To
make the parameters distinct these segmented models have slightly
different parameter names. Each section of the model has parameters
named for the model and it’s parameters, so here we have “linear1A”,
“changePoint1”, and “linear2A”. Similar to the standard models, a
changepoint model of variance will have the name of the distributional
parameter they are modeling appended to each parameter name.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear + linear"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"linear1A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span><span class="op">)</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"linear2A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear + linear"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"spline"</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"linear1A"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">5</span>, <span class="st">"linear2A"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Here we look at a “linear + logistic” model using a gam submodel.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"linear + logistic"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"linear1A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span><span class="op">)</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    <span class="st">"logistic2A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span>, <span class="st">"logistic2B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>    <span class="st">"logistic2C"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear + logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"spline"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"linear1A"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    <span class="st">"logistic2A"</span> <span class="op">=</span> <span class="fl">100</span>, <span class="st">"logistic2B"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"logistic2C"</span> <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Here we fit a “linear + gam” model with a homoskedastic sub
model.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear + gam"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"int"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"linear1A"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Here we fit a three part linear model with a gam to model variance.
In this case we only used 500 iterations on one chain but the model
still fits reasonably well.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSim.html">growthSim</a></span><span class="op">(</span><span class="st">"linear + linear + linear"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">25</span>, t <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"linear1A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span><span class="op">)</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    <span class="st">"linear2A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"changePoint2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">30</span><span class="op">)</span>, <span class="st">"linear3A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">24</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"linear + linear + linear"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"spline"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"linear1A"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    <span class="st">"linear2A"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"changePoint2"</span> <span class="op">=</span> <span class="fl">15</span>,</span>
<span>    <span class="st">"linear3A"</span> <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span>, df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We can also fit thresholded models to the variance. Here we fit two
part intercept only models to both the data and the variance. This is
not a growth model exactly, but shows some of the available options
well.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"int + int"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"int + int"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"int1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"int2"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="co"># main model</span></span>
<span>    <span class="st">"sigmaint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmachangePoint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmaint2"</span> <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span>, <span class="co"># sub model</span></span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Here we fit int + linear models to the overall trend and the
variance</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"int + linear"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"int + linear"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"int1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"linear2A"</span> <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    <span class="st">"sigmaint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmachangePoint1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"sigmalinear2A"</span> <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Finally we fit a model of “int + logistic” for the main growth trend
and “int + gam” for the variance. The benefit here over a pure “gam”
model of variance is that we can test the intercept and changepoint
parameters of the variance now.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"int+logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, sigma <span class="op">=</span> <span class="st">"int + spline"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"int1"</span> <span class="op">=</span> <span class="fl">5</span>, <span class="st">"changePoint1"</span> <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    <span class="st">"logistic2A"</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">"logistic2B"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"logistic2C"</span> <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    <span class="st">"sigmaint1"</span> <span class="op">=</span> <span class="fl">5</span>, <span class="st">"sigmachangePoint1"</span> <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"brms"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">ss</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-analysis-and-reporting-guidelines">Bayesian Analysis and Reporting Guidelines<a class="anchor" aria-label="anchor" href="#bayesian-analysis-and-reporting-guidelines"></a>
</h2>
<p>Bayesian modeling offers a lot of flexibility but it is in less
common use than frequentist statistics so it can be more difficult to
explain to collaborators or reviewers. Additionally, guaranteeing
reproducibility and transparency requires some different steps. To help
with these (and other) potential issues John Kruschke wrote a paper on
the <a href="https://www.nature.com/articles/s41562-021-01177-7" class="external-link">Bayesian
Analysis and Reporting Guidelines</a> (BARG). All the information
required to fully explain a Bayesian model is returned by
<code>Stan</code> and by <code>brms</code>, but for ease of use pcvr has
a <code>barg</code> function that takes the fit model object and the
<code>growthSS</code> output to return several components of the BARG
useful for checking one or more models. See the documentation
(<code><a href="../reference/barg.html">?barg</a></code>) for more details.</p>
</div>
<div class="section level2">
<h2 id="comparing-models-over-time">Comparing Models Over Time<a class="anchor" aria-label="anchor" href="#comparing-models-over-time"></a>
</h2>
<p>As a final note on <code>brms</code> models, there is a possiblity of
making interesting early stopping rules in a Bayesian framework. If you
have models fit to subsets of your data then the <code>distPlot</code>
function will show changes in the posterior distribution for some or all
of your parameters over time or over another subset variable. Here the
growth trend plots are also a legend for the time of each posterior
distribution.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/joshqsumner/pcvrTestData/main/brmsFits.rdata"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">from3to25</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">fit_3</span>, <span class="va">fit_5</span>, <span class="va">fit_7</span>, <span class="va">fit_9</span>, <span class="va">fit_11</span>, <span class="va">fit_13</span>,</span>
<span>  <span class="va">fit_15</span>, <span class="va">fit_17</span>, <span class="va">fit_19</span>, <span class="va">fit_21</span>, <span class="va">fit_23</span>, <span class="va">fit_25</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/distributionPlot.html">distributionPlot</a></span><span class="op">(</span>fits <span class="op">=</span> <span class="va">from3to25</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, d <span class="op">=</span> <span class="va">simdf</span><span class="op">)</span></span></code></pre></div>
<p><img src="distPlot_vigPlot.png"></p>
</div>
<div class="section level2">
<h2 id="other-resources">Other Resources<a class="anchor" aria-label="anchor" href="#other-resources"></a>
</h2>
<p>The supported models in <code>pcvr</code> are meant to lower the
barrier to entry for complex models using <code>brms</code> and
<code>Stan</code>. While there are lots of options using these growth
models there are many many more options using <code>brms</code> directly
and still more is possible programming directly in <code>Stan</code>. If
you take an interest in developing more and more nuanced models then
please see the <a href="https://github.com/paul-buerkner/brms" class="external-link"><code>brms</code>
documentation</a>, <a href="https://mc-stan.org/users/documentation/" class="external-link"><code>Stan</code>
documentation</a>, or <a href="https://discourse.mc-stan.org/" class="external-link">stan
forums</a>. For models that you think may have broader appeal for high
throughput plant phenotyping please raise an issue on <a href="https://github.com/danforthcenter/pcvr" class="external-link">github</a> and help the
DDPSC data science team understand what the desired model is/where
existing options fall short for your needs.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Josh Sumner <br> Developed in DDPSC Datascience Core Facility <br> Logo design by <a href="https://twitter.com/Kerri_Gilbert" class="external-link">Kerri Gilbert</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
