<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bayesian Conjugacy • pcvr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Conjugacy">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home page"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/bellwether.html">Bellwether</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal.html">Longitudinal Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/roots.html">Root Phenotyping</a></li>
    <li><a class="dropdown-item" href="../articles/directional.html">Directional Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_conjugate.html">Conjugate Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_igm.html">Intermediate Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_agm.html">Advanced Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_mvt.html">Multi-Value Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/field_capacity.html">Water Derived Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/reading_pcv_data.html">Using online PlantCV Output</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quarto-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quarto Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials">
<li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/crop_reporter/tutorials/pcvrTutorial_multiValueTraits">Multi-Value Traits</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr" aria-label="View on Github"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV" aria-label="View PlantCV on Github"><span class="fa fa-leaf"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian Conjugacy</h1>
            <h3 data-toc-skip class="subtitle">pcvr v1.1.2</h3>
                        <h4 data-toc-skip class="author">Josh
Sumner</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/main/vignettes/articles/pcvrTutorial_conjugate.Rmd" class="external-link"><code>vignettes/articles/pcvrTutorial_conjugate.Rmd</code></a></small>
      <div class="d-none name"><code>pcvrTutorial_conjugate.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="outline">Outline<a class="anchor" aria-label="anchor" href="#outline"></a>
</h2>
<ul>
<li>
<code>pcvr</code> Goals</li>
<li>Load Package</li>
<li>Bayesian Statistics Intro</li>
<li>Bayesian Conjugacy Theory</li>
<li>Bayesian Conjugacy Example</li>
<li><code><a href="../reference/conjugate.html">pcvr::conjugate</a></code></li>
<li>Supported Distributions</li>
<li>
<code><a href="../reference/conjugate.html">pcvr::conjugate</a></code> arguments</li>
<li>Reading <code>conjugate</code> output</li>
</ul>
</div>
<div class="section level2">
<h2 id="pcvr-goals">
<code>pcvr</code> Goals<a class="anchor" aria-label="anchor" href="#pcvr-goals"></a>
</h2>
<p>Currently <code>pcvr</code> aims to:</p>
<ul>
<li>Make common tasks easier and consistent</li>
<li>Make select Bayesian statistics easier</li>
</ul>
<p>There is room for goals to evolve based on feedback and scientific
needs.</p>
</div>
<div class="section level2">
<h2 id="load-package">Load package<a class="anchor" aria-label="anchor" href="#load-package"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danforthcenter/pcvr" class="external-link">pcvr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/twolodzko/extraDistr" class="external-link">extraDistr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bayesian-statistics-intro">Bayesian Statistics Intro<a class="anchor" aria-label="anchor" href="#bayesian-statistics-intro"></a>
</h2>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Frequentist</th>
<th>Bayesian</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Fixed</td>
<td><span style="color:goldenrod;">True Effect</span></td>
<td><span style="color:purple;">Observed Data</span></td>
</tr>
<tr class="even">
<td>Random</td>
<td><span style="color:purple;">Observed Data</span></td>
<td><span style="color:goldenrod;">True Effect</span></td>
</tr>
<tr class="odd">
<td>Interpretation</td>
<td>P[Data | No Effect]</td>
<td>P[Hypothesis | Observed Data]</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="bayesian-conjugacy-theory">Bayesian Conjugacy Theory<a class="anchor" aria-label="anchor" href="#bayesian-conjugacy-theory"></a>
</h2>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="false" form="prefix">|</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="false" form="prefix">|</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo>∫</mo><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="false" form="prefix">|</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>d</mi><mi>θ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
P(\theta|(x_1, \ldots, x_i)) = \frac{\pi(\theta) \cdot L(\theta|(x_1, \ldots, x_i))}{\int \pi(\theta) \cdot L(\theta|(x_1, \ldots, x_i))~d\theta}
\end{equation}</annotation></semantics></math></p>
<p><span style="color:purple;"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="false" form="prefix">|</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\theta|(x_1, \ldots, x_i))</annotation></semantics></math></span>
= Posterior Distribution (Conclusion as a PDf)</p>
<p><span style="color:goldenrod;"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi(\theta)</annotation></semantics></math></span>
= Prior Distribution (Knowledge as a PDF)</p>
<p><span style="color:DodgerBlue;"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="false" form="prefix">|</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L(\theta|(x_1, \ldots, x_i))</annotation></semantics></math></span>
= Likelihood (Data that we collected)</p>
<p><span style="color:DarkRed;"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∫</mo><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="false" form="prefix">|</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>d</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">\int \pi(\theta) \cdot L(\theta|(x_1, \ldots, x_i))~d\theta</annotation></semantics></math></span>
= Marginal Distribution (this is the problem area)</p>
</div>
<div class="section level2">
<h2 id="int-pitheta-cdot-lthetax_1-ldots-x_idtheta">
<span style="color:DarkRed;"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∫</mo><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="false" form="prefix">|</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>d</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">\int \pi(\theta) \cdot L(\theta|(x_1, \ldots, x_i))~d\theta</annotation></semantics></math></span><a class="anchor" aria-label="anchor" href="#int-pitheta-cdot-lthetax_1-ldots-x_idtheta"></a>
</h2>
<p>Solving this integral is potentially a very difficult problem.</p>
<p>Historically there have been two answers:</p>
<ul>
<li>Find pairs of likelihood functions and Priors that integrate easily
(<span style="color:goldenrod;">these are the conjugate
priors</span>)</li>
<li>Numerical Methods (Powerful computers making numeric approximations
via MCMC or similar methods, see advanced growth modeling tutorial)</li>
</ul>
</div>
<div class="section level2">
<h2 id="verb-conjugation">Verb Conjugation<a class="anchor" aria-label="anchor" href="#verb-conjugation"></a>
</h2>
<p>This may all still seem abstract, so we’ll try to clear it up with
two examples.</p>
<p>If we take a foundational verb like “To Be” then we can conjugate it
depending on the context.</p>
<div class="float">
<img src="tobe.png" alt="Example of conjugation in language with ‘to be’ verb"><div class="figcaption">Example of conjugation in language with ‘to be’
verb</div>
</div>
<p>Now we add more information and the meaning gets more specific to
describe that information.</p>
<div class="float">
<img src="tobe2.png" alt="Adding context to the ‘to be’ verb changes it’s meaning"><div class="figcaption">Adding context to the ‘to be’ verb changes it’s
meaning</div>
</div>
<p>We can do the same thing easily with some probability distributions.
Similar to language we get more and more specific as the context is
better described (as we add more data).</p>
<div class="float">
<img src="tobe3.png" alt="We can get more specific language with more data in the form of context"><div class="figcaption">We can get more specific language with more data
in the form of context</div>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-beta-binomial-conjugacy">Bayesian Beta-Binomial Conjugacy<a class="anchor" aria-label="anchor" href="#bayesian-beta-binomial-conjugacy"></a>
</h2>
<p>In the previous example we updated a fundamental verb with
context.</p>
<p>Here we’ll update a probability distribution with data.</p>
<p>The P parameter of a Binomial distribution has a Beta conjugate
prior.</p>
<p><span class="math display">$$\begin{equation}
x_1, \ldots, x_n \sim Binomial(N, P) \\
P \sim Beta(\alpha, \beta)  \\
Beta(\alpha', \beta' |(x_1, \ldots, x_n)) = Beta(\alpha, \beta) \cdot
L(\alpha, \beta|(x_1, \ldots, x_n)) \\
\alpha` = \alpha + \Sigma(\text{Successes} \in x) \\
\beta` = \beta + \Sigma(\text{Failures} \in x)
\end{equation}$$</span></p>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-3-1.png" alt="Beta Distributions with different percentages of success and different precision." width="700"></p>
<p>Very simplistically we can think of conjugacy as when we know the
distribution of a parameter in another distribution.</p>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-4-1.png" alt="Beta Binomial conjugacy shown with different percentages of success and different precision." width="700"></p>
</div>
<div class="section level2">
<h2 id="pcvrconjugate">
<code>pcvr::conjugate</code><a class="anchor" aria-label="anchor" href="#pcvrconjugate"></a>
</h2>
<p>In <code>pcvr</code> 18 distributions are supported in the
<code>conjugate</code> function.</p>
<p>We’ll go over those distributions, what they tend to represent, how
they are updated, and what the common alternative tests would be for
that kind of data.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="23%">
<col width="23%">
<col width="23%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Distribution</th>
<th>Data</th>
<th>Updating</th>
<th>Common Option</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Gaussian</td>
<td>Normal</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>′</mi><mo>,</mo><mi>σ</mi><mi>′</mi><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu', \sigma' \sim N(\mu, \sigma)</annotation></semantics></math></td>
<td>Z-test</td>
</tr>
<tr class="even">
<td>T</td>
<td>Normal Means</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>′</mi><mo>,</mo><msub><mi>σ</mi><mi>μ</mi></msub><mo>,</mo><msub><mi>ν</mi><mi>μ</mi></msub><mi>′</mi><mo>∼</mo><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo>,</mo><mi>ν</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu', \sigma_\mu, \nu_\mu' \sim T(\mu, \sigma, \nu)</annotation></semantics></math></td>
<td>T-test</td>
</tr>
<tr class="odd">
<td>Lognormal</td>
<td>Positive Right Skewed</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>′</mi><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu' \sim N(\mu, \sigma)</annotation></semantics></math></td>
<td>Wilcox</td>
</tr>
<tr class="even">
<td>Lognormal2</td>
<td>Positive Right Skewed</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mi>′</mi><mo>∼</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho' \sim \Gamma(A, B)</annotation></semantics></math></td>
<td>Wilcox</td>
</tr>
<tr class="odd">
<td>Beta</td>
<td>Percentages</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mi>′</mi><mo>,</mo><mi>β</mi><mi>′</mi><mo>∼</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>+</mo><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\alpha', \beta' \sim \alpha, \beta + Counts</annotation></semantics></math></td>
<td>Wilcox</td>
</tr>
<tr class="even">
<td>Binomial</td>
<td>Success/Failure Counts</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>∼</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P \sim Beta(\alpha, \beta)</annotation></semantics></math></td>
<td>Wilcox/logistic regression</td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td>Counts</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>∼</mo><mi>G</mi><mi>a</mi><mi>m</mi><mi>m</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda \sim Gamma(A, B)</annotation></semantics></math></td>
<td>Wilcox/glm</td>
</tr>
<tr class="even">
<td>Neg-Binom.</td>
<td>Overdispersed Counts</td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>∼</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">P \sim Beta(\alpha, \beta)|r</annotation></semantics></math>)</td>
<td>Wilcox/glm</td>
</tr>
<tr class="odd">
<td>Von Mises (2)</td>
<td>Circular</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>′</mi><mo>,</mo><mi>κ</mi><msup><mi>′</mi><mo>*</mo></msup><mo>∼</mo><mi>V</mi><mi>M</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>κ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu', \kappa'^* \sim VMf(\mu, \kappa)</annotation></semantics></math></td>
<td>Watsons</td>
</tr>
<tr class="even">
<td>Uniform</td>
<td>Positive Flat</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mi>p</mi><mi>p</mi><mi>e</mi><mi>r</mi><mo>∼</mo><mi>P</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>t</mi><mi>o</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Upper \sim Pareto(A, B)</annotation></semantics></math></td>
<td>Wilcox</td>
</tr>
<tr class="odd">
<td>Pareto</td>
<td>Heavy Tail</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>h</mi><mi>a</mi><mi>p</mi><mi>e</mi><mo>∼</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>L</mi><mi>o</mi><mi>c</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">Shape \sim \Gamma(A, B)| Loc.</annotation></semantics></math></td>
<td>Wilcox</td>
</tr>
<tr class="even">
<td>Gamma</td>
<td>Right Skew</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>∼</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>S</mi><mi>h</mi><mi>a</mi><mi>p</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Rate \sim \Gamma(A, B)| Shape</annotation></semantics></math></td>
<td>Wilcox</td>
</tr>
<tr class="odd">
<td>Bernoulli</td>
<td>Logical</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>∼</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Rate \sim Beta(\alpha, \beta)</annotation></semantics></math></td>
<td>Logistic Regression</td>
</tr>
<tr class="even">
<td>Exponential</td>
<td>Right Skew</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>∼</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Rate \sim \Gamma(A, B)</annotation></semantics></math></td>
<td>Wilcox/glm</td>
</tr>
<tr class="odd">
<td>Bivariate Uniform</td>
<td>Flat</td>
<td>See Details</td>
<td>Distributional Model</td>
</tr>
<tr class="even">
<td>Bivariate Gaussian</td>
<td>Normal</td>
<td>See Details</td>
<td>Distributional Model</td>
</tr>
<tr class="odd">
<td>Bivariate Lognormal</td>
<td>Positive Right Skew</td>
<td>See Details</td>
<td>Distributional Model</td>
</tr>
</tbody>
</table>
<pre><code><span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_bar()`).</span></span></code></pre>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-5-1.png" alt="A collection of conjugate prior distributions available in pcvr." width="700"></p>
</div>
<div class="section level2">
<h2 id="pcvrconjugate-arguments">
<code>pcvr::conjugate</code> arguments<a class="anchor" aria-label="anchor" href="#pcvrconjugate-arguments"></a>
</h2>
<p><code>conjugate</code> takes one or two sets of SV (numeric) or MV
(matrix/df) data. Alternatively this can be a formula and a dataframe,
similar to <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">stats::t.test</a></code>.</p>
<p>The <code>method</code> argument specifies the distribution to be
used. See <code><a href="../reference/conjugate.html">?conjugate</a></code> for further details.</p>
<p>The <code>priors</code> argument allows you to specify the prior
distribution. If left NULL then default priors will be used.</p>
<p>The <code>plot</code> argument controls whether or not a ggplot is
made of the results. See later examples.</p>
<p>The <code>rope_range</code> and <code>rope_ci</code> arguments allow
region-of-practical-equivalence (ROPE) testing using the difference in
the posterior distributions if two samples are given.</p>
<p><code>cred.int.level</code> controls the credible intervals that are
calculated on the posterior distributions. The default of 89% is
arbitrary.</p>
<p>The <code>hypothesis</code> argument sets which hypothesis is tested
out of “greater”, “lesser”, “equal” and “unequal”. These are read as “s1
equal to s2”, etc.</p>
<p>The <code>bayes_factor</code> argument optionally lets you calculate
Bayes factors within each sample comparing the prior and posterior
odds.</p>
<div class="section level3">
<h3 id="pcvrconjugate-default-priors">
<code>pcvr::conjugate</code> default priors<a class="anchor" aria-label="anchor" href="#pcvrconjugate-default-priors"></a>
</h3>
<pre><code><span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_bar()`).</span></span></code></pre>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-6-1.png" alt="Default priors for several conjugate distributions." width="700"></p>
</div>
<div class="section level3">
<h3 id="using-rope-tests">Using ROPE tests<a class="anchor" aria-label="anchor" href="#using-rope-tests"></a>
</h3>
<p>ROPE (Region of Practical Equivalence) tests can be used for a
variety of purposes in <code>conjugate</code>.</p>
<p>Two of the main uses are to (1) evaluate whether the difference
between two groups is biologically meaningful or to (2) compare a
sample’s parameter against an existing expectation.</p>
<p>For the first case we pass 2 samples to conjugate and evaluate the
difference in the posteriors.</p>
<p>Here we use two sets of random exponential data and check if the
difference is within 0.5 of 0.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span></span>
<span>  s1 <span class="op">=</span> <span class="va">s1</span>, s2 <span class="op">=</span> <span class="va">s2</span>, method <span class="op">=</span> <span class="st">"exponential"</span>,</span>
<span>  priors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rope_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, rope_ci <span class="op">=</span> <span class="fl">0.89</span>,</span>
<span>  cred.int.level <span class="op">=</span> <span class="fl">0.89</span>, hypothesis <span class="op">=</span> <span class="st">"equal"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-7-1.png" alt="Output of the conjugate function highlighting the ROPE testing." width="700"></p>
<p>We get a probability of 0.34 that the highest density interval of the
difference falls in the interval [-0.5, 0.5], with a median difference
of 0.75.</p>
<p>For the second case we might want to compare the mean of some data
against an accepted interval for the mean:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span></span>
<span>  s1 <span class="op">=</span> <span class="va">s1</span>, method <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  rope_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>  hypothesis <span class="op">=</span> <span class="st">"unequal"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-8-1.png" alt="Another example of output of the conjugate function highlighting the ROPE testing." width="700"></p>
<p>Here we see about a 1 percent chance that the mean of our data is in
the [11, 13] interval that we listed as a range similar to an
alternative hypothesis in a T-test.</p>
</div>
<div class="section level3">
<h3 id="using-bayes-factors">Using Bayes Factors<a class="anchor" aria-label="anchor" href="#using-bayes-factors"></a>
</h3>
<p>Bayes factors compare Bayesian models and can be useful for model
selection and in parameter estimation. In <code>conjugate</code> Bayes
factors compare prior vs posterior distributions either at points or
over ranges.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">Data</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">Data</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">[</mo><mtext mathvariant="normal">Data</mtext><mo stretchy="false" form="prefix">|</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">[</mo><mtext mathvariant="normal">Data</mtext><mo stretchy="false" form="prefix">|</mo><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{P[H_1|\text{Data}]}{P[H_0|\text{Data}]} = \frac{P[H_1]}{P[H_0]} \cdot \frac{P[\text{Data}|H_1]}{P[\text{Data}|H_0]}</annotation></semantics></math></p>
<p>In this equation we relate the posterior odds to the prior odds
multiplied by a “Bayes Factor”, that is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">[</mo><mtext mathvariant="normal">Data</mtext><mo stretchy="false" form="prefix">|</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">[</mo><mtext mathvariant="normal">Data</mtext><mo stretchy="false" form="prefix">|</mo><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow></mfrac><annotation encoding="application/x-tex">\frac{P[\text{Data}|H_1]}{P[\text{Data}|H_0]}</annotation></semantics></math>.</p>
<p>Within <code>conjugate</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>2</mn></msub><annotation encoding="application/x-tex">H_2</annotation></semantics></math>
are either a point or a range in the support for the given
parameter.</p>
<p>We can work a simple example then compare to output from
<code>conjugate</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">x_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">d_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x_vals</span>, shape1 <span class="op">=</span> <span class="fl">2</span>, shape2 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># density from the prior Beta(2, 2)</span></span>
<span><span class="va">in_null</span> <span class="op">&lt;-</span> <span class="va">null</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">x_vals</span> <span class="op">&amp;</span> <span class="va">x_vals</span> <span class="op">&lt;</span> <span class="va">null</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Null"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x_vals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">label</span><span class="op">[</span><span class="op">!</span><span class="va">in_null</span> <span class="op">&amp;</span> <span class="va">x_vals</span> <span class="op">&lt;</span> <span class="fl">0.4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"lower"</span></span>
<span><span class="va">label</span><span class="op">[</span><span class="op">!</span><span class="va">in_null</span> <span class="op">&amp;</span> <span class="va">x_vals</span> <span class="op">&gt;</span> <span class="fl">0.6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"upper"</span></span>
<span></span>
<span><span class="va">lower_tail</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">pbeta</a></span><span class="op">(</span><span class="va">null</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span>, <span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">upper_tail</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">pbeta</a></span><span class="op">(</span><span class="va">null</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span>, <span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">null_region</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">lower_tail</span> <span class="op">-</span> <span class="va">upper_tail</span></span>
<span><span class="va">prior_odds</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">lower_tail</span> <span class="op">+</span> <span class="va">upper_tail</span><span class="op">)</span> <span class="op">/</span> <span class="va">null_region</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="va">d_vals</span>, fill <span class="op">=</span> <span class="va">in_null</span>, group <span class="op">=</span> <span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Alternative"</span>, <span class="st">"Null"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">null_region</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.3</span>, y <span class="op">=</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lower_tail</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.7</span>, y <span class="op">=</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upper_tail</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.8</span>, y <span class="op">=</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Prior Odds = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">prior_odds</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                                                  <span class="st">"\n= ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lower_tail</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">" + "</span>,</span>
<span>                                                  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upper_tail</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">") / "</span>,</span>
<span>                                                  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">null_region</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Percentage"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, title <span class="op">=</span> <span class="st">"Prior"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"inside"</span><span class="op">)</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-9-1.png" alt="Prior odds of a range hypothesis shown on a Beta 2, 2 prior" width="700"></p>
<p>Now we update our prior with some data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">successes</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">failures</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">post_dvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="fl">2</span> <span class="op">+</span> <span class="va">successes</span>, <span class="fl">2</span> <span class="op">+</span> <span class="va">failures</span><span class="op">)</span></span>
<span><span class="va">in_null</span> <span class="op">&lt;-</span> <span class="va">null</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">x_vals</span> <span class="op">&amp;</span> <span class="va">x_vals</span> <span class="op">&lt;</span> <span class="va">null</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Null"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x_vals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">label</span><span class="op">[</span><span class="op">!</span><span class="va">in_null</span> <span class="op">&amp;</span> <span class="va">x_vals</span> <span class="op">&lt;</span> <span class="fl">0.4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"lower"</span></span>
<span><span class="va">label</span><span class="op">[</span><span class="op">!</span><span class="va">in_null</span> <span class="op">&amp;</span> <span class="va">x_vals</span> <span class="op">&gt;</span> <span class="fl">0.6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"upper"</span></span>
<span></span>
<span><span class="va">lower_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">pbeta</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">2</span> <span class="op">+</span> <span class="va">successes</span>, <span class="fl">2</span> <span class="op">+</span> <span class="va">failures</span><span class="op">)</span></span>
<span><span class="va">upper_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">pbeta</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">2</span> <span class="op">+</span> <span class="va">successes</span>, <span class="fl">2</span> <span class="op">+</span> <span class="va">failures</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">null_post</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">lower_post</span> <span class="op">-</span> <span class="va">upper_post</span></span>
<span><span class="va">post_odds</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">lower_post</span> <span class="op">+</span> <span class="va">upper_post</span><span class="op">)</span> <span class="op">/</span> <span class="va">null_post</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="va">post_dvals</span>, fill <span class="op">=</span> <span class="va">in_null</span>, group <span class="op">=</span> <span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Alternative"</span>, <span class="st">"Null"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">null_post</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.3</span>, y <span class="op">=</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lower_post</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.7</span>, y <span class="op">=</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upper_post</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.2</span>, y <span class="op">=</span> <span class="fl">3</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Posterior Odds = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">post_odds</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                                                  <span class="st">"\n= ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lower_post</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">" + "</span>,</span>
<span>                                                  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upper_post</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">") / "</span>,</span>
<span>                                                  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">null_post</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Percentage"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, title <span class="op">=</span> <span class="st">"Posterior"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-10-1.png" alt="Posterior odds of a range hypothesis shown on a Beta 10, 4 posterior" width="700"></p>
<p>Our Bayes Factor is the ratio between the posterior and prior
odds:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">b_factor</span> <span class="op">&lt;-</span> <span class="va">post_odds</span> <span class="op">/</span> <span class="va">prior_odds</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.194529</span></span></code></pre>
<p>Here the Bayes factor shows that the interval [0.4, 0.6] is 2.2 times
less likely after updating our prior with this new data.</p>
<p>To do the same thing in conjugate we pass the bayes_factor argument
as a range and check the <code>bf_1</code> column of the summary for the
results from sample 1. If we were interested in a point hypothesis then
we would only enter one value, say 0.5.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span>s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"successes"</span> <span class="op">=</span> <span class="fl">8</span>, <span class="st">"trials"</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>                  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">2</span>, b <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                  bayes_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">conj</span></span></code></pre></div>
<pre><code><span><span class="co">## Beta distributed Rate parameter of Binomial distributed data.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample 1 Prior Beta(a = 2, b = 2)</span></span>
<span><span class="co">##  Posterior Beta(a = 10, b = 4)</span></span>
<span><span class="co">## Sample 1 Bayes Factor in 0.4 to 0.6 = 2.195</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   HDE_1 HDI_1_low HDI_1_high     bf_1</span></span>
<span><span class="co">## 1  0.75 0.5118205  0.8838498 2.194529</span></span></code></pre>
<p>Note that many distributions in <code>conjugate</code> will default
to very uninformative priors if you do not specify your own prior
distribution. It is very likely that a Bayes factor is essentially
meaningless in those cases. Put another way, for the factor relating
posterior vs prior odds to be meaningful there has to be some
information in the prior odds.</p>
<div class="section level4">
<h4 id="point-hypothesis-bayes-factors">Point Hypothesis Bayes Factors<a class="anchor" aria-label="anchor" href="#point-hypothesis-bayes-factors"></a>
</h4>
<p>Using a point hypothesis we do the same thing, but now the “odds” are
the density at a single point of the PDF instead of the sum of a
region.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">xrange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">d_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x_vals</span>, shape1 <span class="op">=</span> <span class="fl">2</span>, shape2 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">d_null</span> <span class="op">&lt;-</span> <span class="va">d_vals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x_vals</span> <span class="op">-</span> <span class="va">null</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="va">d_vals</span>, fill <span class="op">=</span> <span class="st">"Alternative"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="va">d_null</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Null"</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">null</span>, y <span class="op">=</span> <span class="va">d_null</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>             key_glyph <span class="op">=</span> <span class="st">"rect"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Alternative"</span>, <span class="st">"Null"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Percentage"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, title <span class="op">=</span> <span class="st">"Prior"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"inside"</span><span class="op">)</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-13-1.png" alt="Prior odds of a point hypothesis shown on a Beta 2, 2 prior" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prior density at null</span></span>
<span><span class="va">prior_null_analytic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="fl">0.5</span>, shape1 <span class="op">=</span> <span class="fl">2</span>, shape2 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_vals2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="fl">2</span> <span class="op">+</span> <span class="va">successes</span>, <span class="fl">2</span> <span class="op">+</span> <span class="va">failures</span><span class="op">)</span></span>
<span><span class="va">d_vals2_null</span> <span class="op">&lt;-</span> <span class="va">d_vals2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x_vals</span> <span class="op">-</span> <span class="va">null</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># posterior density at null</span></span>
<span><span class="va">post_null_analytic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span> <span class="op">+</span> <span class="va">successes</span>, <span class="fl">2</span> <span class="op">+</span> <span class="va">failures</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="va">d_vals2</span>, fill <span class="op">=</span> <span class="st">"Alternative"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="va">d_vals</span>, fill <span class="op">=</span> <span class="st">"Alternative"</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="va">d_null</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Null"</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">null</span>, y <span class="op">=</span> <span class="va">d_null</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>             key_glyph <span class="op">=</span> <span class="st">"rect"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="va">d_vals2_null</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Null"</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">null</span>, y <span class="op">=</span> <span class="va">d_vals2_null</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>             key_glyph <span class="op">=</span> <span class="st">"rect"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Alternative"</span>, <span class="st">"Null"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Percentage"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, title <span class="op">=</span> <span class="st">"Updated Posterior"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.4</span>, y <span class="op">=</span> <span class="va">d_null</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">prior_null_analytic</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.4</span>, y <span class="op">=</span> <span class="va">d_vals2_null</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">post_null_analytic</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.4</span>, y <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"BF = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">post_null_analytic</span> <span class="op">/</span> <span class="va">prior_null_analytic</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-14-1.png" alt="Posterior odds of a point hypothesis shown on a Beta 10, 4 posterior" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">b_factor_point</span> <span class="op">&lt;-</span> <span class="va">post_null_analytic</span> <span class="op">/</span> <span class="va">prior_null_analytic</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.4654948</span></span></code></pre>
<p>Identically in <code>conjugate</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span>s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"successes"</span> <span class="op">=</span> <span class="fl">8</span>, <span class="st">"trials"</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>                  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">2</span>, b <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                  bayes_factor <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">conj</span></span></code></pre></div>
<pre><code><span><span class="co">## Beta distributed Rate parameter of Binomial distributed data.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample 1 Prior Beta(a = 2, b = 2)</span></span>
<span><span class="co">##  Posterior Beta(a = 10, b = 4)</span></span>
<span><span class="co">## Sample 1 Bayes Factor at 0.5 = 0.465</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   HDE_1 HDI_1_low HDI_1_high      bf_1</span></span>
<span><span class="co">## 1  0.75 0.5118205  0.8838498 0.4654948</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="reading-conjugate-output">Reading <code>conjugate</code> output<a class="anchor" aria-label="anchor" href="#reading-conjugate-output"></a>
</h2>
<p>The <code>conjugate</code> function outputs a <code>conjugate</code>
class object. If you just print that object it will show the main
results in a easily human-readable format.</p>
<p>Lastly we’ll show a few interpretations of <code>conjugate</code>
output in the plant phenotyping context.</p>
<ul>
<li>Germination Rates</li>
<li>Area</li>
<li>Leaf Counts</li>
<li>Hue</li>
</ul>
<p>The <code>barg</code> function can also use the
<code>conjugate</code> class and will run a prior sensitivity analysis
and show the posterior predictive distribution.</p>
</div>
<div class="section level2">
<h2 id="germination-rates">Germination Rates<a class="anchor" aria-label="anchor" href="#germination-rates"></a>
</h2>
<p>Germination Rates (or other binary outcomes like flowering or death)
can make good sense as Beta-Binomial data.</p>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-17-1.png" alt="Example germination count data between two treatment groups" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span></span>
<span>  s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>successes <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">geno</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="st">"y"</span><span class="op">]</span>, trials <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>successes <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">geno</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="st">"y"</span><span class="op">]</span>, trials <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"binomial"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-19-1.png" alt="Beta-Binomial conjugacy plot of the germination data, showing probability of equal rate." width="700"></p>
<p>Here we’d simply conclude that there is about a 19% chance that the
germination rate is the same between these two genotypes after 1 week.
We could do more with ROPE testing, but we’ll do that in the next
example.</p>
<p>We can also look at the printed output which shows human-readable
interpretations of hypothesis tests, ROPE tests, and Bayes Factors when
applicable.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## Beta distributed Rate parameter of Binomial distributed data.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample 1 Prior Beta(a = 0.5, b = 0.5)</span></span>
<span><span class="co">##  Posterior Beta(a = 50.5, b = 50.5)</span></span>
<span><span class="co">## Sample 2 Prior Beta(a = 0.5, b = 0.5)</span></span>
<span><span class="co">##  Posterior Beta(a = 63.5, b = 37.5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Posterior probability that S1 is equal to S2 = 18.951%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   HDE_1 HDI_1_low HDI_1_high     HDE_2 HDI_2_low HDI_2_high   hyp post.prob</span></span>
<span><span class="co">## 1   0.5 0.4207941  0.5792059 0.6313131 0.5508745  0.7038946 equal 0.1895143</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="area">Area<a class="anchor" aria-label="anchor" href="#area"></a>
</h2>
<p>Lots of phenotypes are gaussian and <code>conjugate</code> can be
used similarly to a T-test with the “t” method. Consider area data that
looks like this example.</p>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-21-1.png" alt="Example plant biomass (area) data between two treatment groups" width="700"></p>
<p>Here we include a ROPE test corresponding to our belief that any
difference in Area of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo><mn>2</mn><mi>c</mi><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\pm2 cm^2</annotation></semantics></math>
is biologically insignificant. We also show the formula syntax and use
non-default priors here (since default priors include negative values
which can’t happen with area).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span></span>
<span>  s1 <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">geno</span>, s2 <span class="op">=</span> <span class="va">df</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  rope_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  hypothesis <span class="op">=</span> <span class="st">"unequal"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-23-1.png" alt="Conjugate output comparing the mean of the two groups sizes." width="700"></p>
<p>Our plot shows about a 83% chance that these distributions are
unequal and a 24% chance that the difference in means is within
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo><mn>2</mn><mi>c</mi><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\pm2 cm^2</annotation></semantics></math>.</p>
<p>The other aspects of the output are a summary and the prior/posterior
parameters as well as several things only used internally.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="va">class</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $summary</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rope_df</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $posterior</span></span>
<span><span class="co">## [1] "list"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $prior</span></span>
<span><span class="co">## [1] "list"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $plot_parameters</span></span>
<span><span class="co">## [1] "list"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $data</span></span>
<span><span class="co">## [1] "list"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $call</span></span>
<span><span class="co">## [1] "call"</span></span></code></pre>
<p>The summary is a data.frame with a summary of the information in the
plot. It is printed at the end of the object.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## Normal distributed Mu parameter of T distributed data.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample 1 Prior Normal(mu = 10, sd = 2)</span></span>
<span><span class="co">##  Posterior Normal(mu = 14.682, sd = 0.774)</span></span>
<span><span class="co">## Sample 2 Prior Normal(mu = 10, sd = 2)</span></span>
<span><span class="co">##  Posterior Normal(mu = 11.51, sd = 1.077)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Posterior probability that S1 is not equal to S2 = 91.466%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Probability of the difference between Mu parameters being within [-2:2] using a % Credible Interval is 15.335% with an average difference of 3.177</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      HDE_1 HDI_1_low HDI_1_high    HDE_2 HDI_2_low HDI_2_high     hyp post.prob</span></span>
<span><span class="co">## 1 14.68175  13.44396   15.91955 11.50985  9.787879   13.23182 unequal 0.9146565</span></span>
<span><span class="co">##   HDE_rope HDI_rope_low HDI_rope_high rope_prob</span></span>
<span><span class="co">## 1   3.1772     1.013366      5.223168 0.1533536</span></span></code></pre>
<p>The posterior is the prior list updated with the given data, this
allows for Bayesian updating should you have a situation where supplying
data piecemeal makes sense. The prior is in the same format.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">res</span><span class="op">$</span><span class="va">posterior</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      mu       sd       </span></span>
<span><span class="co">## [1,] 14.68175 0.7744957</span></span>
<span><span class="co">## [2,] 11.50985 1.077449</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="leaf-counts">Leaf Counts<a class="anchor" aria-label="anchor" href="#leaf-counts"></a>
</h2>
<p>There are also several phenotypes that are counts. Numbers of
vertices, leaves, flowers, etc could all be used with one of the count
distributions. Here we consider Poisson distributed leaf counts between
two genotypes.</p>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-27-1.png" alt="Example leaf count data between two treatment groups" width="700"></p>
<p>Here we model <span class="math inline">$X \sim Poisson(\lambda)\\
\lambda \sim \Gamma(A, B)$</span></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span></span>
<span>  s1 <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">geno</span>, s2 <span class="op">=</span> <span class="va">df</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  rope_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  hypothesis <span class="op">=</span> <span class="st">"unequal"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## Gamma distributed Lambda parameter of Poisson distributed data.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample 1 Prior Gamma(a = 1, b = 1)</span></span>
<span><span class="co">##  Posterior Gamma(a = 67, b = 11)</span></span>
<span><span class="co">## Sample 2 Prior Gamma(a = 1, b = 1)</span></span>
<span><span class="co">##  Posterior Gamma(a = 98, b = 11)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Posterior probability that S1 is not equal to S2 = 91.398%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Probability of the difference between Lambda parameters being within [-1:1] using a % Credible Interval is 0% with an average difference of -2.782</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   HDE_1 HDI_1_low HDI_1_high    HDE_2 HDI_2_low HDI_2_high     hyp post.prob</span></span>
<span><span class="co">## 1     6  4.950908   7.325033 8.818182  7.519675   10.39265 unequal 0.9139806</span></span>
<span><span class="co">##    HDE_rope HDI_rope_low HDI_rope_high rope_prob</span></span>
<span><span class="co">## 1 -2.781883    -4.754465     -1.020078         0</span></span></code></pre>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-29-1.png" alt="Conjugate comparison of the Gamma distributed lambda parameter for Poisson distributed leaf counts." width="700"></p>
<p>We can comfortably say that the difference in the posteriors is not
in [-1, 1] and there is a 91% chance that the Gamma distributions for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
are different.</p>
</div>
<div class="section level2">
<h2 id="hue">Hue<a class="anchor" aria-label="anchor" href="#hue"></a>
</h2>
<p>Finally, we’ll show an example using what is likely the
least-familiar distribution in <code>conjugate</code>, the Von-Mises
distribution.</p>
<p>The Von-Mises distribution is a symmetric circular distribution
defined on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mi>π</mi><mo>,</mo><mi>π</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-\pi, \pi]</annotation></semantics></math>.</p>
<p>To use Von-Mises with data on other intervals there is a
<code>boundary</code> element in the prior that is used to rescale data
to radians for the updating before rescaling back to the parameter
space. See <code><a href="../reference/conjugate.html">?conjugate</a></code> for more examples of the
<code>boundary</code>.</p>
<pre><code><span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-30-1.png" alt="Example circular data between two treatment groups" width="700"></p>
<p>Note this is a very exaggerated example for the plant phenotyping
setting since green happens to be in the middle of the hue circle, which
wraps in the red colors.</p>
<p>If you do have wrapped circular data then looking at it in a
non-circular space like this would be a problem. For values we normally
get from plants other continuous methods can generally be useful.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">geno</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">geno</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Hue (radians)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="op">-</span><span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">0</span>, <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span>, <span class="va">pi</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-31-1.png" alt="Example circular data between two treatment groups treated as though it were not circular looks bimodal." width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conjugate.html">conjugate</a></span><span class="op">(</span></span>
<span>  s1 <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">geno</span>, s2 <span class="op">=</span> <span class="va">df</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"vonmises2"</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">0</span>, kappa <span class="op">=</span> <span class="fl">0.5</span>, boundary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## Von Mises distributed Direction parameter of Von Mises distributed data.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample 1 Prior Von Mises(mu = 0, kappa = 0.5, boundary = -3.142, n = 3.142, mu = 1)</span></span>
<span><span class="co">##  Posterior Von Mises(mu = 3.094, kappa = 1.817, n = 11, boundary = -3.142, mu = 3.142)</span></span>
<span><span class="co">## Sample 2 Prior Von Mises(mu = 0, kappa = 0.5, boundary = -3.142, n = 3.142, mu = 1)</span></span>
<span><span class="co">##  Posterior Von Mises(mu = 2.727, kappa = 2.509, n = 11, boundary = -3.142, mu = 3.142)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Posterior probability that S1 is equal to S2 = 79.05%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      HDE_1 HDI_1_low HDI_1_high    HDE_2 HDI_2_low HDI_2_high   hyp post.prob</span></span>
<span><span class="co">## 1 3.093691  1.668768  -1.717893 2.727366  1.497517   -2.43441 equal 0.7904981</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_conjugate_files/figure-html/unnamed-chunk-33-1.png" alt="Conjugate comparison of the direction of Von Mises distributed circular data." width="700"></p>
<p>Here our distributions are very similar and there is about a 79%
chance that their parameters are the same given this data and our (very
wide) priors.</p>
<p>Note that if you use data in a different <code>boundary</code> space
than radians the <code>rope_range</code> would be given in the observed
parameter space, not in radians.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Hopefully this has been a useful introduction to Bayesian
conjugacy.</p>
<p>Please direct questions/issues with <code><a href="../reference/conjugate.html">pcvr::conjugate</a></code> to
the pcvr github issues or help-datascience slack channel for DDPSC
users.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Josh Sumner <br> Developed in DDPSC Datascience Core Facility <br> Logo design by <a href="https://twitter.com/Kerri_Gilbert" class="external-link">Kerri Gilbert</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
