<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Intermediate Growth Modeling with `pcvr` • pcvr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Intermediate Growth Modeling with `pcvr`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcvr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home page"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/pcvr.html">pcvr</a></li>
    <li><a class="dropdown-item" href="../articles/longitudinal.html">Longitudinal Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/roots.html">Root Phenotyping</a></li>
    <li><a class="dropdown-item" href="../articles/directional.html">Directional Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_conjugate.html">Conjugate Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_igm.html">Intermediate Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_agm.html">Advanced Growth Modeling Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/pcvrTutorial_mvt.html">Multi-Value Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/field_capacity.html">Water Derived Traits Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/reading_pcv_data.html">Using online PlantCV Output</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quarto-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quarto Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quarto-tutorials">
<li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrInstallation">Installation</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intro">Intro</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_intermediateGrowthModeling">Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling">Advanced Growth Modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_conjugate">Bayesian Conjugate Priors</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/danforthcenter/pcvr/tree/crop_reporter/tutorials/pcvrTutorial_multiValueTraits">Multi-Value Traits</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://plantcv.org/">PlantCV</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/pcvr" aria-label="View on Github"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danforthcenter/PlantCV" aria-label="View PlantCV on Github"><span class="fa fa-leaf"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Intermediate Growth Modeling with `pcvr`</h1>
            <h3 data-toc-skip class="subtitle">pcvr v1.0.0</h3>
                        <h4 data-toc-skip class="author">Josh
Sumner</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danforthcenter/pcvr/blob/main/vignettes/articles/pcvrTutorial_igm.Rmd" class="external-link"><code>vignettes/articles/pcvrTutorial_igm.Rmd</code></a></small>
      <div class="d-none name"><code>pcvrTutorial_igm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="outline">Outline<a class="anchor" aria-label="anchor" href="#outline"></a>
</h2>
<ul>
<li>
<code>pcvr</code> Goals</li>
<li>Load Package</li>
<li>Why Longitudinal Modeling?</li>
<li>Supported Model Builders</li>
<li>Supported Curves</li>
<li><code>growthSS</code></li>
<li><code>fitGrowth</code></li>
<li><code>growthPlot</code></li>
<li><code>testGrowth</code></li>
<li>Resources</li>
</ul>
</div>
<div class="section level2">
<h2 id="pcvr-goals">
<code>pcvr</code> Goals<a class="anchor" aria-label="anchor" href="#pcvr-goals"></a>
</h2>
<p>Currently <code>pcvr</code> aims to:</p>
<ul>
<li>Make common tasks easier and consistent</li>
<li>Make select Bayesian statistics easier</li>
</ul>
<p>There is room for goals to evolve based on feedback and scientific
needs.</p>
</div>
<div class="section level2">
<h2 id="load-package">Load package<a class="anchor" aria-label="anchor" href="#load-package"></a>
</h2>
<p>Pre-work was to install R, Rstudio, and <code>pcvr</code> with
dependencies.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danforthcenter/pcvr" class="external-link">pcvr</a></span><span class="op">)</span> <span class="co"># or devtools::load_all() if you are editing</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="why-longitudinal-modeling">Why Longitudinal Modeling?<a class="anchor" aria-label="anchor" href="#why-longitudinal-modeling"></a>
</h2>
<p><code>plantCV</code> allows for user friendly high throughput image
based phenotyping</p>
<p>Resulting data follows individuals over time, which changes our
statistical needs.</p>
<p>Longitudinal Data is:</p>
<ul>
<li>Autocorrelated</li>
<li>Often non-linear</li>
<li>Heteroskedastic</li>
</ul>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-3-1.png" alt="Highlighting autocorrelation as a feature of longitudinal data" width="700"></p>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-4-1.png" alt="Highlighting non-linearyity as a common feature of longitudinal data" width="700"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">[</span><span class="va">simdf</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"y"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">[</span><span class="va">simdf</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">5</span>, <span class="st">"y"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">r3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">[</span><span class="va">simdf</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">10</span>, <span class="st">"y"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">r4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">[</span><span class="va">simdf</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">20</span>, <span class="st">"y"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">main</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, yend <span class="op">=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">5</span>, xend <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, yend <span class="op">=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">10</span>, xend <span class="op">=</span> <span class="fl">10</span>, y <span class="op">=</span> <span class="va">r3</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, yend <span class="op">=</span> <span class="va">r3</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">20</span>, xend <span class="op">=</span> <span class="fl">20</span>, y <span class="op">=</span> <span class="va">r4</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, yend <span class="op">=</span> <span class="va">r4</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Heteroskedasticity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sigma_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">simdf</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sigmaPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html" class="external-link">area</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html" class="external-link">area</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">hetPatch</span> <span class="op">&lt;-</span> <span class="va">main</span> <span class="op">/</span> <span class="va">sigmaPlot</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span><span class="op">)</span></span>
<span><span class="va">hetPatch</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-5-1.png" alt="Highlighting heteroskedasticity as a nearly ubiquitous feature of longitudinal data" width="700"></p>
</div>
<div class="section level2">
<h2 id="supported-model-builders">Supported Model Builders<a class="anchor" aria-label="anchor" href="#supported-model-builders"></a>
</h2>
<p>Five model building options are supported through the
<code>type</code> argument of growthSS:</p>
<p><code>nls</code>, <code>nlrq</code>, <code>nlme</code>,
<code>mgcv</code>, and <code>brms</code></p>
<p>Other than <code>mgcv</code> all model builders can fit 9 types of
growth models.</p>
</div>
<div class="section level2">
<h2 id="supported-model-builders-2">Supported Model Builders 2<a class="anchor" aria-label="anchor" href="#supported-model-builders-2"></a>
</h2>
<table style="width:100%;" class="table">
<colgroup>
<col width="19%">
<col width="24%">
<col width="19%">
<col width="17%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th>“nls”</th>
<th>“nlrq”</th>
<th>“nlme”</th>
<th>“mgcv”</th>
<th>“brms”</th>
</tr></thead>
<tbody><tr class="odd">
<td><code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls</a></code></td>
<td><code><a href="https://rdrr.io/pkg/quantreg/man/nlrq.html" class="external-link">quantreg::nlrq</a></code></td>
<td><code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme::nlme</a></code></td>
<td><code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam</a></code></td>
<td><code><a href="https://paulbuerkner.com/brms/reference/brms-package.html" class="external-link">brms::brms</a></code></td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="type-nls">type = “nls”<a class="anchor" aria-label="anchor" href="#type-nls"></a>
</h2>
<p>Non-linear least squares regression.</p>
<table class="table">
<thead><tr class="header">
<th>Longitudinal Trait</th>
<th>nls</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Non-linearity</td>
<td>✅</td>
</tr>
<tr class="even">
<td>Autocorrelation</td>
<td>❌</td>
</tr>
<tr class="odd">
<td>Heteroskedasticity</td>
<td>❌</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="type-nlrq">type = “nlrq”<a class="anchor" aria-label="anchor" href="#type-nlrq"></a>
</h2>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<thead><tr class="header">
<th>Linear Regression</th>
<th>Quantile Regression</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Predicts mean E(Y|X)</td>
<td>Predicts quantiles Q(Y|X)</td>
</tr>
<tr class="even">
<td>Works with small N</td>
<td>Requires higher N</td>
</tr>
<tr class="odd">
<td>Assumes Normality</td>
<td>No distributional assumptions</td>
</tr>
<tr class="even">
<td>E(Y|X) breaks with transformation</td>
<td>Q(Y|X) robust to transformation</td>
</tr>
<tr class="odd">
<td>Sensitive to outliers</td>
<td>Robust to outliers</td>
</tr>
<tr class="even">
<td>Computationally cheap</td>
<td>Computationally more expensive</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="type-nlrq-1">type = “nlrq”<a class="anchor" aria-label="anchor" href="#type-nlrq-1"></a>
</h2>
<p>Non-linear quantile regression.</p>
<table class="table">
<thead><tr class="header">
<th>Longitudinal Trait</th>
<th>nlrq</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Non-linearity</td>
<td>✅</td>
</tr>
<tr class="even">
<td>Autocorrelation</td>
<td>❌</td>
</tr>
<tr class="odd">
<td>Heteroskedasticity</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="type-nlme">type = “nlme”<a class="anchor" aria-label="anchor" href="#type-nlme"></a>
</h2>
<p>Non-linear Mixed Effect Models</p>
<table class="table">
<thead><tr class="header">
<th>Longitudinal Trait</th>
<th>nlme</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Non-linearity</td>
<td>✅</td>
</tr>
<tr class="even">
<td>Autocorrelation*</td>
<td>✅</td>
</tr>
<tr class="odd">
<td>Heteroskedasticity</td>
<td>✅</td>
</tr>
<tr class="even">
<td>Being a headache</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="type-mgcv">type = “mgcv”<a class="anchor" aria-label="anchor" href="#type-mgcv"></a>
</h2>
<p>General Additive Models Only</p>
<table class="table">
<thead><tr class="header">
<th>Longitudinal Trait</th>
<th>gam</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Non-linearity</td>
<td>✅</td>
</tr>
<tr class="even">
<td>Autocorrelation</td>
<td>❌</td>
</tr>
<tr class="odd">
<td>Heteroskedasticity</td>
<td>❌</td>
</tr>
<tr class="even">
<td>Unparameterized</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="type-brms">type = “brms”<a class="anchor" aria-label="anchor" href="#type-brms"></a>
</h2>
<p>Bayesian hierarchical Models</p>
<table class="table">
<thead><tr class="header">
<th>Longitudinal Trait</th>
<th>brms</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Non-linearity</td>
<td>✅</td>
</tr>
<tr class="even">
<td>Autocorrelation</td>
<td>✅</td>
</tr>
<tr class="odd">
<td>Heteroskedasticity</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="supported-growth-models">Supported Growth Models<a class="anchor" aria-label="anchor" href="#supported-growth-models"></a>
</h2>
<p>There are 6 main growth models supported in <code>pcvr</code>,
although there are several other options as well as changepoint models
made of combinations between them.</p>
<p>Of the general 6 we are looking at, 3 are asymptotic, 3 are
non-asympototic.</p>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-6-1.png" alt="Showing 3 examples of asymptotic and 3 examples of non-asymptotic growth curves that are supported by pcvr." width="700"></p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-1">Supported Growth Models<a class="anchor" aria-label="anchor" href="#supported-growth-models-1"></a>
</h2>
<p>There are an additional 3 sigmoidal models based on the Extreme Value
Distribution. Those are Weibull, Frechet, and Gumbel. The authors
generally prefer Gompertz to these options but for your data it is
possible that these could be a better fit.</p>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-7-1.png" alt="Showing variations of the Extreme Value Distribution sigmoid curves that are supported." width="700"></p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-2">Supported Growth Models 2<a class="anchor" aria-label="anchor" href="#supported-growth-models-2"></a>
</h2>
<p>There are also two double sigmoid curves intended for use with
recovery experiments.</p>
<pre><code><span><span class="co">## Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-8-1.png" alt="Two examples of multi-part models that can be parameterized without changepoints." width="700"></p>
</div>
<div class="section level2">
<h2 id="supported-growth-models-3">Supported Growth Models 3<a class="anchor" aria-label="anchor" href="#supported-growth-models-3"></a>
</h2>
<p>Generalized Additive Models (<a href="https://en.wikipedia.org/wiki/Generalized_additive_model" class="external-link">GAMs</a>)
are also supported.</p>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-10-1.png" alt="Example of the effect of changing the number of knots in a spline, with more knots being more prone to overfitting and fewer knots being less accurate for the observed data." width="700"></p>
</div>
<div class="section level2">
<h2 id="survival-models">Survival Models<a class="anchor" aria-label="anchor" href="#survival-models"></a>
</h2>
<p>Survival models can also be specified using the “survival” keyword.
These models can use the “survival” or “flexsurv” backends where
distributions can be specified as
<code>model = "survival {distribution}"</code>.</p>
<p>For details please see the <code>growthSS</code> documentation.</p>
</div>
<div class="section level2">
<h2 id="gams">GAMs<a class="anchor" aria-label="anchor" href="#gams"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">time</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">simdf</span><span class="op">)</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="va">support</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span>, length <span class="op">=</span> <span class="fl">400</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gam_diff.html">gam_diff</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">m</span>, newdata <span class="op">=</span> <span class="va">support</span>, g1 <span class="op">=</span> <span class="st">"a"</span>, g2 <span class="op">=</span> <span class="st">"b"</span>,</span>
<span>  byVar <span class="op">=</span> <span class="st">"group"</span>, smoothVar <span class="op">=</span> <span class="st">"time"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gam_diff-predictions">
<code>gam_diff</code> predictions<a class="anchor" aria-label="anchor" href="#gam_diff-predictions"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">simdf</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">group</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.1</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-13-1.png" alt="Example of means modeled by splines for two groups." width="700"></p>
</div>
<div class="section level2">
<h2 id="gam_diff-differences">
<code>gam_diff</code> differences<a class="anchor" aria-label="anchor" href="#gam_diff-differences"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gam_diff.html">gam_diff</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">m</span>, newdata <span class="op">=</span> <span class="va">support</span>, g1 <span class="op">=</span> <span class="st">"a"</span>, g2 <span class="op">=</span> <span class="st">"b"</span>,</span>
<span>  byVar <span class="op">=</span> <span class="st">"group"</span>, smoothVar <span class="op">=</span> <span class="st">"time"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-14-1.png" alt="Example of differences between distributions modelled by a spline." width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss">
<code>growthSS</code><a class="anchor" aria-label="anchor" href="#growthss"></a>
</h2>
<p>Any of these models shown can be specified easily using
<code>growthSS</code>.</p>
</div>
<div class="section level2">
<h2 id="growthss---form">
<code>growthSS</code> - form<a class="anchor" aria-label="anchor" href="#growthss---form"></a>
</h2>
<p>With a model specified a rough formula is required to parse your data
to fit the model.</p>
<p>The layout of that formula is:</p>
<p><code>outcome ~ time|individual/group</code></p>
</div>
<div class="section level2">
<h2 id="growthss---form-2">
<code>growthSS</code> - form 2<a class="anchor" aria-label="anchor" href="#growthss---form-2"></a>
</h2>
<p>Here we would use <code>y~time|id/group</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simdf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     id group time         y</span></span>
<span><span class="co">## 1 id_1     a    1  6.539088</span></span>
<span><span class="co">## 2 id_1     a    2  8.973278</span></span>
<span><span class="co">## 3 id_1     a    3 12.263465</span></span>
<span><span class="co">## 4 id_1     a    4 16.668316</span></span>
<span><span class="co">## 5 id_1     a    5 22.490524</span></span>
<span><span class="co">## 6 id_1     a    6 30.057423</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="growthss---form-3">
<code>growthSS</code> - form 3<a class="anchor" aria-label="anchor" href="#growthss---form-3"></a>
</h2>
<p>We can check that the grouping in our formula is correct with a
plot.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Testing Formula"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"y ~ time | id/group"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-16-1.png" alt="Checking the grouping of data using a ggplot before making a model. We are looking to see that lines follow individual plants over time, here they do." width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---sigma">
<code>growthSS</code> - sigma<a class="anchor" aria-label="anchor" href="#growthss---sigma"></a>
</h2>
<p>“nlme” and “brms” models accept a <code>sigma</code> argument. Here
we will only look at nlme models as brms models are the subject of the
<a href="https://github.com/danforthcenter/pcvr/tree/main/tutorials/pcvrTutorial_advancedGrowthModeling" class="external-link">Advanced
Growth Modeling tutorial</a>.</p>
</div>
<div class="section level2">
<h2 id="growthss---sigma-1">
<code>growthSS</code> - sigma<a class="anchor" aria-label="anchor" href="#growthss---sigma-1"></a>
</h2>
<p>Recall the heteroskedasticity problem, shown again with our simulated
data:</p>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-17-1.png" alt="Example of the homoskedastic assumption failing as standard deviation of the outcome has a non-linear trend." width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---sigma-2">
<code>growthSS</code> - sigma<a class="anchor" aria-label="anchor" href="#growthss---sigma-2"></a>
</h2>
<p>There are lots of ways to model a trend like that we see for
sigma.</p>
<p><code>pcvr</code> offers three options through <code>growthSS</code>
for nlme models.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draw_power_sigma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">12</span> <span class="op">+</span> <span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fl">0.75</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">0.26</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="co"># difficult to recapitulate from nlme</span></span>
<span><span class="va">draw_exp_sigma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">12</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">0.75</span> <span class="op">*</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"gray60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">15</span>, color <span class="op">=</span> <span class="st">"Homoskedastic"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span>, key_glyph <span class="op">=</span> <span class="va">draw_key_path</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_power_sigma</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Power"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_exp_sigma</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Exp"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, begin <span class="op">=</span> <span class="fl">0.1</span>, end <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="st">"SD of y"</span>, title <span class="op">=</span> <span class="st">"growthSS nlme sigma options"</span>, color <span class="op">=</span> <span class="st">""</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"note: variance fits here are rough approximations"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-18-1.png" alt="Showing a variety of possible trends for sigma and other distribution parameters to emphasize why any model can be used for any parameter in growthSS" width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---none-sigma">
<code>growthSS</code> - “none” sigma<a class="anchor" aria-label="anchor" href="#growthss---none-sigma"></a>
</h2>
<p>Variance can be modeled as homoskedastic by group.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">13.8</span>, color <span class="op">=</span> <span class="st">"Homoskedastic"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span>, key_glyph <span class="op">=</span> <span class="va">draw_key_path</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"gray40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, color <span class="op">=</span> <span class="st">"Sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-19-1.png" alt="Showing the Homoskedastic assumption and how it can yield a poor fit." width="700"></p>
</div>
<div class="section level2">
<h2 id="growthss---power-sigma">
<code>growthSS</code> - “power” sigma<a class="anchor" aria-label="anchor" href="#growthss---power-sigma"></a>
</h2>
<p>Variance can be modeled using a power of the x term.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_power_sigma</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Power"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"gray40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, color <span class="op">=</span> <span class="st">"Sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Multiple drawing groups in `geom_function()`</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Did you use the correct <span style="color: #00BB00;">group</span>, <span style="color: #00BB00;">colour</span>, or <span style="color: #00BB00;">fill</span> aesthetics?</span></span></code></pre>
<p>&lt;img
src=“/home/runner/work/pcvr/pcvr/docs/articles/pcvrTutorial_igm_files/figure-html/unnamed-chunk-20-1.png”
alt=“Showing the”power” option for sigma.” width=“700” /&gt;</p>
</div>
<div class="section level2">
<h2 id="growthss---exp-sigma">
<code>growthSS</code> - “exp” sigma<a class="anchor" aria-label="anchor" href="#growthss---exp-sigma"></a>
</h2>
<p>Variance can be modeled using a exponent of the x term.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sigma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw_exp_sigma</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Exp"</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"gray40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/pcv_theme.html">pcv_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"SD of y"</span>, color <span class="op">=</span> <span class="st">"Sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Multiple drawing groups in `geom_function()`</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Did you use the correct <span style="color: #00BB00;">group</span>, <span style="color: #00BB00;">colour</span>, or <span style="color: #00BB00;">fill</span> aesthetics?</span></span></code></pre>
<p>&lt;img
src=“/home/runner/work/pcvr/pcvr/docs/articles/pcvrTutorial_igm_files/figure-html/unnamed-chunk-21-1.png”
alt=“Showing the”exp” option for sigma.” width=“700” /&gt;</p>
</div>
<div class="section level2">
<h2 id="growthss---varfunc-options">
<code>growthSS</code> - varFunc Options<a class="anchor" aria-label="anchor" href="#growthss---varfunc-options"></a>
</h2>
<p>nlme varFunc objects can also be passed to the sigma argument in
growthSS.</p>
<p>See <code><a href="https://rdrr.io/pkg/nlme/man/varClasses.html" class="external-link">?nlme::varClasses</a></code> for details.</p>
</div>
<div class="section level2">
<h2 id="growthss---start">
<code>growthSS</code> - start<a class="anchor" aria-label="anchor" href="#growthss---start"></a>
</h2>
<p>One of the useful features in growthSS is that you do not need to
specify starting values for the supported non-linear models (double
sigmoid options notwithstanding).</p>
</div>
<div class="section level2">
<h2 id="growthss---tau">
<code>growthSS</code> - tau<a class="anchor" aria-label="anchor" href="#growthss---tau"></a>
</h2>
<p>Finally, with mode=“nlrq” the tau argument takes one or more
quantiles to fit a model for. By default this is 0.5, corresponding to
the median.</p>
</div>
<div class="section level2">
<h2 id="growthss---nls">
<code>growthSS</code> - nls<a class="anchor" aria-label="anchor" href="#growthss---nls"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nls_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"nls"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Individual is not used with type = 'nls'.</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">nls_ss</span>, <span class="va">class</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $formula</span></span>
<span><span class="co">## [1] "formula"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $start</span></span>
<span><span class="co">## [1] "list"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $df</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pcvrForm</span></span>
<span><span class="co">## [1] "formula"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $type</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $model</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $call</span></span>
<span><span class="co">## [1] "call"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="growthss---nlrq">
<code>growthSS</code> - nlrq<a class="anchor" aria-label="anchor" href="#growthss---nlrq"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nlrq_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"nlrq"</span>,</span>
<span>  tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="fl">0.04</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Individual is not used with type = 'nlrq'.</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">nls_ss</span>, <span class="va">class</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $formula</span></span>
<span><span class="co">## [1] "formula"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $start</span></span>
<span><span class="co">## [1] "list"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $df</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pcvrForm</span></span>
<span><span class="co">## [1] "formula"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $type</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $model</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $call</span></span>
<span><span class="co">## [1] "call"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="growthss---nlme">
<code>growthSS</code> - nlme<a class="anchor" aria-label="anchor" href="#growthss---nlme"></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nlme_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, sigma <span class="op">=</span> <span class="st">"power"</span>, type <span class="op">=</span> <span class="st">"nlme"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nlme_ss</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "formula"  "start"    "df"       "pcvrForm" "type"     "model"    "call"</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nlme_ss</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "model"    "random"   "fixed"    "groups"   "weights"  "cor_form"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="growthss---mgcv">
<code>growthSS</code> - mgcv<a class="anchor" aria-label="anchor" href="#growthss---mgcv"></a>
</h2>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mgcv_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"gam"</span>, form <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"mgcv"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Individual is not used with type = 'gam'.</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mgcv_ss</span>, <span class="va">class</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $formula</span></span>
<span><span class="co">## [1] "formula"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $df</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pcvrForm</span></span>
<span><span class="co">## [1] "formula"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $type</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $model</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $call</span></span>
<span><span class="co">## [1] "call"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="growthss---survival-models">
<code>growthSS</code> - survival models<a class="anchor" aria-label="anchor" href="#growthss---survival-models"></a>
</h2>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surv_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"survival weibull"</span>,</span>
<span>  form <span class="op">=</span> <span class="va">y</span> <span class="op">&gt;</span> <span class="fl">100</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"survreg"</span></span>
<span><span class="op">)</span> <span class="co"># type = "flexsurv" has more distribution options</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">surv_ss</span>, <span class="va">class</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $df</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $formula</span></span>
<span><span class="co">## [1] "formula"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pcvrForm</span></span>
<span><span class="co">## [1] "formula"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $distribution</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $type</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $model</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $call</span></span>
<span><span class="co">## [1] "call"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="growthss---survival-models-1">
<code>growthSS</code> - survival models<a class="anchor" aria-label="anchor" href="#growthss---survival-models-1"></a>
</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surv_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthSS.html">growthSS</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"survival weibull"</span>,</span>
<span>  form <span class="op">=</span> <span class="va">y</span> <span class="op">&gt;</span> <span class="fl">100</span> <span class="op">~</span> <span class="va">time</span> <span class="op">|</span> <span class="va">id</span> <span class="op">/</span> <span class="va">group</span>,</span>
<span>  df <span class="op">=</span> <span class="va">simdf</span>, type <span class="op">=</span> <span class="st">"survreg"</span></span>
<span><span class="op">)</span> <span class="co"># type = "flexsurv" has more distribution options</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">surv_ss</span>, <span class="va">class</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $df</span></span>
<span><span class="co">## [1] "data.frame"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $formula</span></span>
<span><span class="co">## [1] "formula"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pcvrForm</span></span>
<span><span class="co">## [1] "formula"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $distribution</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $type</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $model</span></span>
<span><span class="co">## [1] "character"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $call</span></span>
<span><span class="co">## [1] "call"</span></span></code></pre>
<p>Note that here we still supply the standard phenotype data but give a
cutoff on the left hand side of the formula. That cutoff represents the
“event”. For example, given area in pixels germination might be
<code>area_px&gt;10 ~ time|id/group</code>.</p>
</div>
<div class="section level2">
<h2 id="fitgrowth">
<code>fitGrowth</code><a class="anchor" aria-label="anchor" href="#fitgrowth"></a>
</h2>
<p>Now that we have the components for our model from
<code>growthSS</code> we can fit the model with
<code>fitGrowth</code>.</p>
</div>
<div class="section level2">
<h2 id="fitgrowth-2">
<code>fitGrowth</code> 2<a class="anchor" aria-label="anchor" href="#fitgrowth-2"></a>
</h2>
<p>With non-brms models the steps to fit a model specified by
<code>growthSS</code> are very simple and can be left to
<code>fitGrowth</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nls_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">nls_ss</span><span class="op">)</span></span>
<span><span class="va">nlrq_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">nlrq_ss</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">nlme_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">nlme_ss</span><span class="op">)</span></span>
<span><span class="va">mgcv_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">mgcv_ss</span><span class="op">)</span></span>
<span><span class="va">surv_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitGrowth.html">fitGrowth</a></span><span class="op">(</span><span class="va">surv_ss</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitgrowth-3">
<code>fitGrowth</code> 3<a class="anchor" aria-label="anchor" href="#fitgrowth-3"></a>
</h2>
<p>Additional arguments can be passed to <code>fitGrowth</code> and are
used as follows:</p>
<table class="table">
<thead><tr class="header">
<th>type</th>
<th>…</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>nls</td>
<td>passed to <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls</a></code>
</td>
</tr>
<tr class="even">
<td>nlrq</td>
<td>cores to run in parallel, passed to <code><a href="https://rdrr.io/pkg/quantreg/man/nlrq.html" class="external-link">quantreg::nlrq</a></code>
</td>
</tr>
<tr class="odd">
<td>nlme</td>
<td>passed to <code><a href="https://rdrr.io/pkg/nlme/man/nlmeControl.html" class="external-link">nlme::nlmeControl</a></code>
</td>
</tr>
<tr class="even">
<td>mgcv</td>
<td>passed to <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam</a></code>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="growthplot">
<code>growthPlot</code><a class="anchor" aria-label="anchor" href="#growthplot"></a>
</h2>
<p>Models fit by <code>fitGrowth</code> can be visualized using
<code>growthPlot</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_nls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">nls_fit</span>, form <span class="op">=</span> <span class="va">nls_ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">nls_ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">p_nlrq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">nlrq_fit</span>, form <span class="op">=</span> <span class="va">nlrq_ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">nlrq_ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">p_nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">nlme_fit</span>, form <span class="op">=</span> <span class="va">nlme_ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">nlme_ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">p_mgcv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">mgcv_fit</span>, form <span class="op">=</span> <span class="va">mgcv_ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">mgcv_ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">p_surv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthPlot.html">growthPlot</a></span><span class="op">(</span><span class="va">surv_fit</span>, form <span class="op">=</span> <span class="va">surv_ss</span><span class="op">$</span><span class="va">pcvrForm</span>, df <span class="op">=</span> <span class="va">surv_ss</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="growthplot---nls">
<code>growthPlot</code> - nls<a class="anchor" aria-label="anchor" href="#growthplot---nls"></a>
</h2>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_nls</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-30-1.png" alt="Showing default plotting for models fit with the nls function." width="700"></p>
</div>
<div class="section level2">
<h2 id="growthplot---nlrq">
<code>growthPlot</code> - nlrq<a class="anchor" aria-label="anchor" href="#growthplot---nlrq"></a>
</h2>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_nlrq</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-31-1.png" alt="Showing default plotting for models fit with the nlrq function." width="700"></p>
</div>
<div class="section level2">
<h2 id="growthplot---nlme">
<code>growthPlot</code> - nlme<a class="anchor" aria-label="anchor" href="#growthplot---nlme"></a>
</h2>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_nlme</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-32-1.png" alt="Showing default plotting for models fit with the nlme function." width="700"></p>
</div>
<div class="section level2">
<h2 id="growthplot---mgcv">
<code>growthPlot</code> - mgcv<a class="anchor" aria-label="anchor" href="#growthplot---mgcv"></a>
</h2>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_mgcv</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-33-1.png" alt="Showing default plotting for models fit with the gam function." width="700"></p>
</div>
<div class="section level2">
<h2 id="growthplot---surv">
<code>growthPlot</code> - surv<a class="anchor" aria-label="anchor" href="#growthplot---surv"></a>
</h2>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_surv</span></span></code></pre></div>
<p><img src="pcvrTutorial_igm_files/figure-html/unnamed-chunk-34-1.png" alt="Showing default plotting for models fit with the survreg function." width="700"></p>
</div>
<div class="section level2">
<h2 id="hypothesis-testing">Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h2>
<p>Hypothesis testing for frequentist non-linear growth models can be
somewhat limited.</p>
<p>Broadly, testing is implemented for all backends by comparing models
against nested null models and for select backends non-linear testing is
available using <code>testGrowth</code>.</p>
</div>
<div class="section level2">
<h2 id="testgrowth---nls">
<code>testGrowth</code> - nls<a class="anchor" aria-label="anchor" href="#testgrowth---nls"></a>
</h2>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">nls_ss</span>, <span class="va">nls_fit</span>, test <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span><span class="op">$</span><span class="va">anova</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: y ~ A/(1 + exp((B[group] - time)/C[group]))</span></span>
<span><span class="co">## Model 2: y ~ A[group]/(1 + exp((B[group] - time)/C[group]))</span></span>
<span><span class="co">##   Res.Df Res.Sum Sq Df Sum Sq F value    Pr(&gt;F)    </span></span>
<span><span class="co">## 1    995     259482                                </span></span>
<span><span class="co">## 2    994     235430  1  24052  101.55 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="testgrowth---nls-2">
<code>testGrowth</code> - nls 2<a class="anchor" aria-label="anchor" href="#testgrowth---nls-2"></a>
</h2>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">nls_ss</span>, <span class="va">nls_fit</span>, test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"A1 - A2"</span>,</span>
<span>  <span class="st">"B1 - (B2*1.25)"</span>,</span>
<span>  <span class="st">"(C1+1) - C2"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             Form   Estimate        SE   t-value      p-value</span></span>
<span><span class="co">## 1        A1 - A2 30.9620463 2.8416998 10.895608 3.418664e-26</span></span>
<span><span class="co">## 2 B1 - (B2*1.25) -1.1834444 0.2181014  5.426121 7.235593e-08</span></span>
<span><span class="co">## 3    (C1+1) - C2  0.5657608 0.1487875  3.802476 1.519847e-04</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="testgrowth---nlrq">
<code>testGrowth</code> - nlrq<a class="anchor" aria-label="anchor" href="#testgrowth---nlrq"></a>
</h2>
<p>Here we only print out the comparison for the model of the 49th
percentile, but all taus are returned.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">nlrq_ss</span>, <span class="va">nlrq_fit</span>, test <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Model 1: y ~ A[group]/(1 + exp((B[group] - time)/C[group]))</span></span>
<span><span class="co">## Model 2: y ~ A/(1 + exp((B[group] - time)/C[group]))</span></span>
<span><span class="co">##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    </span></span>
<span><span class="co">## 1   6 -4177.2                         </span></span>
<span><span class="co">## 2   5 -4228.7 -1 103.02  &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="testgrowth---nlme">
<code>testGrowth</code> - nlme<a class="anchor" aria-label="anchor" href="#testgrowth---nlme"></a>
</h2>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">nlme_ss</span>, <span class="va">nlme_fit</span>, test <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span><span class="op">$</span><span class="va">anova</span></span></code></pre></div>
<pre><code><span><span class="co">##         Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span></span>
<span><span class="co">## nullMod     1 13 5345.185 5408.986 -2659.593                        </span></span>
<span><span class="co">## fit         2 16 5336.665 5415.189 -2652.333 1 vs 2 14.52005  0.0023</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="testgrowth---nlme-2">
<code>testGrowth</code> - nlme 2<a class="anchor" aria-label="anchor" href="#testgrowth---nlme-2"></a>
</h2>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">nls_ss</span>, <span class="va">nlme_fit</span>, test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"A.groupa - A.groupb"</span>,</span>
<span>  <span class="st">"B.groupa - (B.groupb*1.25)"</span>,</span>
<span>  <span class="st">"(C.groupa+1) - C.groupa"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                         Form  Estimate        SE  Z-value      p-value</span></span>
<span><span class="co">## 1        A.groupa - A.groupb 31.406942 4.3866581 7.159651 8.088266e-13</span></span>
<span><span class="co">## 2 B.groupa - (B.groupb*1.25) -1.143088 0.2559811 4.465516 7.987592e-06</span></span>
<span><span class="co">## 3    (C.groupa+1) - C.groupa  1.000000 0.0000000      Inf 0.000000e+00</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="testgrowth---mgcv">
<code>testGrowth</code> - mgcv<a class="anchor" aria-label="anchor" href="#testgrowth---mgcv"></a>
</h2>
<p>Due to GAMs nature we cannot test parameters individually.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">mgcv_ss</span>, <span class="va">mgcv_fit</span><span class="op">)</span><span class="op">$</span><span class="va">anova</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: y ~ s(time)</span></span>
<span><span class="co">## Model 2: y ~ 0 + group + s(time, by = group)</span></span>
<span><span class="co">##   Resid. Df Resid. Dev     Df Deviance      F    Pr(&gt;F)    </span></span>
<span><span class="co">## 1    992.49     315705                                     </span></span>
<span><span class="co">## 2    985.48     236017 7.0101    79688 47.572 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="testgrowth---surv">
<code>testGrowth</code> - surv<a class="anchor" aria-label="anchor" href="#testgrowth---surv"></a>
</h2>
<p>The <code>flexsurv</code> backend provides more flexibility, but
standard <code>survreg</code> models are tested using
<code><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survival::survdiff</a></code></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testGrowth.html">testGrowth</a></span><span class="op">(</span><span class="va">surv_ss</span>, <span class="va">surv_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Call:</span></span>
<span><span class="co">## survival::survdiff(formula = ss$formula, data = ss$df)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          N Observed Expected (O-E)^2/E (O-E)^2/V</span></span>
<span><span class="co">## group=a 20       20     20.7    0.0270    0.0939</span></span>
<span><span class="co">## group=b 20       20     19.3    0.0291    0.0939</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Chisq= 0.1  on 1 degrees of freedom, p= 0.8</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="final-considerations">Final Considerations<a class="anchor" aria-label="anchor" href="#final-considerations"></a>
</h2>
<ul>
<li>Pick model builders and parameterizations based on your needs</li>
<li>Use GAMs sparingly, they present interpretability problems compared
to the parameterized models.</li>
<li>Consider the biology behind your observed data while picking a
growth model.</li>
</ul>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<p>If you run into a novel situation please reach out and we will try to
come up with a solution and add it to <code>pcvr</code> if possible.</p>
<p>Good ways to reach out are the help-datascience slack channel and <a href="https://github.com/danforthcenter/pcvr" class="external-link">pcvr github
repository</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Josh Sumner <br> Developed in DDPSC Datascience Core Facility <br> Logo design by <a href="https://twitter.com/Kerri_Gilbert" class="external-link">Kerri Gilbert</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
